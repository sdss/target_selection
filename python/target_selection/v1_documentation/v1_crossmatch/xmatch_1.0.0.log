2022-11-11 07:12:10,205 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-11-11 07:12:10,205 - INFO - Reference Epoch = 2016.0
2022-11-11 07:12:10,921 - INFO - Query radius = 1.0
2022-11-11 07:12:10,922 - DEBUG - Current database configuration parameters.
2022-11-11 07:12:10,922 - DEBUG - shared_buffers = 76GB
2022-11-11 07:12:10,923 - DEBUG - effective_cache_size = 176GB
2022-11-11 07:12:10,923 - DEBUG - wal_buffers = 16MB
2022-11-11 07:12:10,923 - DEBUG - effective_io_concurrency = 200
2022-11-11 07:12:10,923 - DEBUG - work_mem = 5GB
2022-11-11 07:12:10,923 - DEBUG - max_worker_processes = 32
2022-11-11 07:12:10,923 - DEBUG - random_page_cost = 1
2022-11-11 07:12:10,923 - DEBUG - seq_page_cost = 0.5
2022-11-11 07:12:10,923 - DEBUG - cpu_index_tuple_cost = 0.005
2022-11-11 07:12:10,923 - DEBUG - cpu_operator_cost = 0.0025
2022-11-11 07:12:10,923 - DEBUG - default_statistics_target = 3000
2022-11-11 07:12:10,923 - DEBUG - temp_buffers = 10GB
2022-11-11 07:12:10,923 - DEBUG - plan_cache_mode = auto
2022-11-11 07:12:10,923 - DEBUG - geqo_effort = 5
2022-11-11 07:12:10,923 - DEBUG - force_parallel_mode = off
2022-11-11 07:12:10,923 - DEBUG - enable_seqscan = on
2022-11-11 07:12:10,923 - DEBUG - enable_nestloop = on
2022-11-11 07:12:10,932 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-11-11 07:14:07,988 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-11-11 07:14:07,988 - INFO - Reference Epoch = 2016.0
2022-11-11 07:14:08,632 - INFO - Query radius = 1.0
2022-11-11 07:14:08,633 - DEBUG - Current database configuration parameters.
2022-11-11 07:14:08,633 - DEBUG - shared_buffers = 76GB
2022-11-11 07:14:08,633 - DEBUG - effective_cache_size = 176GB
2022-11-11 07:14:08,633 - DEBUG - wal_buffers = 16MB
2022-11-11 07:14:08,634 - DEBUG - effective_io_concurrency = 200
2022-11-11 07:14:08,634 - DEBUG - work_mem = 5GB
2022-11-11 07:14:08,634 - DEBUG - max_worker_processes = 32
2022-11-11 07:14:08,634 - DEBUG - random_page_cost = 1
2022-11-11 07:14:08,634 - DEBUG - seq_page_cost = 0.5
2022-11-11 07:14:08,634 - DEBUG - cpu_index_tuple_cost = 0.005
2022-11-11 07:14:08,634 - DEBUG - cpu_operator_cost = 0.0025
2022-11-11 07:14:08,634 - DEBUG - default_statistics_target = 3000
2022-11-11 07:14:08,634 - DEBUG - temp_buffers = 10GB
2022-11-11 07:14:08,634 - DEBUG - plan_cache_mode = auto
2022-11-11 07:14:08,634 - DEBUG - geqo_effort = 5
2022-11-11 07:14:08,634 - DEBUG - force_parallel_mode = off
2022-11-11 07:14:08,634 - DEBUG - enable_seqscan = on
2022-11-11 07:14:08,634 - DEBUG - enable_nestloop = on
2022-11-11 07:14:08,643 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-11-11 07:14:08,658 - INFO - Added version record (31, 1.0.0, 0.3.23a0).
2022-11-11 07:14:08,685 - INFO - Created table catalog_47cd76e43f74bbc2.
2022-11-11 07:14:08,685 - INFO - [GAIA_DR3_SOURCE] Processing table gaia_dr3_source.
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] Table cross-matching parameters:
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] ra_column: ra
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] dec_column: dec
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] pmra_column: pmra
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] pmdec_column: pmdec
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] is_pmra_cos: true
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] parallax_column: parallax
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] epoch: 2016.0
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] epoch_column: none
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] epoch_format: jyear
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] has_duplicates: false
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] skip: false
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] skip_phases: []
2022-11-11 07:14:08,686 - DEBUG - [GAIA_DR3_SOURCE] query_radius: 1.0
2022-11-11 07:14:08,687 - DEBUG - [GAIA_DR3_SOURCE] row_count: 1,811,493,600
2022-11-11 07:14:08,687 - DEBUG - [GAIA_DR3_SOURCE] resolution: nan
2022-11-11 07:14:08,687 - DEBUG - [GAIA_DR3_SOURCE] join_weight: 1
2022-11-11 07:14:08,687 - INFO - [GAIA_DR3_SOURCE] Phase 3: adding non cross-matched targets.
2022-11-11 07:14:08,694 - DEBUG - [GAIA_DR3_SOURCE] SET LOCAL work_mem='10GB';
2022-11-11 07:14:08,694 - DEBUG - [GAIA_DR3_SOURCE] SET LOCAL temp_buffers='5GB';
2022-11-11 07:14:08,694 - DEBUG - [GAIA_DR3_SOURCE] SET LOCAL enable_hashjoin=False;
2022-11-11 07:14:08,695 - DEBUG - [GAIA_DR3_SOURCE] Selecting unique targets into temporary table 'cbab86d3': SELECT (row_number() OVER () + 63050394783186944) AS "catalogid", "t1"."source_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."gaia_dr3_source" AS "t1" WHERE True
2022-11-11 11:19:12,654 - DEBUG - [GAIA_DR3_SOURCE] Copying data into relational model 'catalog_to_gaia_dr3_source': INSERT INTO "catalogdb"."catalog_to_gaia_dr3_source" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "cbab86d3" AS "t1"
2022-11-11 13:56:05,948 - DEBUG - [GAIA_DR3_SOURCE] Insertion into catalog_to_gaia_dr3_source completed with 1,811,709,771 rows in 24117.255 s.
2022-11-11 13:56:05,952 - DEBUG - [GAIA_DR3_SOURCE] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec", "pmra", "pmdec", "parallax") SELECT "t1"."catalogid", gaia_dr3_source, 31, "t1"."ra", "t1"."dec", "t1"."pmra", "t1"."pmdec", "t1"."parallax" FROM "cbab86d3" AS "t1"
2022-11-11 16:04:51,686 - DEBUG - [GAIA_DR3_SOURCE] Inserted 1,811,709,771 rows. Total time: 31842.992 s.
2022-11-11 16:04:51,690 - DEBUG - [GAIA_DR3_SOURCE] Running CLUSTER on catalog_47cd76e43f74bbc2 with q3c index.
2022-11-11 18:40:57,138 - DEBUG - [GAIA_DR3_SOURCE] Running ANALYZE on catalog_47cd76e43f74bbc2.
2022-11-11 18:42:50,267 - DEBUG - [GAIA_DR3_SOURCE] Running ANALYZE on catalog_to_gaia_dr3_source.
2022-11-11 19:02:47,161 - INFO - [GAIA_DR3_SOURCE] Fully processed gaia_dr3_source in 42518 s.
2022-11-11 19:02:47,175 - INFO - [GAIA_DR2_SOURCE] Processing table gaia_dr2_source.
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] Table cross-matching parameters:
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] ra_column: ra
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] dec_column: dec
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] pmra_column: pmra
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] pmdec_column: pmdec
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] is_pmra_cos: true
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] parallax_column: none
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] epoch: none
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] epoch_column: none
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] epoch_format: jyear
2022-11-11 19:02:47,176 - DEBUG - [GAIA_DR2_SOURCE] has_duplicates: false
2022-11-11 19:02:47,177 - DEBUG - [GAIA_DR2_SOURCE] skip: false
2022-11-11 19:02:47,177 - DEBUG - [GAIA_DR2_SOURCE] skip_phases: []
2022-11-11 19:02:47,177 - DEBUG - [GAIA_DR2_SOURCE] query_radius: 1.0
2022-11-11 19:02:47,177 - DEBUG - [GAIA_DR2_SOURCE] row_count: 1,693,100,800
2022-11-11 19:02:47,177 - DEBUG - [GAIA_DR2_SOURCE] resolution: nan
2022-11-11 19:02:47,177 - DEBUG - [GAIA_DR2_SOURCE] join_weight: 1
2022-11-11 19:02:47,189 - INFO - [GAIA_DR2_SOURCE] Phase 1: linking existing targets.
2022-11-11 19:02:47,190 - DEBUG - [GAIA_DR2_SOURCE] Found 1 paths between gaia_dr2_source and temporary output table.
2022-11-11 19:02:47,192 - DEBUG - [GAIA_DR2_SOURCE] SET LOCAL work_mem='10GB';
2022-11-11 19:02:47,193 - DEBUG - [GAIA_DR2_SOURCE] SET LOCAL temp_buffers='5GB';
2022-11-11 19:02:47,193 - DEBUG - [GAIA_DR2_SOURCE] SET LOCAL enable_hashjoin=False;
2022-11-11 19:02:47,194 - DEBUG - [GAIA_DR2_SOURCE] Selecting linked targets into temporary table '4f23dfb1' with join path ['gaia_dr2_source', 'gaia_dr2_neighbourhood', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."source_id", "t2"."catalogid") "t1"."source_id" AS "target_id", "t2"."catalogid", (first_value("t1"."source_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."source_id" ASC) = "t1"."source_id") AS "best" FROM "catalogdb"."gaia_dr2_source" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_neighbourhood" AS "t3" ON ("t3"."dr2_source_id" = "t1"."source_id") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t4" ON ("t3"."dr3_source_id" = "t4"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t4"."source_id") WHERE (((("t3"."angular_distance" < 200.0) AND ("t2"."version_id" = 31)) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_gaia_dr2_source" AS "t5" WHERE (("t5"."version_id" = 31) AND (("t5"."target_id" = "t1"."source_id") OR ("t5"."catalogid" = "t2"."catalogid")))))
2022-11-12 05:46:41,998 - DEBUG - [GAIA_DR2_SOURCE] Copying data into relational model 'catalog_to_gaia_dr2_source'.
2022-11-12 08:36:41,625 - DEBUG - [GAIA_DR2_SOURCE] Linked 1,686,635,277 records in 48834.434 s.
2022-11-12 08:36:41,631 - DEBUG - [GAIA_DR2_SOURCE] Running ANALYZE on catalog_to_gaia_dr2_source.
2022-11-12 08:46:48,211 - INFO - [GAIA_DR2_SOURCE] Phase 2: cross-matching against existing targets.
2022-11-12 08:46:48,221 - DEBUG - [GAIA_DR2_SOURCE] Cross-matching model against temporary table.
2022-11-12 08:46:48,221 - DEBUG - [GAIA_DR2_SOURCE] SET LOCAL work_mem='10GB';
2022-11-12 08:46:48,221 - DEBUG - [GAIA_DR2_SOURCE] SET LOCAL temp_buffers='5GB';
2022-11-12 08:46:48,222 - DEBUG - [GAIA_DR2_SOURCE] SET LOCAL enable_hashjoin=False;
2022-11-12 08:46:48,223 - DEBUG - [GAIA_DR2_SOURCE] Inserting cross-matched data into relational model 'catalog_to_gaia_dr2_source': INSERT INTO "catalogdb"."catalog_to_gaia_dr2_source" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."source_id" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."gaia_dr2_source" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_gaia_dr2_source" AS "catalog_to_gaia_dr2_source" WHERE (("catalog_to_gaia_dr2_source"."version_id" = 31) AND (("catalog_to_gaia_dr2_source"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_gaia_dr2_source"."target_id" = "xmatched"."target_id"))))
2022-11-12 16:08:50,639 - DEBUG - [GAIA_DR2_SOURCE] Cross-matched catalog_47cd76e43f74bbc2 with 694,918 targets in gaia_dr2_source. Run in 26522.418 s.
2022-11-12 16:08:50,643 - DEBUG - [GAIA_DR2_SOURCE] Running ANALYZE on catalog_to_gaia_dr2_source.
2022-11-12 16:10:09,584 - INFO - [GAIA_DR2_SOURCE] Phase 3: adding non cross-matched targets.
2022-11-12 16:10:09,595 - DEBUG - [GAIA_DR2_SOURCE] SET LOCAL work_mem='10GB';
2022-11-12 16:10:09,595 - DEBUG - [GAIA_DR2_SOURCE] SET LOCAL temp_buffers='5GB';
2022-11-12 16:10:09,595 - DEBUG - [GAIA_DR2_SOURCE] SET LOCAL enable_hashjoin=False;
2022-11-12 16:10:09,597 - DEBUG - [GAIA_DR2_SOURCE] Selecting unique targets into temporary table 'e09dcdc4': SELECT (row_number() OVER () + 63050396594896715) AS "catalogid", "t1"."source_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec" FROM "catalogdb"."gaia_dr2_source" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."source_id"))))
2022-11-12 17:00:58,445 - DEBUG - [GAIA_DR2_SOURCE] Copying data into relational model 'catalog_to_gaia_dr2_source': INSERT INTO "catalogdb"."catalog_to_gaia_dr2_source" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "e09dcdc4" AS "t1"
2022-11-12 17:05:52,448 - DEBUG - [GAIA_DR2_SOURCE] Insertion into catalog_to_gaia_dr2_source completed with 5,717,787 rows in 3342.853 s.
2022-11-12 17:05:52,449 - DEBUG - [GAIA_DR2_SOURCE] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec", "pmra", "pmdec") SELECT "t1"."catalogid", gaia_dr2_source, 31, "t1"."ra", "t1"."dec", "t1"."pmra", "t1"."pmdec" FROM "e09dcdc4" AS "t1"
2022-11-12 17:12:30,233 - DEBUG - [GAIA_DR2_SOURCE] Inserted 5,717,787 rows. Total time: 3740.629 s.
2022-11-12 17:12:30,235 - DEBUG - [GAIA_DR2_SOURCE] Running ANALYZE on catalog_to_gaia_dr2_source.
2022-11-12 17:14:01,488 - INFO - [GAIA_DR2_SOURCE] Fully processed gaia_dr2_source in 79874 s.
2022-11-12 17:14:01,499 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-11-12 17:14:01,499 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-11-12 17:14:01,499 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-11-12 17:14:01,500 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-11-12 17:14:01,508 - INFO - [LEGACY_SURVEY_DR10] Phase 1: linking existing targets.
2022-11-12 17:14:01,509 - DEBUG - [LEGACY_SURVEY_DR10] Found 2 paths between legacy_survey_dr10 and temporary output table.
2022-11-12 17:14:01,510 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-12 17:14:01,510 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-12 17:14:01,510 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-12 17:14:01,511 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '29b1f7f3' with join path ['legacy_survey_dr10', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr3_source" AS "t3" ON ("t1"."gaia_dr3_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-11-13 06:02:55,458 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-11-13 06:32:51,278 - DEBUG - [LEGACY_SURVEY_DR10] Linked 233,744,330 records in 47929.769 s.
2022-11-13 06:32:51,280 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-11-13 06:33:36,440 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-13 06:33:36,440 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-13 06:33:36,441 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-13 06:33:36,442 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '3b8b7034' with join path ['legacy_survey_dr10', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_dr2_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-11-13 10:13:09,532 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-11-13 10:16:38,119 - DEBUG - [LEGACY_SURVEY_DR10] Linked 30,928,916 records in 13381.684 s.
2022-11-13 10:16:38,120 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-11-13 10:18:31,156 - INFO - [LEGACY_SURVEY_DR10] Phase 2: cross-matching against existing targets.
2022-11-13 10:18:31,165 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matching model against temporary table.
2022-11-13 10:18:31,165 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-13 10:18:31,166 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-13 10:18:31,166 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-13 10:18:31,167 - DEBUG - [LEGACY_SURVEY_DR10] Inserting cross-matched data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."ls_id" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."legacy_survey_dr10" AS "t2" WHERE (((q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True) AND ("t2"."survey_primary" IS True)) AND (coalesce("t2"."ref_cat", ) != T2))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "catalog_to_legacy_survey_dr10" WHERE (("catalog_to_legacy_survey_dr10"."version_id" = 31) AND (("catalog_to_legacy_survey_dr10"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_legacy_survey_dr10"."target_id" = "xmatched"."target_id"))))
2022-11-13 22:45:30,870 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matched catalog_47cd76e43f74bbc2 with 2,360,003 targets in legacy_survey_dr10. Run in 44819.705 s.
2022-11-13 22:45:30,871 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-11-13 22:46:01,005 - INFO - [LEGACY_SURVEY_DR10] Phase 3: adding non cross-matched targets.
2022-11-13 22:46:01,016 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-13 22:46:01,016 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-13 22:46:01,016 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-13 22:46:01,018 - DEBUG - [LEGACY_SURVEY_DR10] Selecting unique targets into temporary table 'a24d4593': SELECT (row_number() OVER () + 63050396600614502) AS "catalogid", "t1"."ls_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."legacy_survey_dr10" AS "t1" WHERE (((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."ls_id")))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-11-14 12:46:16,553 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-11-14 12:46:16,553 - INFO - Reference Epoch = 2016.0
2022-11-14 12:46:17,208 - INFO - Query radius = 1.0
2022-11-14 12:46:17,209 - DEBUG - Current database configuration parameters.
2022-11-14 12:46:17,210 - DEBUG - shared_buffers = 76GB
2022-11-14 12:46:17,210 - DEBUG - effective_cache_size = 176GB
2022-11-14 12:46:17,210 - DEBUG - wal_buffers = 16MB
2022-11-14 12:46:17,210 - DEBUG - effective_io_concurrency = 200
2022-11-14 12:46:17,210 - DEBUG - work_mem = 5GB
2022-11-14 12:46:17,210 - DEBUG - max_worker_processes = 32
2022-11-14 12:46:17,210 - DEBUG - random_page_cost = 1
2022-11-14 12:46:17,210 - DEBUG - seq_page_cost = 0.5
2022-11-14 12:46:17,210 - DEBUG - cpu_index_tuple_cost = 0.005
2022-11-14 12:46:17,210 - DEBUG - cpu_operator_cost = 0.0025
2022-11-14 12:46:17,210 - DEBUG - default_statistics_target = 3000
2022-11-14 12:46:17,210 - DEBUG - temp_buffers = 10GB
2022-11-14 12:46:17,210 - DEBUG - plan_cache_mode = auto
2022-11-14 12:46:17,210 - DEBUG - geqo_effort = 5
2022-11-14 12:46:17,210 - DEBUG - force_parallel_mode = off
2022-11-14 12:46:17,210 - DEBUG - enable_seqscan = on
2022-11-14 12:46:17,210 - DEBUG - enable_nestloop = on
2022-11-14 12:46:17,220 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-11-14 12:46:17,233 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-11-14 12:46:17,257 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-11-14 12:46:17,258 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-11-14 12:46:17,260 - WARNING - Skipping table gaia_dr3_source.
2022-11-14 12:46:17,260 - WARNING - Skipping table gaia_dr2_source.
2022-11-14 12:46:17,260 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-11-14 12:46:17,261 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-11-14 12:46:17,268 - INFO - [LEGACY_SURVEY_DR10] Phase 1: linking existing targets.
2022-11-14 12:46:17,269 - DEBUG - [LEGACY_SURVEY_DR10] Found 2 paths between legacy_survey_dr10 and temporary output table.
2022-11-14 12:46:17,270 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-14 12:46:17,270 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-14 12:46:17,270 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-14 12:46:17,271 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '37ab2080' with join path ['legacy_survey_dr10', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr3_source" AS "t3" ON ("t1"."gaia_dr3_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-11-16 02:38:39,465 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-11-16 03:04:07,979 - DEBUG - [LEGACY_SURVEY_DR10] Linked 233,744,330 records in 137870.710 s.
2022-11-16 03:04:07,984 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-11-16 03:05:03,633 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-16 03:05:03,633 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-16 03:05:03,633 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-16 03:05:03,634 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '9d04144d' with join path ['legacy_survey_dr10', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_dr2_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-11-16 12:42:28,448 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-11-16 12:45:13,408 - DEBUG - [LEGACY_SURVEY_DR10] Linked 30,928,916 records in 34809.777 s.
2022-11-16 12:45:13,409 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-11-16 12:50:07,322 - INFO - [LEGACY_SURVEY_DR10] Phase 2: cross-matching against existing targets.
2022-11-16 12:50:07,336 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matching model against temporary table.
2022-11-16 12:50:07,337 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-16 12:50:07,338 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-16 12:50:07,338 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-16 12:50:07,339 - DEBUG - [LEGACY_SURVEY_DR10] Inserting cross-matched data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."ls_id" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."legacy_survey_dr10" AS "t2" WHERE (((q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True) AND ("t2"."survey_primary" IS True)) AND (coalesce("t2"."ref_cat", ) != T2))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "catalog_to_legacy_survey_dr10" WHERE (("catalog_to_legacy_survey_dr10"."version_id" = 31) AND (("catalog_to_legacy_survey_dr10"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_legacy_survey_dr10"."target_id" = "xmatched"."target_id"))))
2022-11-17 18:15:43,758 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matched catalog_47cd76e43f74bbc2 with 2,360,003 targets in legacy_survey_dr10. Run in 105936.421 s.
2022-11-17 18:15:43,764 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-11-17 18:19:44,081 - INFO - [LEGACY_SURVEY_DR10] Phase 3: adding non cross-matched targets.
2022-11-17 18:19:44,094 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-17 18:19:44,094 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-17 18:19:44,094 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-17 18:19:44,096 - DEBUG - [LEGACY_SURVEY_DR10] Selecting unique targets into temporary table '579fc018': SELECT (row_number() OVER () + 63050396600614503) AS "catalogid", "t1"."ls_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."legacy_survey_dr10" AS "t1" WHERE (((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."ls_id")))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-11-25 07:16:34,447 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-11-25 07:16:34,447 - INFO - Reference Epoch = 2016.0
2022-11-25 07:16:35,082 - INFO - Query radius = 1.0
2022-11-25 07:16:35,083 - DEBUG - Current database configuration parameters.
2022-11-25 07:16:35,083 - DEBUG - shared_buffers = 76GB
2022-11-25 07:16:35,083 - DEBUG - effective_cache_size = 176GB
2022-11-25 07:16:35,083 - DEBUG - wal_buffers = 16MB
2022-11-25 07:16:35,083 - DEBUG - effective_io_concurrency = 200
2022-11-25 07:16:35,083 - DEBUG - work_mem = 5GB
2022-11-25 07:16:35,083 - DEBUG - max_worker_processes = 32
2022-11-25 07:16:35,083 - DEBUG - random_page_cost = 1
2022-11-25 07:16:35,083 - DEBUG - seq_page_cost = 0.5
2022-11-25 07:16:35,083 - DEBUG - cpu_index_tuple_cost = 0.005
2022-11-25 07:16:35,083 - DEBUG - cpu_operator_cost = 0.0025
2022-11-25 07:16:35,083 - DEBUG - default_statistics_target = 3000
2022-11-25 07:16:35,083 - DEBUG - temp_buffers = 10GB
2022-11-25 07:16:35,083 - DEBUG - plan_cache_mode = auto
2022-11-25 07:16:35,084 - DEBUG - geqo_effort = 5
2022-11-25 07:16:35,084 - DEBUG - force_parallel_mode = off
2022-11-25 07:16:35,084 - DEBUG - enable_seqscan = on
2022-11-25 07:16:35,084 - DEBUG - enable_nestloop = on
2022-11-25 07:16:35,092 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-11-25 07:16:35,125 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-11-25 07:16:35,276 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-11-25 07:16:35,282 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-11-25 07:16:35,347 - WARNING - Skipping table gaia_dr3_source.
2022-11-25 07:16:35,347 - WARNING - Skipping table gaia_dr2_source.
2022-11-25 07:16:35,347 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-11-25 07:16:35,347 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-11-25 07:16:35,348 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-11-25 07:16:35,348 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-11-25 07:16:35,348 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-11-25 07:16:35,348 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-11-25 07:16:35,348 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-11-25 07:16:35,354 - INFO - [LEGACY_SURVEY_DR10] Phase 1: linking existing targets.
2022-11-25 07:16:35,355 - DEBUG - [LEGACY_SURVEY_DR10] Found 2 paths between legacy_survey_dr10 and temporary output table.
2022-11-25 07:16:35,356 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-25 07:16:35,356 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-25 07:16:35,356 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-25 07:16:35,357 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '0a6f4234' with join path ['legacy_survey_dr10', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr3_source" AS "t3" ON ("t1"."gaia_dr3_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-11-25 17:18:16,313 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-11-25 17:52:03,683 - DEBUG - [LEGACY_SURVEY_DR10] Linked 233,744,330 records in 38128.328 s.
2022-11-25 17:52:03,684 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-11-25 17:52:24,662 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-25 17:52:24,663 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-25 17:52:24,663 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-25 17:52:24,665 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '5602f605' with join path ['legacy_survey_dr10', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_dr2_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-11-25 19:26:23,645 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-11-25 19:29:41,496 - DEBUG - [LEGACY_SURVEY_DR10] Linked 30,928,916 records in 5836.839 s.
2022-11-25 19:29:41,497 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-11-25 19:31:30,095 - INFO - [LEGACY_SURVEY_DR10] Phase 2: cross-matching against existing targets.
2022-11-25 19:31:30,108 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matching model against temporary table.
2022-11-25 19:31:30,108 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-25 19:31:30,108 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-25 19:31:30,108 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-25 19:31:30,110 - DEBUG - [LEGACY_SURVEY_DR10] Inserting cross-matched data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."ls_id" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."legacy_survey_dr10" AS "t2" WHERE (((q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True) AND ("t2"."survey_primary" IS True)) AND (coalesce("t2"."ref_cat", ) != T2))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "catalog_to_legacy_survey_dr10" WHERE (("catalog_to_legacy_survey_dr10"."version_id" = 31) AND (("catalog_to_legacy_survey_dr10"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_legacy_survey_dr10"."target_id" = "xmatched"."target_id"))))
2022-11-26 04:07:31,012 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matched catalog_47cd76e43f74bbc2 with 2,360,003 targets in legacy_survey_dr10. Run in 30960.904 s.
2022-11-26 04:07:31,018 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-11-26 04:07:40,139 - INFO - [LEGACY_SURVEY_DR10] Phase 3: adding non cross-matched targets.
2022-11-26 04:07:40,149 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-11-26 04:07:40,149 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-11-26 04:07:40,149 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-11-26 04:07:40,150 - DEBUG - [LEGACY_SURVEY_DR10] Selecting unique targets into temporary table '29e95ac4': SELECT (row_number() OVER () + 63050396600614503) AS "catalogid", "t1"."ls_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."legacy_survey_dr10" AS "t1" WHERE (((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."ls_id")))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-11-26 09:00:08,261 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-11-26 09:00:08,261 - INFO - Reference Epoch = 2016.0
2022-11-26 09:00:08,908 - INFO - Query radius = 1.0
2022-11-26 09:00:08,909 - DEBUG - Current database configuration parameters.
2022-11-26 09:00:08,909 - DEBUG - shared_buffers = 76GB
2022-11-26 09:00:08,909 - DEBUG - effective_cache_size = 176GB
2022-11-26 09:00:08,909 - DEBUG - wal_buffers = 16MB
2022-11-26 09:00:08,909 - DEBUG - effective_io_concurrency = 200
2022-11-26 09:00:08,909 - DEBUG - work_mem = 5GB
2022-11-26 09:00:08,909 - DEBUG - max_worker_processes = 32
2022-11-26 09:00:08,909 - DEBUG - random_page_cost = 1
2022-11-26 09:00:08,909 - DEBUG - seq_page_cost = 0.5
2022-11-26 09:00:08,909 - DEBUG - cpu_index_tuple_cost = 0.005
2022-11-26 09:00:08,909 - DEBUG - cpu_operator_cost = 0.0025
2022-11-26 09:00:08,909 - DEBUG - default_statistics_target = 3000
2022-11-26 09:00:08,909 - DEBUG - temp_buffers = 10GB
2022-11-26 09:00:08,909 - DEBUG - plan_cache_mode = auto
2022-11-26 09:00:08,909 - DEBUG - geqo_effort = 5
2022-11-26 09:00:08,909 - DEBUG - force_parallel_mode = off
2022-11-26 09:00:08,910 - DEBUG - enable_seqscan = on
2022-11-26 09:00:08,910 - DEBUG - enable_nestloop = on
2022-11-26 09:00:08,919 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-11-26 09:00:08,932 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-11-26 09:00:09,164 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-11-26 09:00:09,202 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-11-26 09:00:09,341 - WARNING - Skipping table gaia_dr3_source.
2022-11-26 09:00:09,341 - WARNING - Skipping table gaia_dr2_source.
2022-11-26 09:00:09,341 - WARNING - Skipping table legacy_survey_dr10.
2022-11-26 09:00:09,342 - WARNING - Skipping table legacy_survey_dr8.
2022-11-26 09:00:09,342 - INFO - [PANSTARRS1] Processing table panstarrs1.
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] Table cross-matching parameters:
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] ra_column: ra
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] dec_column: dec
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] pmra_column: none
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] pmdec_column: none
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] is_pmra_cos: true
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] parallax_column: none
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] epoch: none
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] epoch_column: none
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] epoch_format: jyear
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] has_duplicates: false
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] skip: false
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] skip_phases: []
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] query_radius: 1
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] row_count: 2,767,937,500
2022-11-26 09:00:09,342 - DEBUG - [PANSTARRS1] resolution: nan
2022-11-26 09:00:09,343 - DEBUG - [PANSTARRS1] join_weight: 1
2022-11-26 09:00:09,350 - INFO - [PANSTARRS1] Phase 1: linking existing targets.
2022-11-26 09:00:09,351 - DEBUG - [PANSTARRS1] Found 1 paths between panstarrs1 and temporary output table.
2022-11-26 09:00:09,352 - DEBUG - [PANSTARRS1] SET LOCAL work_mem='10GB';
2022-11-26 09:00:09,352 - DEBUG - [PANSTARRS1] SET LOCAL temp_buffers='5GB';
2022-11-26 09:00:09,352 - DEBUG - [PANSTARRS1] SET LOCAL enable_hashjoin=False;
2022-11-26 09:00:09,353 - DEBUG - [PANSTARRS1] Selecting linked targets into temporary table 'b676ba37' with join path ['panstarrs1', 'gaia_edr3_panstarrs1_best_neighbour', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."catid_objid", "t2"."catalogid") "t1"."catid_objid" AS "target_id", "t2"."catalogid", (first_value("t1"."catid_objid") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."catid_objid" ASC) = "t1"."catid_objid") AS "best" FROM "catalogdb"."panstarrs1" AS "t1" INNER JOIN "catalogdb"."gaia_edr3_panstarrs1_best_neighbour" AS "t3" ON ("t1"."extid_hi_lo" = "t3"."original_ext_source_id") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t4" ON ("t3"."source_id" = "t4"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t4"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_panstarrs1" AS "t5" WHERE (("t5"."version_id" = 31) AND (("t5"."target_id" = "t1"."catid_objid") OR ("t5"."catalogid" = "t2"."catalogid")))))
2022-11-26 18:38:17,536 - DEBUG - [PANSTARRS1] Copying data into relational model 'catalog_to_panstarrs1'.
2022-11-26 21:05:12,017 - DEBUG - [PANSTARRS1] Linked 876,385,606 records in 43502.666 s.
2022-11-26 21:05:12,027 - DEBUG - [PANSTARRS1] Running ANALYZE on catalog_to_panstarrs1.
2022-11-26 21:46:55,061 - INFO - [PANSTARRS1] Phase 2: cross-matching against existing targets.
2022-11-26 21:46:55,084 - DEBUG - [PANSTARRS1] Cross-matching model against temporary table.
2022-11-26 21:46:55,084 - DEBUG - [PANSTARRS1] SET LOCAL work_mem='10GB';
2022-11-26 21:46:55,084 - DEBUG - [PANSTARRS1] SET LOCAL temp_buffers='5GB';
2022-11-26 21:46:55,085 - DEBUG - [PANSTARRS1] SET LOCAL enable_hashjoin=False;
2022-11-26 21:46:55,086 - DEBUG - [PANSTARRS1] Inserting cross-matched data into relational model 'catalog_to_panstarrs1': INSERT INTO "catalogdb"."catalog_to_panstarrs1" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."catid_objid" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."panstarrs1" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_panstarrs1" AS "catalog_to_panstarrs1" WHERE (("catalog_to_panstarrs1"."version_id" = 31) AND (("catalog_to_panstarrs1"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_panstarrs1"."target_id" = "xmatched"."target_id"))))
2022-11-27 10:56:08,027 - DEBUG - [PANSTARRS1] Cross-matched catalog_47cd76e43f74bbc2 with 23,953,982 targets in panstarrs1. Run in 47352.943 s.
2022-11-27 10:56:08,034 - DEBUG - [PANSTARRS1] Running ANALYZE on catalog_to_panstarrs1.
2022-11-27 11:46:25,987 - INFO - [PANSTARRS1] Phase 3: adding non cross-matched targets.
2022-11-27 11:46:26,001 - DEBUG - [PANSTARRS1] SET LOCAL work_mem='10GB';
2022-11-27 11:46:26,001 - DEBUG - [PANSTARRS1] SET LOCAL temp_buffers='5GB';
2022-11-27 11:46:26,001 - DEBUG - [PANSTARRS1] SET LOCAL enable_hashjoin=False;
2022-11-27 11:46:26,002 - DEBUG - [PANSTARRS1] Selecting unique targets into temporary table '43b64358': SELECT (row_number() OVER () + 63050396600614503) AS "catalogid", "t1"."catid_objid" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec" FROM "catalogdb"."panstarrs1" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_panstarrs1" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."catid_objid"))))
2022-12-01 11:27:11,798 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-01 11:27:11,798 - INFO - Reference Epoch = 2016.0
2022-12-01 11:27:12,426 - INFO - Query radius = 1.0
2022-12-01 11:27:12,427 - DEBUG - Current database configuration parameters.
2022-12-01 11:27:12,427 - DEBUG - shared_buffers = 76GB
2022-12-01 11:27:12,427 - DEBUG - effective_cache_size = 176GB
2022-12-01 11:27:12,427 - DEBUG - wal_buffers = 16MB
2022-12-01 11:27:12,428 - DEBUG - effective_io_concurrency = 200
2022-12-01 11:27:12,428 - DEBUG - work_mem = 5GB
2022-12-01 11:27:12,428 - DEBUG - max_worker_processes = 32
2022-12-01 11:27:12,428 - DEBUG - random_page_cost = 1
2022-12-01 11:27:12,428 - DEBUG - seq_page_cost = 0.5
2022-12-01 11:27:12,428 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-01 11:27:12,428 - DEBUG - cpu_operator_cost = 0.0025
2022-12-01 11:27:12,428 - DEBUG - default_statistics_target = 3000
2022-12-01 11:27:12,428 - DEBUG - temp_buffers = 10GB
2022-12-01 11:27:12,428 - DEBUG - plan_cache_mode = auto
2022-12-01 11:27:12,428 - DEBUG - geqo_effort = 5
2022-12-01 11:27:12,428 - DEBUG - force_parallel_mode = off
2022-12-01 11:27:12,428 - DEBUG - enable_seqscan = on
2022-12-01 11:27:12,428 - DEBUG - enable_nestloop = on
2022-12-01 11:27:12,437 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-01 11:27:12,448 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-01 11:27:12,848 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-01 11:27:13,028 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-01 11:27:14,054 - WARNING - Skipping table gaia_dr3_source.
2022-12-01 11:27:14,054 - WARNING - Skipping table gaia_dr2_source.
2022-12-01 11:27:14,054 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-12-01 11:27:14,054 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-12-01 11:27:14,055 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-12-01 11:27:14,055 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-12-01 11:27:14,055 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-12-01 11:27:14,063 - INFO - [LEGACY_SURVEY_DR10] Phase 1: linking existing targets.
2022-12-01 11:27:14,064 - DEBUG - [LEGACY_SURVEY_DR10] Found 2 paths between legacy_survey_dr10 and temporary output table.
2022-12-01 11:27:14,065 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-01 11:27:14,065 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-01 11:27:14,065 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-01 11:27:14,066 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '4f50e09f' with join path ['legacy_survey_dr10', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr3_source" AS "t3" ON ("t1"."gaia_dr3_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-12-01 22:54:13,894 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-12-01 23:26:35,453 - DEBUG - [LEGACY_SURVEY_DR10] Linked 233,744,330 records in 43161.389 s.
2022-12-01 23:26:35,454 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-01 23:26:55,541 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-01 23:26:55,544 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-01 23:26:55,544 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-01 23:26:55,545 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '383ef32c' with join path ['legacy_survey_dr10', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_dr2_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-12-02 01:12:27,174 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-12-02 01:15:46,893 - DEBUG - [LEGACY_SURVEY_DR10] Linked 30,928,916 records in 6531.357 s.
2022-12-02 01:15:46,894 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-02 01:17:40,421 - INFO - [LEGACY_SURVEY_DR10] Phase 2: cross-matching against existing targets.
2022-12-02 01:17:40,430 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matching model against temporary table.
2022-12-02 01:17:40,430 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-02 01:17:40,430 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-02 01:17:40,430 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-02 01:17:40,432 - DEBUG - [LEGACY_SURVEY_DR10] Inserting cross-matched data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."ls_id" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."legacy_survey_dr10" AS "t2" WHERE (((q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True) AND ("t2"."survey_primary" IS True)) AND (coalesce("t2"."ref_cat", ) != T2))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "catalog_to_legacy_survey_dr10" WHERE (("catalog_to_legacy_survey_dr10"."version_id" = 31) AND (("catalog_to_legacy_survey_dr10"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_legacy_survey_dr10"."target_id" = "xmatched"."target_id"))))
2022-12-02 10:31:05,421 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matched catalog_47cd76e43f74bbc2 with 2,360,003 targets in legacy_survey_dr10. Run in 33204.990 s.
2022-12-02 10:31:05,421 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-02 10:31:16,689 - INFO - [LEGACY_SURVEY_DR10] Phase 3: adding non cross-matched targets.
2022-12-02 10:31:16,698 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-02 10:31:16,698 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-02 10:31:16,698 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-02 10:31:16,699 - DEBUG - [LEGACY_SURVEY_DR10] Selecting unique targets into temporary table '7bf49ddd': SELECT (row_number() OVER () + 63050396600614503) AS "catalogid", "t1"."ls_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."legacy_survey_dr10" AS "t1" WHERE (((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."ls_id")))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", ) != T2))
2022-12-02 21:18:36,133 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-02 21:18:36,133 - INFO - Reference Epoch = 2016.0
2022-12-02 21:18:36,759 - INFO - Query radius = 1.0
2022-12-02 21:18:36,760 - DEBUG - Current database configuration parameters.
2022-12-02 21:18:36,761 - DEBUG - shared_buffers = 76GB
2022-12-02 21:18:36,761 - DEBUG - effective_cache_size = 176GB
2022-12-02 21:18:36,761 - DEBUG - wal_buffers = 16MB
2022-12-02 21:18:36,761 - DEBUG - effective_io_concurrency = 200
2022-12-02 21:18:36,761 - DEBUG - work_mem = 5GB
2022-12-02 21:18:36,761 - DEBUG - max_worker_processes = 32
2022-12-02 21:18:36,761 - DEBUG - random_page_cost = 1
2022-12-02 21:18:36,761 - DEBUG - seq_page_cost = 0.5
2022-12-02 21:18:36,761 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-02 21:18:36,761 - DEBUG - cpu_operator_cost = 0.0025
2022-12-02 21:18:36,761 - DEBUG - default_statistics_target = 3000
2022-12-02 21:18:36,761 - DEBUG - temp_buffers = 10GB
2022-12-02 21:18:36,761 - DEBUG - plan_cache_mode = auto
2022-12-02 21:18:36,761 - DEBUG - geqo_effort = 5
2022-12-02 21:18:36,761 - DEBUG - force_parallel_mode = off
2022-12-02 21:18:36,761 - DEBUG - enable_seqscan = on
2022-12-02 21:18:36,762 - DEBUG - enable_nestloop = on
2022-12-02 21:18:36,770 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-02 21:18:36,782 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-02 21:18:36,871 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-02 21:18:36,910 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-02 21:18:36,973 - WARNING - Skipping table gaia_dr3_source.
2022-12-02 21:18:36,973 - WARNING - Skipping table gaia_dr2_source.
2022-12-02 21:18:36,973 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-12-02 21:18:36,973 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-12-02 21:18:36,974 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-12-02 21:18:36,981 - INFO - [LEGACY_SURVEY_DR10] Phase 1: linking existing targets.
2022-12-02 21:18:36,981 - DEBUG - [LEGACY_SURVEY_DR10] Found 2 paths between legacy_survey_dr10 and temporary output table.
2022-12-02 21:18:36,982 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-02 21:18:36,982 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-02 21:18:36,983 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-02 21:18:36,984 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '85e32f71' with join path ['legacy_survey_dr10', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr3_source" AS "t3" ON ("t1"."gaia_dr3_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-03 08:31:05,137 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-12-03 09:03:26,065 - DEBUG - [LEGACY_SURVEY_DR10] Linked 233,744,330 records in 42289.083 s.
2022-12-03 09:03:26,066 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-03 09:03:45,916 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-03 09:03:45,916 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-03 09:03:45,916 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-03 09:03:45,917 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '0ac74d6b' with join path ['legacy_survey_dr10', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_dr2_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-03 10:43:15,324 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-12-03 10:46:34,704 - DEBUG - [LEGACY_SURVEY_DR10] Linked 30,928,916 records in 6168.791 s.
2022-12-03 10:46:34,705 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-03 10:48:23,175 - INFO - [LEGACY_SURVEY_DR10] Phase 2: cross-matching against existing targets.
2022-12-03 10:48:23,185 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matching model against temporary table.
2022-12-03 10:48:23,186 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-03 10:48:23,186 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-03 10:48:23,186 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-03 10:48:23,187 - DEBUG - [LEGACY_SURVEY_DR10] Inserting cross-matched data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."ls_id" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."legacy_survey_dr10" AS "t2" WHERE (((q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True) AND ("t2"."survey_primary" IS True)) AND (coalesce("t2"."ref_cat", '') != 'T2'))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "catalog_to_legacy_survey_dr10" WHERE (("catalog_to_legacy_survey_dr10"."version_id" = 31) AND (("catalog_to_legacy_survey_dr10"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_legacy_survey_dr10"."target_id" = "xmatched"."target_id"))))
2022-12-03 19:10:21,697 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matched catalog_47cd76e43f74bbc2 with 2,360,003 targets in legacy_survey_dr10. Run in 30118.511 s.
2022-12-03 19:10:21,700 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-03 19:10:32,315 - INFO - [LEGACY_SURVEY_DR10] Phase 3: adding non cross-matched targets.
2022-12-03 19:10:32,326 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-03 19:10:32,326 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-03 19:10:32,326 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-04 06:55:19,974 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-04 06:55:19,974 - INFO - Reference Epoch = 2016.0
2022-12-04 06:55:20,599 - INFO - Query radius = 1.0
2022-12-04 06:55:20,600 - DEBUG - Current database configuration parameters.
2022-12-04 06:55:20,600 - DEBUG - shared_buffers = 76GB
2022-12-04 06:55:20,600 - DEBUG - effective_cache_size = 176GB
2022-12-04 06:55:20,600 - DEBUG - wal_buffers = 16MB
2022-12-04 06:55:20,600 - DEBUG - effective_io_concurrency = 200
2022-12-04 06:55:20,600 - DEBUG - work_mem = 5GB
2022-12-04 06:55:20,600 - DEBUG - max_worker_processes = 32
2022-12-04 06:55:20,600 - DEBUG - random_page_cost = 1
2022-12-04 06:55:20,600 - DEBUG - seq_page_cost = 0.5
2022-12-04 06:55:20,600 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-04 06:55:20,600 - DEBUG - cpu_operator_cost = 0.0025
2022-12-04 06:55:20,600 - DEBUG - default_statistics_target = 3000
2022-12-04 06:55:20,600 - DEBUG - temp_buffers = 10GB
2022-12-04 06:55:20,600 - DEBUG - plan_cache_mode = auto
2022-12-04 06:55:20,600 - DEBUG - geqo_effort = 5
2022-12-04 06:55:20,600 - DEBUG - force_parallel_mode = off
2022-12-04 06:55:20,600 - DEBUG - enable_seqscan = on
2022-12-04 06:55:20,600 - DEBUG - enable_nestloop = on
2022-12-04 06:55:20,609 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-04 06:55:20,622 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-04 06:55:20,880 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-04 06:55:20,943 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-04 06:55:21,041 - WARNING - Skipping table gaia_dr3_source.
2022-12-04 06:55:21,041 - WARNING - Skipping table gaia_dr2_source.
2022-12-04 06:55:21,041 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-12-04 06:55:21,041 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-12-04 06:55:21,042 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-12-04 06:55:21,042 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-12-04 06:55:21,042 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-12-04 06:55:21,048 - INFO - [LEGACY_SURVEY_DR10] Phase 1: linking existing targets.
2022-12-04 06:55:21,049 - DEBUG - [LEGACY_SURVEY_DR10] Found 2 paths between legacy_survey_dr10 and temporary output table.
2022-12-04 06:55:21,050 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-04 06:55:21,050 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-04 06:55:21,050 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-04 06:55:21,051 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table 'a3b815ec' with join path ['legacy_survey_dr10', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr3_source" AS "t3" ON ("t1"."gaia_dr3_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-04 16:23:22,584 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-12-04 16:55:02,159 - DEBUG - [LEGACY_SURVEY_DR10] Linked 233,744,330 records in 35981.109 s.
2022-12-04 16:55:02,160 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-04 16:55:22,937 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-04 16:55:22,938 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-04 16:55:22,938 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-04 16:55:22,939 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table 'ec6f7b5a' with join path ['legacy_survey_dr10', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_dr2_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-04 18:34:29,650 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-12-04 18:37:46,106 - DEBUG - [LEGACY_SURVEY_DR10] Linked 30,928,916 records in 6143.169 s.
2022-12-04 18:37:46,106 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-04 18:39:39,968 - INFO - [LEGACY_SURVEY_DR10] Phase 2: cross-matching against existing targets.
2022-12-04 18:39:39,978 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matching model against temporary table.
2022-12-04 18:39:39,978 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-04 18:39:39,978 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-04 18:39:39,978 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-04 18:39:39,980 - DEBUG - [LEGACY_SURVEY_DR10] Inserting cross-matched data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."ls_id" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."legacy_survey_dr10" AS "t2" WHERE (((q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True) AND ("t2"."survey_primary" IS True)) AND (coalesce("t2"."ref_cat", '') != 'T2'))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "catalog_to_legacy_survey_dr10" WHERE (("catalog_to_legacy_survey_dr10"."version_id" = 31) AND (("catalog_to_legacy_survey_dr10"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_legacy_survey_dr10"."target_id" = "xmatched"."target_id"))))
2022-12-05 03:25:35,179 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matched catalog_47cd76e43f74bbc2 with 2,360,003 targets in legacy_survey_dr10. Run in 31555.201 s.
2022-12-05 03:25:35,181 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-05 03:25:45,923 - INFO - [LEGACY_SURVEY_DR10] Phase 3: adding non cross-matched targets.
2022-12-05 03:25:45,931 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-05 03:25:45,932 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-05 03:25:45,932 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-05 03:25:45,932 - DEBUG - [LEGACY_SURVEY_DR10] Selecting unique targets into table 'catalogdb.phase3_content_legacy_survey_dr10': SELECT (row_number() OVER () + 63050396600614503) AS "catalogid", "t1"."ls_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."legacy_survey_dr10" AS "t1" WHERE (((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."ls_id")))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2')) in Psql
2022-12-05 03:25:46,115 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."catalogdb.phase3_content_legacy_survey_dr10" AS "t1"
2022-12-05 09:39:15,979 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-05 09:39:15,979 - INFO - Reference Epoch = 2016.0
2022-12-05 09:39:16,611 - INFO - Query radius = 1.0
2022-12-05 09:39:16,612 - DEBUG - Current database configuration parameters.
2022-12-05 09:39:16,612 - DEBUG - shared_buffers = 76GB
2022-12-05 09:39:16,612 - DEBUG - effective_cache_size = 176GB
2022-12-05 09:39:16,612 - DEBUG - wal_buffers = 16MB
2022-12-05 09:39:16,612 - DEBUG - effective_io_concurrency = 200
2022-12-05 09:39:16,612 - DEBUG - work_mem = 5GB
2022-12-05 09:39:16,612 - DEBUG - max_worker_processes = 32
2022-12-05 09:39:16,612 - DEBUG - random_page_cost = 1
2022-12-05 09:39:16,612 - DEBUG - seq_page_cost = 0.5
2022-12-05 09:39:16,612 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-05 09:39:16,613 - DEBUG - cpu_operator_cost = 0.0025
2022-12-05 09:39:16,613 - DEBUG - default_statistics_target = 3000
2022-12-05 09:39:16,613 - DEBUG - temp_buffers = 10GB
2022-12-05 09:39:16,613 - DEBUG - plan_cache_mode = auto
2022-12-05 09:39:16,613 - DEBUG - geqo_effort = 5
2022-12-05 09:39:16,613 - DEBUG - force_parallel_mode = off
2022-12-05 09:39:16,613 - DEBUG - enable_seqscan = on
2022-12-05 09:39:16,613 - DEBUG - enable_nestloop = on
2022-12-05 09:39:16,621 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-05 09:39:16,634 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-05 09:39:16,951 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-05 09:39:16,981 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-05 09:39:17,105 - WARNING - Skipping table gaia_dr3_source.
2022-12-05 09:39:17,105 - WARNING - Skipping table gaia_dr2_source.
2022-12-05 09:39:17,105 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-12-05 09:39:17,105 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-12-05 09:39:17,106 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-12-05 09:39:17,106 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-12-05 09:39:17,106 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-12-05 09:39:17,106 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-12-05 09:39:17,112 - INFO - [LEGACY_SURVEY_DR10] Phase 1: linking existing targets.
2022-12-05 09:39:17,113 - DEBUG - [LEGACY_SURVEY_DR10] Found 2 paths between legacy_survey_dr10 and temporary output table.
2022-12-05 09:39:17,114 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-05 09:39:17,114 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-05 09:39:17,114 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-05 09:39:17,115 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '89405212' with join path ['legacy_survey_dr10', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr3_source" AS "t3" ON ("t1"."gaia_dr3_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-05 09:47:31,855 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-05 09:47:31,855 - INFO - Reference Epoch = 2016.0
2022-12-05 09:47:32,490 - INFO - Query radius = 1.0
2022-12-05 09:47:32,491 - DEBUG - Current database configuration parameters.
2022-12-05 09:47:32,491 - DEBUG - shared_buffers = 76GB
2022-12-05 09:47:32,491 - DEBUG - effective_cache_size = 176GB
2022-12-05 09:47:32,491 - DEBUG - wal_buffers = 16MB
2022-12-05 09:47:32,491 - DEBUG - effective_io_concurrency = 200
2022-12-05 09:47:32,491 - DEBUG - work_mem = 5GB
2022-12-05 09:47:32,491 - DEBUG - max_worker_processes = 32
2022-12-05 09:47:32,491 - DEBUG - random_page_cost = 1
2022-12-05 09:47:32,491 - DEBUG - seq_page_cost = 0.5
2022-12-05 09:47:32,491 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-05 09:47:32,492 - DEBUG - cpu_operator_cost = 0.0025
2022-12-05 09:47:32,492 - DEBUG - default_statistics_target = 3000
2022-12-05 09:47:32,492 - DEBUG - temp_buffers = 10GB
2022-12-05 09:47:32,492 - DEBUG - plan_cache_mode = auto
2022-12-05 09:47:32,492 - DEBUG - geqo_effort = 5
2022-12-05 09:47:32,492 - DEBUG - force_parallel_mode = off
2022-12-05 09:47:32,492 - DEBUG - enable_seqscan = on
2022-12-05 09:47:32,492 - DEBUG - enable_nestloop = on
2022-12-05 09:47:32,500 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-05 09:47:32,512 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-05 09:47:32,541 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-05 09:47:32,561 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-05 09:47:32,562 - WARNING - Skipping table gaia_dr3_source.
2022-12-05 09:47:32,562 - WARNING - Skipping table gaia_dr2_source.
2022-12-05 09:47:32,562 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-12-05 09:47:32,562 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-12-05 09:47:32,562 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-12-05 09:47:32,562 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-12-05 09:47:32,562 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-12-05 09:47:32,562 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-12-05 09:47:32,562 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-12-05 09:47:32,562 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-12-05 09:47:32,562 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-12-05 09:47:32,562 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-12-05 09:47:32,563 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-12-05 09:47:32,563 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-12-05 09:47:32,563 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-12-05 09:47:32,563 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-12-05 09:47:32,563 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-12-05 09:47:32,563 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-12-05 09:47:32,563 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-12-05 09:47:32,563 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-12-05 09:47:32,570 - INFO - [LEGACY_SURVEY_DR10] Phase 1: linking existing targets.
2022-12-05 09:47:32,570 - DEBUG - [LEGACY_SURVEY_DR10] Found 2 paths between legacy_survey_dr10 and temporary output table.
2022-12-05 09:47:32,571 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-05 09:47:32,572 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-05 09:47:32,572 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-05 09:47:32,573 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '528aaccb' with join path ['legacy_survey_dr10', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr3_source" AS "t3" ON ("t1"."gaia_dr3_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-05 09:53:58,053 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-05 09:53:58,053 - INFO - Reference Epoch = 2016.0
2022-12-05 09:53:58,689 - INFO - Query radius = 1.0
2022-12-05 09:53:58,690 - DEBUG - Current database configuration parameters.
2022-12-05 09:53:58,690 - DEBUG - shared_buffers = 76GB
2022-12-05 09:53:58,690 - DEBUG - effective_cache_size = 176GB
2022-12-05 09:53:58,690 - DEBUG - wal_buffers = 16MB
2022-12-05 09:53:58,690 - DEBUG - effective_io_concurrency = 200
2022-12-05 09:53:58,690 - DEBUG - work_mem = 5GB
2022-12-05 09:53:58,690 - DEBUG - max_worker_processes = 32
2022-12-05 09:53:58,690 - DEBUG - random_page_cost = 1
2022-12-05 09:53:58,690 - DEBUG - seq_page_cost = 0.5
2022-12-05 09:53:58,690 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-05 09:53:58,690 - DEBUG - cpu_operator_cost = 0.0025
2022-12-05 09:53:58,690 - DEBUG - default_statistics_target = 3000
2022-12-05 09:53:58,690 - DEBUG - temp_buffers = 10GB
2022-12-05 09:53:58,690 - DEBUG - plan_cache_mode = auto
2022-12-05 09:53:58,690 - DEBUG - geqo_effort = 5
2022-12-05 09:53:58,691 - DEBUG - force_parallel_mode = off
2022-12-05 09:53:58,691 - DEBUG - enable_seqscan = on
2022-12-05 09:53:58,691 - DEBUG - enable_nestloop = on
2022-12-05 09:53:58,699 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-05 09:53:58,711 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-05 09:53:58,736 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-05 09:53:58,738 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-05 09:53:58,739 - WARNING - Skipping table gaia_dr3_source.
2022-12-05 09:53:58,739 - WARNING - Skipping table gaia_dr2_source.
2022-12-05 09:53:58,739 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-12-05 09:53:58,739 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-12-05 09:53:58,740 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-12-05 09:53:58,740 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-12-05 09:53:58,740 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-12-05 09:53:58,740 - INFO - [LEGACY_SURVEY_DR10] Phase 3: adding non cross-matched targets.
2022-12-05 09:53:58,746 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-05 09:53:58,746 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-05 09:53:58,747 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-05 09:53:58,748 - DEBUG - [LEGACY_SURVEY_DR10] Selecting unique targets into table catalogdb.'phase3_content_legacy_survey_dr10' in PSLQ: : SELECT (row_number() OVER () + 63050396600614503) AS "catalogid", "t1"."ls_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."legacy_survey_dr10" AS "t1" WHERE (((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."ls_id")))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-05 09:57:13,899 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-05 09:57:13,899 - INFO - Reference Epoch = 2016.0
2022-12-05 09:57:14,530 - INFO - Query radius = 1.0
2022-12-05 09:57:14,531 - DEBUG - Current database configuration parameters.
2022-12-05 09:57:14,531 - DEBUG - shared_buffers = 76GB
2022-12-05 09:57:14,531 - DEBUG - effective_cache_size = 176GB
2022-12-05 09:57:14,531 - DEBUG - wal_buffers = 16MB
2022-12-05 09:57:14,532 - DEBUG - effective_io_concurrency = 200
2022-12-05 09:57:14,532 - DEBUG - work_mem = 5GB
2022-12-05 09:57:14,532 - DEBUG - max_worker_processes = 32
2022-12-05 09:57:14,532 - DEBUG - random_page_cost = 1
2022-12-05 09:57:14,532 - DEBUG - seq_page_cost = 0.5
2022-12-05 09:57:14,532 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-05 09:57:14,532 - DEBUG - cpu_operator_cost = 0.0025
2022-12-05 09:57:14,532 - DEBUG - default_statistics_target = 3000
2022-12-05 09:57:14,532 - DEBUG - temp_buffers = 10GB
2022-12-05 09:57:14,532 - DEBUG - plan_cache_mode = auto
2022-12-05 09:57:14,532 - DEBUG - geqo_effort = 5
2022-12-05 09:57:14,532 - DEBUG - force_parallel_mode = off
2022-12-05 09:57:14,532 - DEBUG - enable_seqscan = on
2022-12-05 09:57:14,532 - DEBUG - enable_nestloop = on
2022-12-05 09:57:14,541 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-05 09:57:14,553 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-05 09:57:14,578 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-05 09:57:14,580 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-05 09:57:14,581 - WARNING - Skipping table gaia_dr3_source.
2022-12-05 09:57:14,581 - WARNING - Skipping table gaia_dr2_source.
2022-12-05 09:57:14,581 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-12-05 09:57:14,581 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-12-05 09:57:14,581 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-12-05 09:57:14,581 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-12-05 09:57:14,581 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-12-05 09:57:14,581 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-12-05 09:57:14,581 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-12-05 09:57:14,582 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-12-05 09:57:14,582 - INFO - [LEGACY_SURVEY_DR10] Phase 3: adding non cross-matched targets.
2022-12-05 09:57:14,589 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-05 09:57:14,589 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-05 09:57:14,589 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-05 09:57:14,590 - DEBUG - [LEGACY_SURVEY_DR10] Selecting unique targets into table catalogdb.'phase3_content_legacy_survey_dr10' in PSLQ: : SELECT (row_number() OVER () + 63050396600614503) AS "catalogid", "t1"."ls_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."legacy_survey_dr10" AS "t1" WHERE (((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."ls_id")))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-05 19:04:45,990 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content_legacy_survey_dr10" AS "t1"
2022-12-05 23:50:20,236 - DEBUG - [LEGACY_SURVEY_DR10] Insertion into catalog_to_legacy_survey_dr10 completed with 2,860,425,843 rows in 49985.647 s.
2022-12-05 23:50:20,243 - DEBUG - [LEGACY_SURVEY_DR10] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec", "pmra", "pmdec", "parallax") SELECT "t1"."catalogid", 'legacy_survey_dr10', 31, "t1"."ra", "t1"."dec", "t1"."pmra", "t1"."pmdec", "t1"."parallax" FROM "phase3_content_legacy_survey_dr10" AS "t1"
2022-12-06 04:05:31,591 - DEBUG - [LEGACY_SURVEY_DR10] Inserted 2,860,425,843 rows. Total time: 65297.002 s.
2022-12-06 04:05:31,598 - DEBUG - [LEGACY_SURVEY_DR10] Running CLUSTER on catalog_47cd76e43f74bbc2 with q3c index.
2022-12-06 10:57:34,298 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_47cd76e43f74bbc2.
2022-12-06 10:59:38,031 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-06 11:15:27,281 - INFO - [LEGACY_SURVEY_DR10] Fully processed legacy_survey_dr10 in 91093 s.
2022-12-06 11:15:27,293 - INFO - Cross-matching completed in 91092.712 s.
2022-12-09 04:42:18,427 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-09 04:42:18,427 - INFO - Reference Epoch = 2016.0
2022-12-09 04:42:19,071 - INFO - Query radius = 1.0
2022-12-09 04:42:19,072 - DEBUG - Current database configuration parameters.
2022-12-09 04:42:19,072 - DEBUG - shared_buffers = 76GB
2022-12-09 04:42:19,072 - DEBUG - effective_cache_size = 176GB
2022-12-09 04:42:19,072 - DEBUG - wal_buffers = 16MB
2022-12-09 04:42:19,072 - DEBUG - effective_io_concurrency = 200
2022-12-09 04:42:19,072 - DEBUG - work_mem = 5GB
2022-12-09 04:42:19,072 - DEBUG - max_worker_processes = 32
2022-12-09 04:42:19,072 - DEBUG - random_page_cost = 1
2022-12-09 04:42:19,072 - DEBUG - seq_page_cost = 0.5
2022-12-09 04:42:19,072 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-09 04:42:19,072 - DEBUG - cpu_operator_cost = 0.0025
2022-12-09 04:42:19,072 - DEBUG - default_statistics_target = 3000
2022-12-09 04:42:19,072 - DEBUG - temp_buffers = 10GB
2022-12-09 04:42:19,072 - DEBUG - plan_cache_mode = auto
2022-12-09 04:42:19,072 - DEBUG - geqo_effort = 5
2022-12-09 04:42:19,072 - DEBUG - force_parallel_mode = off
2022-12-09 04:42:19,072 - DEBUG - enable_seqscan = on
2022-12-09 04:42:19,073 - DEBUG - enable_nestloop = on
2022-12-09 04:42:19,081 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-09 04:42:19,093 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-09 04:42:19,303 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-09 04:42:19,315 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-09 04:42:19,423 - WARNING - Skipping table gaia_dr3_source.
2022-12-09 04:42:19,423 - WARNING - Skipping table gaia_dr2_source.
2022-12-09 04:42:19,423 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-12-09 04:42:19,423 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-12-09 04:42:19,423 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-12-09 04:42:19,423 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-12-09 04:42:19,423 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-12-09 04:42:19,423 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-12-09 04:42:19,423 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-12-09 04:42:19,423 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-12-09 04:42:19,423 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-12-09 04:42:19,423 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-12-09 04:42:19,424 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-12-09 04:42:19,424 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-12-09 04:42:19,424 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-12-09 04:42:19,424 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-12-09 04:42:19,424 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-12-09 04:42:19,424 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-12-09 04:42:19,424 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-12-09 04:42:19,424 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-12-09 04:42:19,431 - INFO - [LEGACY_SURVEY_DR10] Phase 1: linking existing targets.
2022-12-09 04:42:19,431 - DEBUG - [LEGACY_SURVEY_DR10] Found 2 paths between legacy_survey_dr10 and temporary output table.
2022-12-09 04:42:19,432 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-09 04:42:19,432 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-09 04:42:19,433 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-09 04:42:19,434 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '60104a71' with join path ['legacy_survey_dr10', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr3_source" AS "t3" ON ("t1"."gaia_dr3_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-09 15:38:56,433 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-12-09 16:08:31,805 - DEBUG - [LEGACY_SURVEY_DR10] Linked 233,744,330 records in 41172.373 s.
2022-12-09 16:08:31,806 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-09 16:08:55,452 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-09 16:08:55,452 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-09 16:08:55,452 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-09 16:08:55,453 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '16c2391e' with join path ['legacy_survey_dr10', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_dr2_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-09 17:49:37,696 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-12-09 17:53:06,764 - DEBUG - [LEGACY_SURVEY_DR10] Linked 30,928,916 records in 6251.313 s.
2022-12-09 17:53:06,764 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-09 17:55:02,381 - INFO - [LEGACY_SURVEY_DR10] Phase 2: cross-matching against existing targets.
2022-12-09 17:55:02,390 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matching model against temporary table.
2022-12-09 17:55:02,390 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-09 17:55:02,391 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-09 17:55:02,391 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-09 17:55:02,392 - DEBUG - [LEGACY_SURVEY_DR10] Inserting cross-matched data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."ls_id" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."legacy_survey_dr10" AS "t2" WHERE (((q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True) AND ("t2"."survey_primary" IS True)) AND (coalesce("t2"."ref_cat", '') != 'T2'))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "catalog_to_legacy_survey_dr10" WHERE (("catalog_to_legacy_survey_dr10"."version_id" = 31) AND (("catalog_to_legacy_survey_dr10"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_legacy_survey_dr10"."target_id" = "xmatched"."target_id"))))
2022-12-10 13:30:24,027 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matched catalog_47cd76e43f74bbc2 with 2,866,647,847 targets in legacy_survey_dr10. Run in 70521.636 s.
2022-12-10 13:30:24,036 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-10 13:53:11,977 - INFO - [LEGACY_SURVEY_DR10] Phase 3: adding non cross-matched targets.
2022-12-10 13:53:11,994 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-10 13:53:11,995 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-10 13:53:11,995 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-10 13:53:11,996 - DEBUG - [LEGACY_SURVEY_DR10] Selecting unique targets into table catalogdb.'phase3_content_legacy_survey_dr10' in PSLQ: : SELECT (row_number() OVER () + 63050399461040347) AS "catalogid", "t1"."ls_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."legacy_survey_dr10" AS "t1" WHERE (((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."ls_id")))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-10 22:30:39,704 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content_legacy_survey_dr10" AS "t1"
2022-12-12 10:32:55,419 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-12 10:32:55,420 - INFO - Reference Epoch = 2016.0
2022-12-12 10:32:56,051 - INFO - Query radius = 1.0
2022-12-12 10:32:56,052 - DEBUG - Current database configuration parameters.
2022-12-12 10:32:56,052 - DEBUG - shared_buffers = 76GB
2022-12-12 10:32:56,052 - DEBUG - effective_cache_size = 176GB
2022-12-12 10:32:56,052 - DEBUG - wal_buffers = 16MB
2022-12-12 10:32:56,052 - DEBUG - effective_io_concurrency = 200
2022-12-12 10:32:56,052 - DEBUG - work_mem = 5GB
2022-12-12 10:32:56,052 - DEBUG - max_worker_processes = 32
2022-12-12 10:32:56,052 - DEBUG - random_page_cost = 1
2022-12-12 10:32:56,053 - DEBUG - seq_page_cost = 0.5
2022-12-12 10:32:56,053 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-12 10:32:56,053 - DEBUG - cpu_operator_cost = 0.0025
2022-12-12 10:32:56,053 - DEBUG - default_statistics_target = 3000
2022-12-12 10:32:56,053 - DEBUG - temp_buffers = 10GB
2022-12-12 10:32:56,053 - DEBUG - plan_cache_mode = auto
2022-12-12 10:32:56,053 - DEBUG - geqo_effort = 5
2022-12-12 10:32:56,053 - DEBUG - force_parallel_mode = off
2022-12-12 10:32:56,053 - DEBUG - enable_seqscan = on
2022-12-12 10:32:56,053 - DEBUG - enable_nestloop = on
2022-12-12 10:32:56,061 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-12 10:32:56,074 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-12 10:32:56,285 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-12 10:32:56,287 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-12 10:32:56,290 - WARNING - Skipping table gaia_dr3_source.
2022-12-12 10:32:56,290 - WARNING - Skipping table gaia_dr2_source.
2022-12-12 10:32:56,290 - INFO - [LEGACY_SURVEY_DR10] Processing table legacy_survey_dr10.
2022-12-12 10:32:56,290 - DEBUG - [LEGACY_SURVEY_DR10] Table cross-matching parameters:
2022-12-12 10:32:56,290 - DEBUG - [LEGACY_SURVEY_DR10] ra_column: ra
2022-12-12 10:32:56,290 - DEBUG - [LEGACY_SURVEY_DR10] dec_column: dec
2022-12-12 10:32:56,290 - DEBUG - [LEGACY_SURVEY_DR10] pmra_column: pmra
2022-12-12 10:32:56,290 - DEBUG - [LEGACY_SURVEY_DR10] pmdec_column: pmdec
2022-12-12 10:32:56,290 - DEBUG - [LEGACY_SURVEY_DR10] is_pmra_cos: true
2022-12-12 10:32:56,290 - DEBUG - [LEGACY_SURVEY_DR10] parallax_column: parallax
2022-12-12 10:32:56,290 - DEBUG - [LEGACY_SURVEY_DR10] epoch: 2016.0
2022-12-12 10:32:56,290 - DEBUG - [LEGACY_SURVEY_DR10] epoch_column: none
2022-12-12 10:32:56,290 - DEBUG - [LEGACY_SURVEY_DR10] epoch_format: jyear
2022-12-12 10:32:56,291 - DEBUG - [LEGACY_SURVEY_DR10] has_duplicates: false
2022-12-12 10:32:56,291 - DEBUG - [LEGACY_SURVEY_DR10] skip: false
2022-12-12 10:32:56,291 - DEBUG - [LEGACY_SURVEY_DR10] skip_phases: []
2022-12-12 10:32:56,291 - DEBUG - [LEGACY_SURVEY_DR10] query_radius: 1.0
2022-12-12 10:32:56,291 - DEBUG - [LEGACY_SURVEY_DR10] row_count: 3,171,715,300
2022-12-12 10:32:56,291 - DEBUG - [LEGACY_SURVEY_DR10] resolution: nan
2022-12-12 10:32:56,291 - DEBUG - [LEGACY_SURVEY_DR10] join_weight: 1
2022-12-12 10:32:56,298 - INFO - [LEGACY_SURVEY_DR10] Phase 1: linking existing targets.
2022-12-12 10:32:56,299 - DEBUG - [LEGACY_SURVEY_DR10] Found 2 paths between legacy_survey_dr10 and temporary output table.
2022-12-12 10:32:56,300 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-12 10:32:56,300 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-12 10:32:56,300 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-12 10:32:56,301 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table '890d75a8' with join path ['legacy_survey_dr10', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr3_source" AS "t3" ON ("t1"."gaia_dr3_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-12 21:33:54,323 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-12-12 22:06:12,810 - DEBUG - [LEGACY_SURVEY_DR10] Linked 233,744,330 records in 41596.510 s.
2022-12-12 22:06:12,811 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-12 22:08:08,792 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-12 22:08:08,793 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-12 22:08:08,793 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-12 22:08:08,794 - DEBUG - [LEGACY_SURVEY_DR10] Selecting linked targets into temporary table 'dcf33c70' with join path ['legacy_survey_dr10', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr10" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_dr2_source_id" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-12 23:43:28,746 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10'.
2022-12-12 23:46:46,786 - DEBUG - [LEGACY_SURVEY_DR10] Linked 30,928,916 records in 5917.995 s.
2022-12-12 23:46:46,787 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-12 23:49:12,410 - INFO - [LEGACY_SURVEY_DR10] Phase 2: cross-matching against existing targets.
2022-12-12 23:49:12,418 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matching model against temporary table.
2022-12-12 23:49:12,419 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-12 23:49:12,419 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-12 23:49:12,419 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-12 23:49:12,420 - DEBUG - [LEGACY_SURVEY_DR10] Inserting cross-matched data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."ls_id" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."legacy_survey_dr10" AS "t2" WHERE (((q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True) AND ("t2"."survey_primary" IS True)) AND (coalesce("t2"."ref_cat", '') != 'T2'))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "catalog_to_legacy_survey_dr10" WHERE (("catalog_to_legacy_survey_dr10"."version_id" = 31) AND (("catalog_to_legacy_survey_dr10"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_legacy_survey_dr10"."target_id" = "xmatched"."target_id"))))
2022-12-13 09:54:48,788 - DEBUG - [LEGACY_SURVEY_DR10] Cross-matched catalog_47cd76e43f74bbc2 with 2,360,003 targets in legacy_survey_dr10. Run in 36336.369 s.
2022-12-13 09:54:48,789 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-13 09:55:30,928 - INFO - [LEGACY_SURVEY_DR10] Phase 3: adding non cross-matched targets.
2022-12-13 09:55:30,938 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL work_mem='10GB';
2022-12-13 09:55:30,938 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL temp_buffers='5GB';
2022-12-13 09:55:30,938 - DEBUG - [LEGACY_SURVEY_DR10] SET LOCAL enable_hashjoin=False;
2022-12-13 09:55:30,939 - DEBUG - [LEGACY_SURVEY_DR10] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050396600614503) AS "catalogid", "t1"."ls_id" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."legacy_survey_dr10" AS "t1" WHERE (((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr10" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."ls_id")))) AND ("t1"."survey_primary" IS True)) AND (coalesce("t1"."ref_cat", '') != 'T2'))
2022-12-13 18:54:10,478 - DEBUG - [LEGACY_SURVEY_DR10] Copying data into relational model 'catalog_to_legacy_survey_dr10': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr10" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2022-12-14 02:43:55,604 - DEBUG - [LEGACY_SURVEY_DR10] Insertion into catalog_to_legacy_survey_dr10 completed with 2,860,425,843 rows in 60504.666 s.
2022-12-14 02:43:55,610 - DEBUG - [LEGACY_SURVEY_DR10] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec", "pmra", "pmdec", "parallax") SELECT "t1"."catalogid", 'legacy_survey_dr10', 31, "t1"."ra", "t1"."dec", "t1"."pmra", "t1"."pmdec", "t1"."parallax" FROM "phase3_content" AS "t1"
2022-12-14 12:49:56,780 - DEBUG - [LEGACY_SURVEY_DR10] Inserted 2,860,425,843 rows. Total time: 96865.843 s.
2022-12-14 12:49:56,781 - DEBUG - [LEGACY_SURVEY_DR10] Running CLUSTER on catalog_47cd76e43f74bbc2 with q3c index.
2022-12-14 22:49:41,487 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_47cd76e43f74bbc2.
2022-12-14 22:57:57,394 - DEBUG - [LEGACY_SURVEY_DR10] Running ANALYZE on catalog_to_legacy_survey_dr10.
2022-12-15 00:33:25,988 - INFO - [LEGACY_SURVEY_DR10] Fully processed legacy_survey_dr10 in 223230 s.
2022-12-15 00:33:26,000 - INFO - [LEGACY_SURVEY_DR8] Processing table legacy_survey_dr8.
2022-12-15 00:33:26,000 - DEBUG - [LEGACY_SURVEY_DR8] Table cross-matching parameters:
2022-12-15 00:33:26,000 - DEBUG - [LEGACY_SURVEY_DR8] ra_column: ra
2022-12-15 00:33:26,000 - DEBUG - [LEGACY_SURVEY_DR8] dec_column: dec
2022-12-15 00:33:26,000 - DEBUG - [LEGACY_SURVEY_DR8] pmra_column: pmra
2022-12-15 00:33:26,000 - DEBUG - [LEGACY_SURVEY_DR8] pmdec_column: pmdec
2022-12-15 00:33:26,000 - DEBUG - [LEGACY_SURVEY_DR8] is_pmra_cos: true
2022-12-15 00:33:26,000 - DEBUG - [LEGACY_SURVEY_DR8] parallax_column: parallax
2022-12-15 00:33:26,000 - DEBUG - [LEGACY_SURVEY_DR8] epoch: none
2022-12-15 00:33:26,000 - DEBUG - [LEGACY_SURVEY_DR8] epoch_column: ref_epoch
2022-12-15 00:33:26,001 - DEBUG - [LEGACY_SURVEY_DR8] epoch_format: jyear
2022-12-15 00:33:26,001 - DEBUG - [LEGACY_SURVEY_DR8] has_duplicates: false
2022-12-15 00:33:26,001 - DEBUG - [LEGACY_SURVEY_DR8] skip: false
2022-12-15 00:33:26,001 - DEBUG - [LEGACY_SURVEY_DR8] skip_phases: []
2022-12-15 00:33:26,001 - DEBUG - [LEGACY_SURVEY_DR8] query_radius: 1.0
2022-12-15 00:33:26,001 - DEBUG - [LEGACY_SURVEY_DR8] row_count: 1,646,664,700
2022-12-15 00:33:26,001 - DEBUG - [LEGACY_SURVEY_DR8] resolution: nan
2022-12-15 00:33:26,001 - DEBUG - [LEGACY_SURVEY_DR8] join_weight: 1
2022-12-15 00:33:26,009 - INFO - [LEGACY_SURVEY_DR8] Phase 1: linking existing targets.
2022-12-15 00:33:26,010 - DEBUG - [LEGACY_SURVEY_DR8] Found 1 paths between legacy_survey_dr8 and temporary output table.
2022-12-15 00:33:26,012 - DEBUG - [LEGACY_SURVEY_DR8] SET LOCAL work_mem='10GB';
2022-12-15 00:33:26,012 - DEBUG - [LEGACY_SURVEY_DR8] SET LOCAL temp_buffers='5GB';
2022-12-15 00:33:26,012 - DEBUG - [LEGACY_SURVEY_DR8] SET LOCAL enable_hashjoin=False;
2022-12-15 00:33:26,013 - DEBUG - [LEGACY_SURVEY_DR8] Selecting linked targets into temporary table '38cd1ab5' with join path ['legacy_survey_dr8', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."ls_id", "t2"."catalogid") "t1"."ls_id" AS "target_id", "t2"."catalogid", (first_value("t1"."ls_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."ls_id" ASC) = "t1"."ls_id") AS "best" FROM "catalogdb"."legacy_survey_dr8" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_sourceid" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE (((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr8" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."ls_id") OR ("t4"."catalogid" = "t2"."catalogid"))))) AND NOT ((((("t1"."release" = 8000) AND ("t1"."dec" > 32.375)) AND ("t1"."ra" > 100.0)) AND ("t1"."ra" < 300.0)) OR (("t1"."release" = 8001) AND ("t1"."dec" < 32.375))))
2022-12-15 05:58:19,720 - DEBUG - [LEGACY_SURVEY_DR8] Copying data into relational model 'catalog_to_legacy_survey_dr8'.
2022-12-15 06:23:22,507 - DEBUG - [LEGACY_SURVEY_DR8] Linked 120,531,029 records in 20996.497 s.
2022-12-15 06:23:22,509 - DEBUG - [LEGACY_SURVEY_DR8] Running ANALYZE on catalog_to_legacy_survey_dr8.
2022-12-15 07:09:42,814 - INFO - [LEGACY_SURVEY_DR8] Phase 2: cross-matching against existing targets.
2022-12-15 07:09:42,822 - DEBUG - [LEGACY_SURVEY_DR8] Determining maximum epoch delta between catalogues.
2022-12-15 07:21:16,477 - DEBUG - [LEGACY_SURVEY_DR8] Maximum epoch delta: 24.815 (+ 0.1 year).
2022-12-15 07:21:16,479 - DEBUG - [LEGACY_SURVEY_DR8] Cross-matching model against temporary table.
2022-12-15 07:21:16,479 - DEBUG - [LEGACY_SURVEY_DR8] SET LOCAL work_mem='10GB';
2022-12-15 07:21:16,479 - DEBUG - [LEGACY_SURVEY_DR8] SET LOCAL temp_buffers='5GB';
2022-12-15 07:21:16,479 - DEBUG - [LEGACY_SURVEY_DR8] SET LOCAL enable_hashjoin=False;
2022-12-15 07:21:16,481 - DEBUG - [LEGACY_SURVEY_DR8] Inserting cross-matched data into relational model 'catalog_to_legacy_survey_dr8': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr8" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."ls_id" AS "target_id", q3c_dist_pm("t2"."ra", "t2"."dec", "t2"."pmra", "t2"."pmdec", 1, nullif("t2"."ref_epoch", 0), "t1"."ra", "t1"."dec", 2016.0) AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."legacy_survey_dr8" AS "t2" WHERE ((q3c_join_pm("t2"."ra", "t2"."dec", "t2"."pmra", "t2"."pmdec", 1, nullif("t2"."ref_epoch", 0), "t1"."ra", "t1"."dec", 2016.0, 24.815087890625, 0.0002777777777777778) AND True) AND NOT ((((("t2"."release" = 8000) AND ("t2"."dec" > 32.375)) AND ("t2"."ra" > 100.0)) AND ("t2"."ra" < 300.0)) OR (("t2"."release" = 8001) AND ("t2"."dec" < 32.375))))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr8" AS "catalog_to_legacy_survey_dr8" WHERE (("catalog_to_legacy_survey_dr8"."version_id" = 31) AND (("catalog_to_legacy_survey_dr8"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_legacy_survey_dr8"."target_id" = "xmatched"."target_id"))))
2022-12-15 19:47:31,399 - DEBUG - [LEGACY_SURVEY_DR8] Cross-matched catalog_47cd76e43f74bbc2 with 1,446,635,214 targets in legacy_survey_dr8. Run in 44774.921 s.
2022-12-15 19:47:31,408 - DEBUG - [LEGACY_SURVEY_DR8] Running ANALYZE on catalog_to_legacy_survey_dr8.
2022-12-15 20:26:07,666 - INFO - [LEGACY_SURVEY_DR8] Phase 3: adding non cross-matched targets.
2022-12-15 20:26:07,736 - DEBUG - [LEGACY_SURVEY_DR8] SET LOCAL work_mem='10GB';
2022-12-15 20:26:07,736 - DEBUG - [LEGACY_SURVEY_DR8] SET LOCAL temp_buffers='5GB';
2022-12-15 20:26:07,737 - DEBUG - [LEGACY_SURVEY_DR8] SET LOCAL enable_hashjoin=False;
2022-12-15 20:26:07,739 - DEBUG - [LEGACY_SURVEY_DR8] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050399461040346) AS "catalogid", "t1"."ls_id" AS "target_id", ("t1"."ra" + ((((coalesce("t1"."pmra", 0) / 1000.0) / 3600.0) / cos(radians(coalesce("t1"."dec", 0)))) * coalesce((2016.0 - nullif("t1"."ref_epoch", 0)), 0))) AS "ra", ("t1"."dec" + (((coalesce("t1"."pmdec", 0) / 1000.0) / 3600.0) * coalesce((2016.0 - nullif("t1"."ref_epoch", 0)), 0))) AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."parallax" AS "parallax" FROM "catalogdb"."legacy_survey_dr8" AS "t1" WHERE ((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_legacy_survey_dr8" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."ls_id")))) AND NOT ((((("t1"."release" = 8000) AND ("t1"."dec" > 32.375)) AND ("t1"."ra" > 100.0)) AND ("t1"."ra" < 300.0)) OR (("t1"."release" = 8001) AND ("t1"."dec" < 32.375))))
2022-12-15 22:43:00,697 - DEBUG - [LEGACY_SURVEY_DR8] Copying data into relational model 'catalog_to_legacy_survey_dr8': INSERT INTO "catalogdb"."catalog_to_legacy_survey_dr8" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2022-12-16 04:53:53,783 - DEBUG - [LEGACY_SURVEY_DR8] Insertion into catalog_to_legacy_survey_dr8 completed with 40,700,294 rows in 30466.047 s.
2022-12-16 04:53:53,786 - DEBUG - [LEGACY_SURVEY_DR8] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec", "pmra", "pmdec", "parallax") SELECT "t1"."catalogid", 'legacy_survey_dr8', 31, "t1"."ra", "t1"."dec", "t1"."pmra", "t1"."pmdec", "t1"."parallax" FROM "phase3_content" AS "t1"
2022-12-16 06:35:14,877 - DEBUG - [LEGACY_SURVEY_DR8] Inserted 40,700,294 rows. Total time: 36547.141 s.
2022-12-16 06:35:14,882 - DEBUG - [LEGACY_SURVEY_DR8] Running ANALYZE on catalog_to_legacy_survey_dr8.
2022-12-16 07:24:01,841 - INFO - [LEGACY_SURVEY_DR8] Fully processed legacy_survey_dr8 in 111036 s.
2022-12-16 07:24:01,938 - INFO - [PANSTARRS1] Processing table panstarrs1.
2022-12-16 07:24:01,938 - DEBUG - [PANSTARRS1] Table cross-matching parameters:
2022-12-16 07:24:01,938 - DEBUG - [PANSTARRS1] ra_column: ra
2022-12-16 07:24:01,938 - DEBUG - [PANSTARRS1] dec_column: dec
2022-12-16 07:24:01,938 - DEBUG - [PANSTARRS1] pmra_column: none
2022-12-16 07:24:01,938 - DEBUG - [PANSTARRS1] pmdec_column: none
2022-12-16 07:24:01,938 - DEBUG - [PANSTARRS1] is_pmra_cos: true
2022-12-16 07:24:01,938 - DEBUG - [PANSTARRS1] parallax_column: none
2022-12-16 07:24:01,938 - DEBUG - [PANSTARRS1] epoch: none
2022-12-16 07:24:01,938 - DEBUG - [PANSTARRS1] epoch_column: none
2022-12-16 07:24:01,939 - DEBUG - [PANSTARRS1] epoch_format: jyear
2022-12-16 07:24:01,939 - DEBUG - [PANSTARRS1] has_duplicates: false
2022-12-16 07:24:01,939 - DEBUG - [PANSTARRS1] skip: false
2022-12-16 07:24:01,939 - DEBUG - [PANSTARRS1] skip_phases: []
2022-12-16 07:24:01,939 - DEBUG - [PANSTARRS1] query_radius: 1
2022-12-16 07:24:01,939 - DEBUG - [PANSTARRS1] row_count: 2,767,937,500
2022-12-16 07:24:01,939 - DEBUG - [PANSTARRS1] resolution: nan
2022-12-16 07:24:01,939 - DEBUG - [PANSTARRS1] join_weight: 1
2022-12-16 07:24:01,948 - INFO - [PANSTARRS1] Phase 1: linking existing targets.
2022-12-16 07:24:01,949 - DEBUG - [PANSTARRS1] Found 1 paths between panstarrs1 and temporary output table.
2022-12-16 07:24:01,951 - DEBUG - [PANSTARRS1] SET LOCAL work_mem='10GB';
2022-12-16 07:24:01,951 - DEBUG - [PANSTARRS1] SET LOCAL temp_buffers='5GB';
2022-12-16 07:24:01,951 - DEBUG - [PANSTARRS1] SET LOCAL enable_hashjoin=False;
2022-12-16 07:24:01,952 - DEBUG - [PANSTARRS1] Selecting linked targets into temporary table '510b984f' with join path ['panstarrs1', 'gaia_edr3_panstarrs1_best_neighbour', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."catid_objid", "t2"."catalogid") "t1"."catid_objid" AS "target_id", "t2"."catalogid", (first_value("t1"."catid_objid") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."catid_objid" ASC) = "t1"."catid_objid") AS "best" FROM "catalogdb"."panstarrs1" AS "t1" INNER JOIN "catalogdb"."gaia_edr3_panstarrs1_best_neighbour" AS "t3" ON ("t1"."extid_hi_lo" = "t3"."original_ext_source_id") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t4" ON ("t3"."source_id" = "t4"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t4"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_panstarrs1" AS "t5" WHERE (("t5"."version_id" = 31) AND (("t5"."target_id" = "t1"."catid_objid") OR ("t5"."catalogid" = "t2"."catalogid")))))
2022-12-16 21:05:15,399 - DEBUG - [PANSTARRS1] Copying data into relational model 'catalog_to_panstarrs1'.
2022-12-16 23:51:31,863 - DEBUG - [PANSTARRS1] Linked 876,385,606 records in 59249.913 s.
2022-12-16 23:51:31,869 - DEBUG - [PANSTARRS1] Running ANALYZE on catalog_to_panstarrs1.
2022-12-17 01:44:49,721 - INFO - [PANSTARRS1] Phase 2: cross-matching against existing targets.
2022-12-17 01:44:49,831 - DEBUG - [PANSTARRS1] Cross-matching model against temporary table.
2022-12-17 01:44:49,832 - DEBUG - [PANSTARRS1] SET LOCAL work_mem='10GB';
2022-12-17 01:44:49,833 - DEBUG - [PANSTARRS1] SET LOCAL temp_buffers='5GB';
2022-12-17 01:44:49,833 - DEBUG - [PANSTARRS1] SET LOCAL enable_hashjoin=False;
2022-12-17 01:44:49,834 - DEBUG - [PANSTARRS1] Inserting cross-matched data into relational model 'catalog_to_panstarrs1': INSERT INTO "catalogdb"."catalog_to_panstarrs1" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."catid_objid" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."panstarrs1" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_panstarrs1" AS "catalog_to_panstarrs1" WHERE (("catalog_to_panstarrs1"."version_id" = 31) AND (("catalog_to_panstarrs1"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_panstarrs1"."target_id" = "xmatched"."target_id"))))
2022-12-18 04:01:48,567 - DEBUG - [PANSTARRS1] Cross-matched catalog_47cd76e43f74bbc2 with 795,844,855 targets in panstarrs1. Run in 94618.735 s.
2022-12-18 04:01:48,574 - DEBUG - [PANSTARRS1] Running ANALYZE on catalog_to_panstarrs1.
2022-12-18 05:22:40,536 - INFO - [PANSTARRS1] Phase 3: adding non cross-matched targets.
2022-12-18 05:22:40,548 - DEBUG - [PANSTARRS1] SET LOCAL work_mem='10GB';
2022-12-18 05:22:40,549 - DEBUG - [PANSTARRS1] SET LOCAL temp_buffers='5GB';
2022-12-18 05:22:40,549 - DEBUG - [PANSTARRS1] SET LOCAL enable_hashjoin=False;
2022-12-18 05:22:40,550 - DEBUG - [PANSTARRS1] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050399501740640) AS "catalogid", "t1"."catid_objid" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec" FROM "catalogdb"."panstarrs1" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_panstarrs1" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."catid_objid"))))
2022-12-18 05:22:40,550 - POST_PROCESS_NOTE - [PANSTARRS1] This phase failed because the query plan was not optimal and it was fixed using the enable_hashjoin option in the psql query
2022-12-18 05:22:40,550 - POST_PROCESS_NOTE - [PANSTARRS1] which was used in peewee before but it wasn't being transferred to the psql file used for this phase
2022-12-21 13:17:21,017 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-21 13:17:21,017 - INFO - Reference Epoch = 2016.0
2022-12-21 13:17:21,641 - INFO - Query radius = 1.0
2022-12-21 13:17:21,642 - DEBUG - Current database configuration parameters.
2022-12-21 13:17:21,642 - DEBUG - shared_buffers = 76GB
2022-12-21 13:17:21,642 - DEBUG - effective_cache_size = 176GB
2022-12-21 13:17:21,642 - DEBUG - wal_buffers = 16MB
2022-12-21 13:17:21,642 - DEBUG - effective_io_concurrency = 200
2022-12-21 13:17:21,642 - DEBUG - work_mem = 5GB
2022-12-21 13:17:21,642 - DEBUG - max_worker_processes = 32
2022-12-21 13:17:21,642 - DEBUG - random_page_cost = 1
2022-12-21 13:17:21,642 - DEBUG - seq_page_cost = 0.5
2022-12-21 13:17:21,642 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-21 13:17:21,642 - DEBUG - cpu_operator_cost = 0.0025
2022-12-21 13:17:21,642 - DEBUG - default_statistics_target = 3000
2022-12-21 13:17:21,642 - DEBUG - temp_buffers = 10GB
2022-12-21 13:17:21,642 - DEBUG - plan_cache_mode = auto
2022-12-21 13:17:21,642 - DEBUG - geqo_effort = 5
2022-12-21 13:17:21,642 - DEBUG - force_parallel_mode = off
2022-12-21 13:17:21,643 - DEBUG - enable_seqscan = on
2022-12-21 13:17:21,643 - DEBUG - enable_nestloop = on
2022-12-21 13:17:21,721 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-21 13:17:21,735 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-21 13:17:21,994 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-21 13:17:22,173 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-21 13:17:22,278 - WARNING - Skipping table gaia_dr3_source.
2022-12-21 13:17:22,278 - WARNING - Skipping table gaia_dr2_source.
2022-12-21 13:17:22,278 - WARNING - Skipping table legacy_survey_dr10.
2022-12-21 13:17:22,278 - WARNING - Skipping table legacy_survey_dr8.
2022-12-21 13:17:22,278 - INFO - [PANSTARRS1] Processing table panstarrs1.
2022-12-21 13:17:22,278 - DEBUG - [PANSTARRS1] Table cross-matching parameters:
2022-12-21 13:17:22,278 - DEBUG - [PANSTARRS1] ra_column: ra
2022-12-21 13:17:22,278 - DEBUG - [PANSTARRS1] dec_column: dec
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] pmra_column: none
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] pmdec_column: none
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] is_pmra_cos: true
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] parallax_column: none
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] epoch: none
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] epoch_column: none
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] epoch_format: jyear
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] has_duplicates: false
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] skip: false
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] skip_phases: []
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] query_radius: 1
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] row_count: 2,767,937,500
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] resolution: nan
2022-12-21 13:17:22,279 - DEBUG - [PANSTARRS1] join_weight: 1
2022-12-21 13:17:22,279 - INFO - [PANSTARRS1] Setting phases run 1 and 2
2022-12-21 13:17:22,279 - INFO - [PANSTARRS1] Phase 3: adding non cross-matched targets.
2022-12-21 13:17:22,286 - DEBUG - [PANSTARRS1] SET LOCAL work_mem='10GB';
2022-12-21 13:17:22,287 - DEBUG - [PANSTARRS1] SET LOCAL temp_buffers='5GB';
2022-12-21 13:17:22,287 - DEBUG - [PANSTARRS1] SET LOCAL enable_hashjoin=False;
2022-12-21 13:17:22,288 - DEBUG - [PANSTARRS1] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050399501740641) AS "catalogid", "t1"."catid_objid" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec" FROM "catalogdb"."panstarrs1" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_panstarrs1" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."catid_objid"))))
2022-12-21 20:46:43,535 - DEBUG - [PANSTARRS1] Copying data into relational model 'catalog_to_panstarrs1': INSERT INTO "catalogdb"."catalog_to_panstarrs1" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2022-12-22 03:05:36,464 - DEBUG - [PANSTARRS1] Insertion into catalog_to_panstarrs1 completed with 1,104,170,940 rows in 49694.178 s.
2022-12-22 03:05:36,470 - DEBUG - [PANSTARRS1] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec") SELECT "t1"."catalogid", 'panstarrs1', 31, "t1"."ra", "t1"."dec" FROM "phase3_content" AS "t1"
2022-12-22 06:03:09,751 - DEBUG - [PANSTARRS1] Inserted 1,104,170,940 rows. Total time: 60347.465 s.
2022-12-22 06:03:09,753 - DEBUG - [PANSTARRS1] Running ANALYZE on catalog_to_panstarrs1.
2022-12-22 07:40:49,890 - INFO - [PANSTARRS1] Fully processed panstarrs1 in 66208 s.
2022-12-22 07:40:49,981 - INFO - Cross-matching completed in 66207.703 s.
2022-12-22 08:21:49,219 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-22 08:21:49,219 - INFO - Reference Epoch = 2016.0
2022-12-22 08:21:49,848 - INFO - Query radius = 1.0
2022-12-22 08:21:49,849 - DEBUG - Current database configuration parameters.
2022-12-22 08:21:49,849 - DEBUG - shared_buffers = 76GB
2022-12-22 08:21:49,849 - DEBUG - effective_cache_size = 176GB
2022-12-22 08:21:49,849 - DEBUG - wal_buffers = 16MB
2022-12-22 08:21:49,849 - DEBUG - effective_io_concurrency = 200
2022-12-22 08:21:49,849 - DEBUG - work_mem = 5GB
2022-12-22 08:21:49,849 - DEBUG - max_worker_processes = 32
2022-12-22 08:21:49,850 - DEBUG - random_page_cost = 1
2022-12-22 08:21:49,850 - DEBUG - seq_page_cost = 0.5
2022-12-22 08:21:49,850 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-22 08:21:49,850 - DEBUG - cpu_operator_cost = 0.0025
2022-12-22 08:21:49,850 - DEBUG - default_statistics_target = 3000
2022-12-22 08:21:49,850 - DEBUG - temp_buffers = 10GB
2022-12-22 08:21:49,850 - DEBUG - plan_cache_mode = auto
2022-12-22 08:21:49,850 - DEBUG - geqo_effort = 5
2022-12-22 08:21:49,850 - DEBUG - force_parallel_mode = off
2022-12-22 08:21:49,850 - DEBUG - enable_seqscan = on
2022-12-22 08:21:49,850 - DEBUG - enable_nestloop = on
2022-12-22 08:21:49,858 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-22 08:21:49,871 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-22 08:21:50,030 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-22 08:21:50,048 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-22 08:21:50,050 - WARNING - Skipping table gaia_dr3_source.
2022-12-22 08:21:50,050 - WARNING - Skipping table gaia_dr2_source.
2022-12-22 08:21:50,050 - WARNING - Skipping table legacy_survey_dr10.
2022-12-22 08:21:50,050 - WARNING - Skipping table legacy_survey_dr8.
2022-12-22 08:21:50,050 - WARNING - Skipping table panstarrs1.
2022-12-22 08:21:50,050 - INFO - [TIC_V8] Processing table tic_v8.
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] Table cross-matching parameters:
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] ra_column: ra
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] dec_column: dec
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] pmra_column: pmra
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] pmdec_column: pmdec
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] is_pmra_cos: true
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] parallax_column: plx
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] epoch: 2000.0
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] epoch_column: none
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] epoch_format: jyear
2022-12-22 08:21:50,050 - DEBUG - [TIC_V8] has_duplicates: false
2022-12-22 08:21:50,051 - DEBUG - [TIC_V8] skip: false
2022-12-22 08:21:50,051 - DEBUG - [TIC_V8] skip_phases: []
2022-12-22 08:21:50,051 - DEBUG - [TIC_V8] query_radius: 1.0
2022-12-22 08:21:50,051 - DEBUG - [TIC_V8] row_count: 1,727,995,000
2022-12-22 08:21:50,051 - DEBUG - [TIC_V8] resolution: nan
2022-12-22 08:21:50,051 - DEBUG - [TIC_V8] join_weight: 1
2022-12-22 08:21:50,057 - INFO - [TIC_V8] Phase 1: linking existing targets.
2022-12-22 08:21:50,058 - DEBUG - [TIC_V8] Found 3 paths between tic_v8 and temporary output table.
2022-12-22 08:21:50,059 - DEBUG - [TIC_V8] SET LOCAL work_mem='10GB';
2022-12-22 08:21:50,059 - DEBUG - [TIC_V8] SET LOCAL temp_buffers='5GB';
2022-12-22 08:21:50,059 - DEBUG - [TIC_V8] SET LOCAL enable_hashjoin=False;
2022-12-22 08:21:50,060 - DEBUG - [TIC_V8] Selecting linked targets into temporary table 'f50a3b22' with join path ['tic_v8', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."id", "t2"."catalogid") "t1"."id" AS "target_id", "t2"."catalogid", (first_value("t1"."id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."id" ASC) = "t1"."id") AS "best" FROM "catalogdb"."tic_v8" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_int" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."id") OR ("t4"."catalogid" = "t2"."catalogid")))))
2022-12-22 11:40:20,379 - DEBUG - [TIC_V8] Copying data into relational model 'catalog_to_tic_v8'.
2022-12-22 18:05:46,959 - DEBUG - [TIC_V8] Linked 1,693,027,487 records in 35036.900 s.
2022-12-22 18:05:46,969 - DEBUG - [TIC_V8] Running ANALYZE on catalog_to_tic_v8.
2022-12-22 19:38:22,370 - DEBUG - [TIC_V8] SET LOCAL work_mem='10GB';
2022-12-22 19:38:22,371 - DEBUG - [TIC_V8] SET LOCAL temp_buffers='5GB';
2022-12-22 19:38:22,371 - DEBUG - [TIC_V8] SET LOCAL enable_hashjoin=False;
2022-12-22 19:38:22,372 - DEBUG - [TIC_V8] Selecting linked targets into temporary table 'e4a6c261' with join path ['tic_v8', 'sdss_dr13_photoobj_primary', 'gaia_edr3_sdssdr13_best_neighbour', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."id", "t2"."catalogid") "t1"."id" AS "target_id", "t2"."catalogid", (first_value("t1"."id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."id" ASC) = "t1"."id") AS "best" FROM "catalogdb"."tic_v8" AS "t1" INNER JOIN "catalogdb"."sdss_dr13_photoobj_primary" AS "t3" ON ("t3"."objid" = "t1"."sdss") INNER JOIN "catalogdb"."gaia_edr3_sdssdr13_best_neighbour" AS "t4" ON ("t3"."objid" = "t4"."original_ext_source_id") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t5" ON ("t4"."source_id" = "t5"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t5"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8" AS "t6" WHERE (("t6"."version_id" = 31) AND (("t6"."target_id" = "t1"."id") OR ("t6"."catalogid" = "t2"."catalogid")))))
2022-12-23 17:32:35,432 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-23 17:32:35,432 - INFO - Reference Epoch = 2016.0
2022-12-23 17:32:36,072 - INFO - Query radius = 1.0
2022-12-23 17:32:36,073 - DEBUG - Current database configuration parameters.
2022-12-23 17:32:36,073 - DEBUG - shared_buffers = 76GB
2022-12-23 17:32:36,073 - DEBUG - effective_cache_size = 176GB
2022-12-23 17:32:36,073 - DEBUG - wal_buffers = 16MB
2022-12-23 17:32:36,073 - DEBUG - effective_io_concurrency = 200
2022-12-23 17:32:36,073 - DEBUG - work_mem = 5GB
2022-12-23 17:32:36,073 - DEBUG - max_worker_processes = 32
2022-12-23 17:32:36,073 - DEBUG - random_page_cost = 1
2022-12-23 17:32:36,074 - DEBUG - seq_page_cost = 0.5
2022-12-23 17:32:36,074 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-23 17:32:36,074 - DEBUG - cpu_operator_cost = 0.0025
2022-12-23 17:32:36,074 - DEBUG - default_statistics_target = 3000
2022-12-23 17:32:36,074 - DEBUG - temp_buffers = 10GB
2022-12-23 17:32:36,074 - DEBUG - plan_cache_mode = auto
2022-12-23 17:32:36,074 - DEBUG - geqo_effort = 5
2022-12-23 17:32:36,074 - DEBUG - force_parallel_mode = off
2022-12-23 17:32:36,074 - DEBUG - enable_seqscan = on
2022-12-23 17:32:36,074 - DEBUG - enable_nestloop = on
2022-12-23 17:32:36,082 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-23 17:32:36,095 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-23 17:32:36,185 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-23 17:32:36,225 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-23 17:32:36,256 - WARNING - Skipping table gaia_dr3_source.
2022-12-23 17:32:36,257 - WARNING - Skipping table gaia_dr2_source.
2022-12-23 17:32:36,257 - WARNING - Skipping table legacy_survey_dr10.
2022-12-23 17:32:36,257 - WARNING - Skipping table legacy_survey_dr8.
2022-12-23 17:32:36,257 - WARNING - Skipping table panstarrs1.
2022-12-23 17:32:36,257 - INFO - [TIC_V8] Processing table tic_v8.
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] Table cross-matching parameters:
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] ra_column: ra
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] dec_column: dec
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] pmra_column: pmra
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] pmdec_column: pmdec
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] is_pmra_cos: true
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] parallax_column: plx
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] epoch: 2000.0
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] epoch_column: none
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] epoch_format: jyear
2022-12-23 17:32:36,257 - DEBUG - [TIC_V8] has_duplicates: false
2022-12-23 17:32:36,258 - DEBUG - [TIC_V8] skip: false
2022-12-23 17:32:36,258 - DEBUG - [TIC_V8] skip_phases: []
2022-12-23 17:32:36,258 - DEBUG - [TIC_V8] query_radius: 1.0
2022-12-23 17:32:36,258 - DEBUG - [TIC_V8] row_count: 1,727,995,000
2022-12-23 17:32:36,258 - DEBUG - [TIC_V8] resolution: nan
2022-12-23 17:32:36,258 - DEBUG - [TIC_V8] join_weight: 1
2022-12-23 17:32:36,265 - INFO - [TIC_V8] Phase 1: linking existing targets.
2022-12-23 17:32:36,265 - DEBUG - [TIC_V8] Found 3 paths between tic_v8 and temporary output table.
2022-12-23 17:32:36,267 - DEBUG - [TIC_V8] SET LOCAL work_mem='10GB';
2022-12-23 17:32:36,267 - DEBUG - [TIC_V8] SET LOCAL temp_buffers='5GB';
2022-12-23 17:32:36,267 - DEBUG - [TIC_V8] SET LOCAL enable_hashjoin=False;
2022-12-23 17:32:36,269 - DEBUG - [TIC_V8] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['tic_v8', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."id", "t2"."catalogid") "t1"."id" AS "target_id", "t2"."catalogid", (first_value("t1"."id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."id" ASC) = "t1"."id") AS "best" FROM "catalogdb"."tic_v8" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_source" AS "t3" ON ("t1"."gaia_int" = "t3"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t3"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."id") OR ("t4"."catalogid" = "t2"."catalogid")))))
2022-12-23 20:40:55,296 - DEBUG - [TIC_V8] Copying data into relational model 'catalog_to_tic_v8'.
2022-12-24 01:36:49,963 - DEBUG - [TIC_V8] Linked 1,693,027,487 records in 29053.697 s.
2022-12-24 01:36:50,003 - DEBUG - [TIC_V8] Running ANALYZE on catalog_to_tic_v8.
2022-12-24 02:18:58,403 - DEBUG - [TIC_V8] SET LOCAL work_mem='10GB';
2022-12-24 02:18:58,479 - DEBUG - [TIC_V8] SET LOCAL temp_buffers='5GB';
2022-12-24 02:18:58,479 - DEBUG - [TIC_V8] SET LOCAL enable_hashjoin=False;
2022-12-24 02:18:58,482 - DEBUG - [TIC_V8] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['tic_v8', 'sdss_dr13_photoobj_primary', 'gaia_edr3_sdssdr13_best_neighbour', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."id", "t2"."catalogid") "t1"."id" AS "target_id", "t2"."catalogid", (first_value("t1"."id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."id" ASC) = "t1"."id") AS "best" FROM "catalogdb"."tic_v8" AS "t1" INNER JOIN "catalogdb"."sdss_dr13_photoobj_primary" AS "t3" ON ("t3"."objid" = "t1"."sdss") INNER JOIN "catalogdb"."gaia_edr3_sdssdr13_best_neighbour" AS "t4" ON ("t3"."objid" = "t4"."original_ext_source_id") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t5" ON ("t4"."source_id" = "t5"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t5"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8" AS "t6" WHERE (("t6"."version_id" = 31) AND (("t6"."target_id" = "t1"."id") OR ("t6"."catalogid" = "t2"."catalogid")))))
2022-12-24 02:48:35,024 - DEBUG - [TIC_V8] Copying data into relational model 'catalog_to_tic_v8'.
2022-12-25 12:38:39,113 - DEBUG - [TIC_V8] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['tic_v8', 'sdss_dr13_photoobj_primary', 'gaia_edr3_sdssdr13_best_neighbour', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."id", "t2"."catalogid") "t1"."id" AS "target_id", "t2"."catalogid", (first_value("t1"."id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."id" ASC) = "t1"."id") AS "best" FROM "catalogdb"."tic_v8" AS "t1" INNER JOIN "catalogdb"."sdss_dr13_photoobj_primary" AS "t3" ON ("t3"."objid" = "t1"."sdss") INNER JOIN "catalogdb"."gaia_edr3_sdssdr13_best_neighbour" AS "t4" ON ("t3"."objid" = "t4"."original_ext_source_id") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t5" ON ("t4"."source_id" = "t5"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t5"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8" AS "t6" WHERE (("t6"."version_id" = 31) AND (("t6"."target_id" = "t1"."id") OR ("t6"."catalogid" = "t2"."catalogid")))))
2022-12-25 12:38:39,113 - POST_PROCESS_NOTE - [TIC_V8] Both of these attempts to link tic_v8 through sdss_dr13 table failed and the path was eliminated because it was problematic and linked a negligible number of targets
2022-12-26 01:08:00,000 - POST_PROCESS_NOTE - [TIC_V8] The following path was processed in a external sql files called phase1_query6.sql and phase1_query7.sql so this notes where added after the crossmatch was done
2022-12-26 01:08:00,000 - POST_PROCESS_NOTE - [TIC_V8] However since the tic_v8->sdss_dr13 path was removed the ingestion could be reproduced exactly using the current crossmatch code
2022-12-26 01:08:00,000 - POST_PROCESS_NOTE - [TIC_V8] SETTING DATABASE OPTIONS IN PHASE1_QUERY6.PY EXTERNAL SCRIPT: SET LOCAL work_mem='10GB';
2022-12-26 01:08:00,000 - POST_PROCESS_NOTE - [TIC_V8] SETTING DATABASE OPTIONS IN PHASE1_QUERY6.PY EXTERNAL SCRIPT: SET LOCAL temp_buffers='5GB';
2022-12-26 01:08:00,000 - POST_PROCESS_NOTE - [TIC_V8] SETTING DATABASE OPTIONS IN PHASE1_QUERY6.PY EXTERNAL SCRIPT: SET LOCAL enable_hashjoin=False;
2022-12-26 01:08:00,000 - POST_PROCESS_NOTE - [TIC_V8] Deleting table catalogdb.phase1_content IN PHASE1_QUERY6.PY EXTERNAL SCRIPT: DROP TABLE IF EXISTS catalogdb.phase1_content;
2022-12-26 01:08:00,000 - POST_PROCESS_NOTE - [TIC_V8] Selecting linked targets into table catalogdb.phase1_content IN PHASE1_QUERY6.SQL EXTERNAL SCRIPT with join path ['tic_v8', 'twomass_psc', 'gaia_edr3_tmass_psc_xsc_best_neighbour2', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: CREATE TABLE catalogdb.phase1_content AS (SELECT DISTINCT ON ("t1"."id", "t2"."catalogid") "t1"."id" AS "target_id", "t2"."catalogid", (first_value("t1"."id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."id" ASC) = "t1"."id") AS "best" FROM "catalogdb"."tic_v8" AS "t1" INNER JOIN "catalogdb"."twomass_psc" AS "t3" ON ("t1"."twomass_psc" = "t3"."designation") INNER JOIN "catalogdb"."gaia_edr3_tmass_psc_xsc_best_neighbour2" AS "t4" ON ("t4"."original_ext_source_id" = "t3"."designation") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t5" ON ("t4"."source_id" = "t5"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t5"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8" AS "t6" WHERE (("t6"."version_id" = 31) AND (("t6"."target_id" = "t1"."id") OR ("t6"."catalogid" = "t2"."catalogid"))))));
2022-12-26 06:58:42,350 - POST_PROCESS_NOTE - [TIC_V8] SETTING DATABASE OPTIONS IN PHASE1_QUERY7.PY EXTERNAL SCRIPT: SET LOCAL work_mem='10GB';
2022-12-26 06:58:42,350 - POST_PROCESS_NOTE - [TIC_V8] SETTING DATABASE OPTIONS IN PHASE1_QUERY7.PY EXTERNAL SCRIPT: SET LOCAL temp_buffers='5GB';
2022-12-26 06:58:42,350 - POST_PROCESS_NOTE - [TIC_V8] SETTING DATABASE OPTIONS IN PHASE1_QUERY7.PY EXTERNAL SCRIPT: SET LOCAL enable_hashjoin=False;
2022-12-26 06:58:42,350 - POST_PROCESS_NOTE - [TIC_V8] Copying data into relational model 'catalog_to_tic_v8' IN PHASE1_QUERY7.PY EXTERNAL SCRIPT.
2022-12-26 07:39:44.593 - POST_PROCESS_NOTE - [TIC_V8] Linked 4,665,740 records in approximately 23490.000 s.
2022-12-26 08:08:00,000 - POST_PROCESS_NOTE - [TIC_V8] Running ANALYZE on catalog_to_tic_v8 IN PSQL terminal.
2022-12-26 13:04:30,421 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-26 13:04:30,421 - INFO - Reference Epoch = 2016.0
2022-12-26 13:04:31,056 - INFO - Query radius = 1.0
2022-12-26 13:04:31,057 - DEBUG - Current database configuration parameters.
2022-12-26 13:04:31,057 - DEBUG - shared_buffers = 76GB
2022-12-26 13:04:31,057 - DEBUG - effective_cache_size = 176GB
2022-12-26 13:04:31,057 - DEBUG - wal_buffers = 16MB
2022-12-26 13:04:31,057 - DEBUG - effective_io_concurrency = 200
2022-12-26 13:04:31,057 - DEBUG - work_mem = 5GB
2022-12-26 13:04:31,057 - DEBUG - max_worker_processes = 32
2022-12-26 13:04:31,057 - DEBUG - random_page_cost = 1
2022-12-26 13:04:31,058 - DEBUG - seq_page_cost = 0.5
2022-12-26 13:04:31,058 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-26 13:04:31,058 - DEBUG - cpu_operator_cost = 0.0025
2022-12-26 13:04:31,058 - DEBUG - default_statistics_target = 3000
2022-12-26 13:04:31,058 - DEBUG - temp_buffers = 10GB
2022-12-26 13:04:31,058 - DEBUG - plan_cache_mode = auto
2022-12-26 13:04:31,058 - DEBUG - geqo_effort = 5
2022-12-26 13:04:31,058 - DEBUG - force_parallel_mode = off
2022-12-26 13:04:31,058 - DEBUG - enable_seqscan = on
2022-12-26 13:04:31,058 - DEBUG - enable_nestloop = on
2022-12-26 13:04:31,066 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-26 13:04:31,079 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-26 13:04:31,175 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-26 13:04:31,311 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-26 13:04:31,357 - WARNING - Skipping table gaia_dr3_source.
2022-12-26 13:04:31,357 - WARNING - Skipping table gaia_dr2_source.
2022-12-26 13:04:31,357 - WARNING - Skipping table legacy_survey_dr10.
2022-12-26 13:04:31,357 - WARNING - Skipping table legacy_survey_dr8.
2022-12-26 13:04:31,358 - WARNING - Skipping table panstarrs1.
2022-12-26 13:04:31,358 - INFO - [TIC_V8] Processing table tic_v8.
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] Table cross-matching parameters:
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] ra_column: ra
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] dec_column: dec
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] pmra_column: pmra
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] pmdec_column: pmdec
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] is_pmra_cos: true
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] parallax_column: plx
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] epoch: 2000.0
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] epoch_column: none
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] epoch_format: jyear
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] has_duplicates: false
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] skip: false
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] skip_phases: []
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] query_radius: 1.0
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] row_count: 1,727,995,000
2022-12-26 13:04:31,358 - DEBUG - [TIC_V8] resolution: nan
2022-12-26 13:04:31,359 - DEBUG - [TIC_V8] join_weight: 1
2022-12-26 13:04:31,359 - INFO - [TIC_V8] Setting phase run 1
2022-12-26 13:04:31,359 - INFO - [TIC_V8] Phase 2: cross-matching against existing targets.
2022-12-26 13:04:31,366 - DEBUG - [TIC_V8] Determining maximum epoch delta between catalogues.
2022-12-26 13:04:31,366 - DEBUG - [TIC_V8] Maximum epoch delta: 16.100 (+ 0.1 year).
2022-12-26 13:04:31,366 - DEBUG - [TIC_V8] Cross-matching model against temporary table.
2022-12-26 13:04:31,367 - DEBUG - [TIC_V8] SET LOCAL work_mem='10GB';
2022-12-26 13:04:31,367 - DEBUG - [TIC_V8] SET LOCAL temp_buffers='5GB';
2022-12-26 13:04:31,367 - DEBUG - [TIC_V8] SET LOCAL enable_hashjoin=False;
2022-12-26 13:04:31,368 - DEBUG - [TIC_V8] Inserting cross-matched data into relational model 'catalog_to_tic_v8' in PSQL: : INSERT INTO "catalogdb"."catalog_to_tic_v8" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."id" AS "target_id", q3c_dist_pm("t2"."ra", "t2"."dec", "t2"."pmra", "t2"."pmdec", 1, 2000.0, "t1"."ra", "t1"."dec", 2016.0) AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."tic_v8" AS "t2" WHERE (q3c_join_pm("t2"."ra", "t2"."dec", "t2"."pmra", "t2"."pmdec", 1, 2000.0, "t1"."ra", "t1"."dec", 2016.0, 16.1, 0.0002777777777777778) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8" AS "catalog_to_tic_v8" WHERE (("catalog_to_tic_v8"."version_id" = 31) AND (("catalog_to_tic_v8"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_tic_v8"."target_id" = "xmatched"."target_id"))))
2022-12-27 11:07:57,263 - DEBUG - [TIC_V8] Cross-matched catalog_47cd76e43f74bbc2 with 7,901,981 targets in tic_v8. Run in 79405.890 s.
2022-12-27 11:07:57,352 - DEBUG - [TIC_V8] Running ANALYZE on catalog_to_tic_v8.
2022-12-27 12:28:34,474 - INFO - [TIC_V8] Phase 3: adding non cross-matched targets.
2022-12-27 12:28:34,482 - DEBUG - [TIC_V8] SET LOCAL work_mem='10GB';
2022-12-27 12:28:34,483 - DEBUG - [TIC_V8] SET LOCAL temp_buffers='5GB';
2022-12-27 12:28:34,483 - DEBUG - [TIC_V8] SET LOCAL enable_hashjoin=False;
2022-12-27 12:28:34,485 - DEBUG - [TIC_V8] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050400605911582) AS "catalogid", "t1"."id" AS "target_id", CASE WHEN ("t1"."posflag" = 'gaia2') THEN ("t1"."ra_orig" + ((((coalesce("t1"."pmra", 0) / 1000.0) / 3600.0) / cos(radians(coalesce("t1"."dec_orig", 0)))) * coalesce(0.5, 0))) ELSE ("t1"."ra" + ((((coalesce("t1"."pmra", 0) / 1000.0) / 3600.0) / cos(radians(coalesce("t1"."dec", 0)))) * coalesce(16.0, 0))) END AS "ra", CASE WHEN ("t1"."posflag" = 'gaia2') THEN ("t1"."dec_orig" + (((coalesce("t1"."pmdec", 0) / 1000.0) / 3600.0) * coalesce(0.5, 0))) ELSE ("t1"."dec" + (((coalesce("t1"."pmdec", 0) / 1000.0) / 3600.0) * coalesce(16.0, 0))) END AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."plx" AS "parallax" FROM "catalogdb"."tic_v8" AS "t1" WHERE ((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."id")))) AND ("t1"."objtype" != 'EXTENDED'))
2022-12-27 13:21:16,306 - DEBUG - [TIC_V8] Copying data into relational model 'catalog_to_tic_v8': INSERT INTO "catalogdb"."catalog_to_tic_v8" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2022-12-27 13:34:06,833 - DEBUG - [TIC_V8] Insertion into catalog_to_tic_v8 completed with 21,519,096 rows in 3932.351 s.
2022-12-27 13:34:06,834 - DEBUG - [TIC_V8] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec", "pmra", "pmdec", "parallax") SELECT "t1"."catalogid", 'tic_v8', 31, "t1"."ra", "t1"."dec", "t1"."pmra", "t1"."pmdec", "t1"."parallax" FROM "phase3_content" AS "t1"
2022-12-27 14:16:56,376 - DEBUG - [TIC_V8] Inserted 21,519,096 rows. Total time: 6501.893 s.
2022-12-27 14:16:56,376 - DEBUG - [TIC_V8] Running ANALYZE on catalog_to_tic_v8.
2022-12-27 14:32:40,085 - INFO - [TIC_V8] Fully processed tic_v8 in 91689 s.
2022-12-27 14:32:40,096 - INFO - [TIC_V8_EXTENDED] Processing table tic_v8_extended.
2022-12-27 14:32:40,096 - DEBUG - [TIC_V8_EXTENDED] Table cross-matching parameters:
2022-12-27 14:32:40,096 - DEBUG - [TIC_V8_EXTENDED] ra_column: ra
2022-12-27 14:32:40,096 - DEBUG - [TIC_V8_EXTENDED] dec_column: dec
2022-12-27 14:32:40,096 - DEBUG - [TIC_V8_EXTENDED] pmra_column: pmra
2022-12-27 14:32:40,096 - DEBUG - [TIC_V8_EXTENDED] pmdec_column: pmdec
2022-12-27 14:32:40,096 - DEBUG - [TIC_V8_EXTENDED] is_pmra_cos: true
2022-12-27 14:32:40,096 - DEBUG - [TIC_V8_EXTENDED] parallax_column: plx
2022-12-27 14:32:40,096 - DEBUG - [TIC_V8_EXTENDED] epoch: 2000.0
2022-12-27 14:32:40,096 - DEBUG - [TIC_V8_EXTENDED] epoch_column: none
2022-12-27 14:32:40,096 - DEBUG - [TIC_V8_EXTENDED] epoch_format: jyear
2022-12-27 14:32:40,097 - DEBUG - [TIC_V8_EXTENDED] has_duplicates: false
2022-12-27 14:32:40,097 - DEBUG - [TIC_V8_EXTENDED] skip: false
2022-12-27 14:32:40,097 - DEBUG - [TIC_V8_EXTENDED] skip_phases: []
2022-12-27 14:32:40,097 - DEBUG - [TIC_V8_EXTENDED] query_radius: 1.0
2022-12-27 14:32:40,097 - DEBUG - [TIC_V8_EXTENDED] row_count: 1,647,556
2022-12-27 14:32:40,097 - DEBUG - [TIC_V8_EXTENDED] resolution: nan
2022-12-27 14:32:40,097 - DEBUG - [TIC_V8_EXTENDED] join_weight: 1
2022-12-27 14:32:40,104 - INFO - [TIC_V8_EXTENDED] Phase 1: linking existing targets.
2022-12-27 14:32:40,105 - DEBUG - [TIC_V8_EXTENDED] Found 2 paths between tic_v8_extended and temporary output table.
2022-12-27 14:32:40,105 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL work_mem='10GB';
2022-12-27 14:32:40,106 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL temp_buffers='5GB';
2022-12-27 14:32:40,106 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL enable_hashjoin=False;
2022-12-27 14:32:40,108 - DEBUG - [TIC_V8_EXTENDED] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['tic_v8_extended', 'sdss_dr13_photoobj_primary', 'gaia_edr3_sdssdr13_best_neighbour', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."id", "t2"."catalogid") "t1"."id" AS "target_id", "t2"."catalogid", (first_value("t1"."id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."id" ASC) = "t1"."id") AS "best" FROM "catalogdb"."tic_v8_extended" AS "t1" INNER JOIN "catalogdb"."sdss_dr13_photoobj_primary" AS "t3" ON ("t3"."objid" = "t1"."sdss") INNER JOIN "catalogdb"."gaia_edr3_sdssdr13_best_neighbour" AS "t4" ON ("t3"."objid" = "t4"."original_ext_source_id") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t5" ON ("t4"."source_id" = "t5"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t5"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8_extended" AS "t6" WHERE (("t6"."version_id" = 31) AND (("t6"."target_id" = "t1"."id") OR ("t6"."catalogid" = "t2"."catalogid")))))
2022-12-27 15:22:33,593 - DEBUG - [TIC_V8_EXTENDED] Copying data into relational model 'catalog_to_tic_v8_extended'.
2022-12-27 15:22:37,860 - DEBUG - [TIC_V8_EXTENDED] Linked 550,325 records in 2997.755 s.
2022-12-27 15:22:37,861 - DEBUG - [TIC_V8_EXTENDED] Running ANALYZE on catalog_to_tic_v8_extended.
2022-12-27 15:22:50,157 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL work_mem='10GB';
2022-12-27 15:22:50,158 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL temp_buffers='5GB';
2022-12-27 15:22:50,158 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL enable_hashjoin=False;
2022-12-27 15:22:50,160 - DEBUG - [TIC_V8_EXTENDED] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['tic_v8_extended', 'allwise', 'gaia_edr3_allwise_best_neighbour', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."id", "t2"."catalogid") "t1"."id" AS "target_id", "t2"."catalogid", (first_value("t1"."id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."id" ASC) = "t1"."id") AS "best" FROM "catalogdb"."tic_v8_extended" AS "t1" INNER JOIN "catalogdb"."allwise" AS "t3" ON ("t1"."allwise" = "t3"."designation") INNER JOIN "catalogdb"."gaia_edr3_allwise_best_neighbour" AS "t4" ON ("t4"."original_ext_source_id" = "t3"."designation") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t5" ON ("t4"."source_id" = "t5"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t5"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8_extended" AS "t6" WHERE (("t6"."version_id" = 31) AND (("t6"."target_id" = "t1"."id") OR ("t6"."catalogid" = "t2"."catalogid")))))
2022-12-27 16:12:12,158 - DEBUG - [TIC_V8_EXTENDED] Copying data into relational model 'catalog_to_tic_v8_extended'.
2022-12-27 16:12:14,021 - DEBUG - [TIC_V8_EXTENDED] Linked 185,780 records in 2963.864 s.
2022-12-27 16:12:14,022 - DEBUG - [TIC_V8_EXTENDED] Running ANALYZE on catalog_to_tic_v8_extended.
2022-12-27 16:12:17,195 - INFO - [TIC_V8_EXTENDED] Phase 2: cross-matching against existing targets.
2022-12-27 16:12:17,202 - DEBUG - [TIC_V8_EXTENDED] Determining maximum epoch delta between catalogues.
2022-12-27 16:12:17,205 - DEBUG - [TIC_V8_EXTENDED] Maximum epoch delta: 16.100 (+ 0.1 year).
2022-12-27 16:12:17,205 - DEBUG - [TIC_V8_EXTENDED] Cross-matching model against temporary table.
2022-12-27 16:12:17,206 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL work_mem='10GB';
2022-12-27 16:12:17,206 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL temp_buffers='5GB';
2022-12-27 16:12:17,206 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL enable_hashjoin=False;
2022-12-27 16:12:17,208 - DEBUG - [TIC_V8_EXTENDED] Inserting cross-matched data into relational model 'catalog_to_tic_v8_extended' in PSQL: : INSERT INTO "catalogdb"."catalog_to_tic_v8_extended" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."id" AS "target_id", q3c_dist_pm("t2"."ra", "t2"."dec", "t2"."pmra", "t2"."pmdec", 1, 2000.0, "t1"."ra", "t1"."dec", 2016.0) AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."tic_v8_extended" AS "t2" WHERE (q3c_join_pm("t2"."ra", "t2"."dec", "t2"."pmra", "t2"."pmdec", 1, 2000.0, "t1"."ra", "t1"."dec", 2016.0, 16.1, 0.0002777777777777778) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8_extended" AS "catalog_to_tic_v8_extended" WHERE (("catalog_to_tic_v8_extended"."version_id" = 31) AND (("catalog_to_tic_v8_extended"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_tic_v8_extended"."target_id" = "xmatched"."target_id"))))
2022-12-27 17:09:53,103 - DEBUG - [TIC_V8_EXTENDED] Cross-matched catalog_47cd76e43f74bbc2 with 1,002,395 targets in tic_v8_extended. Run in 3455.897 s.
2022-12-27 17:09:53,103 - DEBUG - [TIC_V8_EXTENDED] Running ANALYZE on catalog_to_tic_v8_extended.
2022-12-27 17:09:57,124 - INFO - [TIC_V8_EXTENDED] Phase 3: adding non cross-matched targets.
2022-12-27 17:09:57,132 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL work_mem='10GB';
2022-12-27 17:09:57,132 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL temp_buffers='5GB';
2022-12-27 17:09:57,132 - DEBUG - [TIC_V8_EXTENDED] SET LOCAL enable_hashjoin=False;
2022-12-27 17:09:57,134 - DEBUG - [TIC_V8_EXTENDED] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050400627430678) AS "catalogid", "t1"."id" AS "target_id", ("t1"."ra" + ((((coalesce("t1"."pmra", 0) / 1000.0) / 3600.0) / cos(radians(coalesce("t1"."dec", 0)))) * coalesce(16.0, 0))) AS "ra", ("t1"."dec" + (((coalesce("t1"."pmdec", 0) / 1000.0) / 3600.0) * coalesce(16.0, 0))) AS "dec", "t1"."pmra" AS "pmra", "t1"."pmdec" AS "pmdec", "t1"."plx" AS "parallax" FROM "catalogdb"."tic_v8_extended" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tic_v8_extended" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."id"))))
2022-12-27 17:09:58,516 - DEBUG - [TIC_V8_EXTENDED] Copying data into relational model 'catalog_to_tic_v8_extended': INSERT INTO "catalogdb"."catalog_to_tic_v8_extended" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2022-12-27 17:09:58,739 - DEBUG - [TIC_V8_EXTENDED] Insertion into catalog_to_tic_v8_extended completed with 24,939 rows in 1.607 s.
2022-12-27 17:09:58,740 - DEBUG - [TIC_V8_EXTENDED] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec", "pmra", "pmdec", "parallax") SELECT "t1"."catalogid", 'tic_v8_extended', 31, "t1"."ra", "t1"."dec", "t1"."pmra", "t1"."pmdec", "t1"."parallax" FROM "phase3_content" AS "t1"
2022-12-27 17:09:59,734 - DEBUG - [TIC_V8_EXTENDED] Inserted 24,939 rows. Total time: 2.603 s.
2022-12-27 17:09:59,735 - DEBUG - [TIC_V8_EXTENDED] Running ANALYZE on catalog_to_tic_v8_extended.
2022-12-27 17:10:03,710 - INFO - [TIC_V8_EXTENDED] Fully processed tic_v8_extended in 9444 s.
2022-12-27 17:10:03,719 - INFO - [SDSS_DR13_PHOTOOBJ_PRIMARY] Processing table sdss_dr13_photoobj_primary.
2022-12-27 17:10:03,719 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Table cross-matching parameters:
2022-12-27 17:10:03,719 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] ra_column: ra
2022-12-27 17:10:03,719 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] dec_column: dec
2022-12-27 17:10:03,719 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] pmra_column: none
2022-12-27 17:10:03,719 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] pmdec_column: none
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] is_pmra_cos: true
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] parallax_column: none
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] epoch: none
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] epoch_column: none
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] epoch_format: jyear
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] has_duplicates: false
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] skip: false
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] skip_phases: []
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] query_radius: 1.0
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] row_count: 469,050,900
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] resolution: nan
2022-12-27 17:10:03,720 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] join_weight: 1
2022-12-27 17:10:03,727 - INFO - [SDSS_DR13_PHOTOOBJ_PRIMARY] Phase 1: linking existing targets.
2022-12-27 17:10:03,728 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Found 3 paths between sdss_dr13_photoobj_primary and temporary output table.
2022-12-27 17:10:03,728 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL work_mem='10GB';
2022-12-27 17:10:03,729 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL temp_buffers='5GB';
2022-12-27 17:10:03,729 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL enable_hashjoin=False;
2022-12-27 17:10:03,731 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['sdss_dr13_photoobj_primary', 'gaia_edr3_sdssdr13_best_neighbour', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."objid", "t2"."catalogid") "t1"."objid" AS "target_id", "t2"."catalogid", (first_value("t1"."objid") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."objid" ASC) = "t1"."objid") AS "best" FROM "catalogdb"."sdss_dr13_photoobj_primary" AS "t1" INNER JOIN "catalogdb"."gaia_edr3_sdssdr13_best_neighbour" AS "t3" ON ("t1"."objid" = "t3"."original_ext_source_id") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t4" ON ("t3"."source_id" = "t4"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t4"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_sdss_dr13_photoobj_primary" AS "t5" WHERE (("t5"."version_id" = 31) AND (("t5"."target_id" = "t1"."objid") OR ("t5"."catalogid" = "t2"."catalogid")))))
2022-12-27 17:34:49,363 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Copying data into relational model 'catalog_to_sdss_dr13_photoobj_primary'.
2022-12-27 17:55:39,118 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Linked 128,130,925 records in 2735.390 s.
2022-12-27 17:55:39,119 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Running ANALYZE on catalog_to_sdss_dr13_photoobj_primary.
2022-12-27 18:08:53,774 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL work_mem='10GB';
2022-12-27 18:08:53,775 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL temp_buffers='5GB';
2022-12-27 18:08:53,775 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL enable_hashjoin=False;
2022-12-27 18:08:53,777 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['sdss_dr13_photoobj_primary', 'tic_v8', 'catalog_to_tic_v8']: SELECT DISTINCT ON ("t1"."objid", "t2"."catalogid") "t1"."objid" AS "target_id", "t2"."catalogid", (first_value("t1"."objid") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."objid" ASC) = "t1"."objid") AS "best" FROM "catalogdb"."sdss_dr13_photoobj_primary" AS "t1" INNER JOIN "catalogdb"."tic_v8" AS "t3" ON ("t1"."objid" = "t3"."sdss") INNER JOIN "catalogdb"."catalog_to_tic_v8" AS "t2" ON ("t2"."target_id" = "t3"."id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_sdss_dr13_photoobj_primary" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."objid") OR ("t4"."catalogid" = "t2"."catalogid")))))
2022-12-27 18:55:24,505 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Copying data into relational model 'catalog_to_sdss_dr13_photoobj_primary'.
2022-12-27 18:55:57,455 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Linked 332,665 records in 2823.681 s.
2022-12-27 18:55:57,456 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Running ANALYZE on catalog_to_sdss_dr13_photoobj_primary.
2022-12-27 19:00:44,182 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL work_mem='10GB';
2022-12-27 19:00:44,183 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL temp_buffers='5GB';
2022-12-27 19:00:44,183 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL enable_hashjoin=False;
2022-12-27 19:00:44,185 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['sdss_dr13_photoobj_primary', 'tic_v8_extended', 'catalog_to_tic_v8_extended']: SELECT DISTINCT ON ("t1"."objid", "t2"."catalogid") "t1"."objid" AS "target_id", "t2"."catalogid", (first_value("t1"."objid") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."objid" ASC) = "t1"."objid") AS "best" FROM "catalogdb"."sdss_dr13_photoobj_primary" AS "t1" INNER JOIN "catalogdb"."tic_v8_extended" AS "t3" ON ("t1"."objid" = "t3"."sdss") INNER JOIN "catalogdb"."catalog_to_tic_v8_extended" AS "t2" ON ("t2"."target_id" = "t3"."id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_sdss_dr13_photoobj_primary" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."objid") OR ("t4"."catalogid" = "t2"."catalogid")))))
2022-12-27 19:00:56,164 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Copying data into relational model 'catalog_to_sdss_dr13_photoobj_primary'.
2022-12-27 19:01:00,177 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Linked 52,588 records in 15.995 s.
2022-12-27 19:01:00,177 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Running ANALYZE on catalog_to_sdss_dr13_photoobj_primary.
2022-12-27 19:02:40,945 - INFO - [SDSS_DR13_PHOTOOBJ_PRIMARY] Phase 2: cross-matching against existing targets.
2022-12-27 19:02:40,954 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Cross-matching model against temporary table.
2022-12-27 19:02:40,954 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL work_mem='10GB';
2022-12-27 19:02:40,954 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL temp_buffers='5GB';
2022-12-27 19:02:40,954 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL enable_hashjoin=False;
2022-12-27 19:02:40,955 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Inserting cross-matched data into relational model 'catalog_to_sdss_dr13_photoobj_primary' in PSQL: : INSERT INTO "catalogdb"."catalog_to_sdss_dr13_photoobj_primary" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."objid" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."sdss_dr13_photoobj_primary" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_sdss_dr13_photoobj_primary" AS "catalog_to_sdss_dr13_photoobj_primary" WHERE (("catalog_to_sdss_dr13_photoobj_primary"."version_id" = 31) AND (("catalog_to_sdss_dr13_photoobj_primary"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_sdss_dr13_photoobj_primary"."target_id" = "xmatched"."target_id"))))
2022-12-27 22:42:40,754 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Cross-matched catalog_47cd76e43f74bbc2 with 294,157,062 targets in sdss_dr13_photoobj_primary. Run in 13199.800 s.
2022-12-27 22:42:40,756 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Running ANALYZE on catalog_to_sdss_dr13_photoobj_primary.
2022-12-27 22:49:48,769 - INFO - [SDSS_DR13_PHOTOOBJ_PRIMARY] Phase 3: adding non cross-matched targets.
2022-12-27 22:49:48,804 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL work_mem='10GB';
2022-12-27 22:49:48,804 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL temp_buffers='5GB';
2022-12-27 22:49:48,804 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] SET LOCAL enable_hashjoin=False;
2022-12-27 22:49:48,805 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050400627455617) AS "catalogid", "t1"."objid" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec" FROM "catalogdb"."sdss_dr13_photoobj_primary" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_sdss_dr13_photoobj_primary" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."objid"))))
2022-12-27 23:02:44,552 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Copying data into relational model 'catalog_to_sdss_dr13_photoobj_primary': INSERT INTO "catalogdb"."catalog_to_sdss_dr13_photoobj_primary" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2022-12-27 23:21:15,508 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Insertion into catalog_to_sdss_dr13_photoobj_primary completed with 48,250,338 rows in 1886.705 s.
2022-12-27 23:21:15,538 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec") SELECT "t1"."catalogid", 'sdss_dr13_photoobj_primary', 31, "t1"."ra", "t1"."dec" FROM "phase3_content" AS "t1"
2022-12-27 23:50:00,341 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Inserted 48,250,338 rows. Total time: 3611.538 s.
2022-12-27 23:50:00,350 - DEBUG - [SDSS_DR13_PHOTOOBJ_PRIMARY] Running ANALYZE on catalog_to_sdss_dr13_photoobj_primary.
2022-12-27 23:58:39,287 - INFO - [SDSS_DR13_PHOTOOBJ_PRIMARY] Fully processed sdss_dr13_photoobj_primary in 24516 s.
2022-12-27 23:58:39,298 - INFO - [TWOMASS_PSC] Processing table twomass_psc.
2022-12-27 23:58:39,298 - DEBUG - [TWOMASS_PSC] Table cross-matching parameters:
2022-12-27 23:58:39,298 - DEBUG - [TWOMASS_PSC] ra_column: ra
2022-12-27 23:58:39,298 - DEBUG - [TWOMASS_PSC] dec_column: decl
2022-12-27 23:58:39,298 - DEBUG - [TWOMASS_PSC] pmra_column: none
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] pmdec_column: none
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] is_pmra_cos: true
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] parallax_column: none
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] epoch: none
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] epoch_column: none
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] epoch_format: jyear
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] has_duplicates: false
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] skip: false
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] skip_phases: []
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] query_radius: 1.0
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] row_count: 470,987,140
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] resolution: nan
2022-12-27 23:58:39,299 - DEBUG - [TWOMASS_PSC] join_weight: 1
2022-12-27 23:58:39,308 - INFO - [TWOMASS_PSC] Phase 1: linking existing targets.
2022-12-27 23:58:39,309 - DEBUG - [TWOMASS_PSC] Found 2 paths between twomass_psc and temporary output table.
2022-12-27 23:58:39,309 - DEBUG - [TWOMASS_PSC] SET LOCAL work_mem='10GB';
2022-12-27 23:58:39,309 - DEBUG - [TWOMASS_PSC] SET LOCAL temp_buffers='5GB';
2022-12-27 23:58:39,309 - DEBUG - [TWOMASS_PSC] SET LOCAL enable_hashjoin=False;
2022-12-27 23:58:39,311 - DEBUG - [TWOMASS_PSC] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['twomass_psc', 'gaia_edr3_tmass_psc_xsc_best_neighbour2', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."pts_key", "t2"."catalogid") "t1"."pts_key" AS "target_id", "t2"."catalogid", (first_value("t1"."pts_key") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."pts_key" ASC) = "t1"."pts_key") AS "best" FROM "catalogdb"."twomass_psc" AS "t1" INNER JOIN "catalogdb"."gaia_edr3_tmass_psc_xsc_best_neighbour2" AS "t3" ON ("t3"."original_ext_source_id" = "t1"."designation") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t4" ON ("t3"."source_id" = "t4"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t4"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_twomass_psc" AS "t5" WHERE (("t5"."version_id" = 31) AND (("t5"."target_id" = "t1"."pts_key") OR ("t5"."catalogid" = "t2"."catalogid")))))
2022-12-28 05:18:10,827 - DEBUG - [TWOMASS_PSC] Copying data into relational model 'catalog_to_twomass_psc'.
2022-12-28 14:38:08,225 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2022-12-28 14:38:08,225 - INFO - Reference Epoch = 2016.0
2022-12-28 14:38:08,852 - INFO - Query radius = 1.0
2022-12-28 14:38:08,853 - DEBUG - Current database configuration parameters.
2022-12-28 14:38:08,854 - DEBUG - shared_buffers = 76GB
2022-12-28 14:38:08,854 - DEBUG - effective_cache_size = 176GB
2022-12-28 14:38:08,854 - DEBUG - wal_buffers = 16MB
2022-12-28 14:38:08,854 - DEBUG - effective_io_concurrency = 200
2022-12-28 14:38:08,854 - DEBUG - work_mem = 5GB
2022-12-28 14:38:08,854 - DEBUG - max_worker_processes = 32
2022-12-28 14:38:08,854 - DEBUG - random_page_cost = 1
2022-12-28 14:38:08,854 - DEBUG - seq_page_cost = 0.5
2022-12-28 14:38:08,854 - DEBUG - cpu_index_tuple_cost = 0.005
2022-12-28 14:38:08,854 - DEBUG - cpu_operator_cost = 0.0025
2022-12-28 14:38:08,854 - DEBUG - default_statistics_target = 3000
2022-12-28 14:38:08,854 - DEBUG - temp_buffers = 10GB
2022-12-28 14:38:08,854 - DEBUG - plan_cache_mode = auto
2022-12-28 14:38:08,854 - DEBUG - geqo_effort = 5
2022-12-28 14:38:08,854 - DEBUG - force_parallel_mode = off
2022-12-28 14:38:08,854 - DEBUG - enable_seqscan = on
2022-12-28 14:38:08,854 - DEBUG - enable_nestloop = on
2022-12-28 14:38:08,863 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2022-12-28 14:38:08,875 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2022-12-28 14:38:08,991 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2022-12-28 14:38:09,032 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2022-12-28 14:38:09,051 - WARNING - Skipping table gaia_dr3_source.
2022-12-28 14:38:09,051 - WARNING - Skipping table gaia_dr2_source.
2022-12-28 14:38:09,051 - WARNING - Skipping table legacy_survey_dr10.
2022-12-28 14:38:09,051 - WARNING - Skipping table legacy_survey_dr8.
2022-12-28 14:38:09,051 - WARNING - Skipping table panstarrs1.
2022-12-28 14:38:09,051 - WARNING - Skipping table tic_v8.
2022-12-28 14:38:09,052 - WARNING - Skipping table tic_v8_extended.
2022-12-28 14:38:09,052 - WARNING - Skipping table sdss_dr13_photoobj_primary.
2022-12-28 14:38:09,052 - INFO - [TWOMASS_PSC] Processing table twomass_psc.
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] Table cross-matching parameters:
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] ra_column: ra
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] dec_column: decl
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] pmra_column: none
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] pmdec_column: none
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] is_pmra_cos: true
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] parallax_column: none
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] epoch: none
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] epoch_column: none
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] epoch_format: jyear
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] has_duplicates: false
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] skip: false
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] skip_phases: []
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] query_radius: 1.0
2022-12-28 14:38:09,052 - DEBUG - [TWOMASS_PSC] row_count: 470,987,140
2022-12-28 14:38:09,053 - DEBUG - [TWOMASS_PSC] resolution: nan
2022-12-28 14:38:09,053 - DEBUG - [TWOMASS_PSC] join_weight: 1
2022-12-28 14:38:09,059 - INFO - [TWOMASS_PSC] Phase 1: linking existing targets.
2022-12-28 14:38:09,060 - DEBUG - [TWOMASS_PSC] Found 2 paths between twomass_psc and temporary output table.
2022-12-28 14:38:09,060 - DEBUG - [TWOMASS_PSC] SET LOCAL work_mem='10GB';
2022-12-28 14:38:09,060 - DEBUG - [TWOMASS_PSC] SET LOCAL temp_buffers='5GB';
2022-12-28 14:38:09,060 - DEBUG - [TWOMASS_PSC] SET LOCAL enable_hashjoin=False;
2022-12-28 14:38:09,062 - DEBUG - [TWOMASS_PSC] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['twomass_psc', 'gaia_edr3_tmass_psc_xsc_best_neighbour2', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."pts_key", "t2"."catalogid") "t1"."pts_key" AS "target_id", "t2"."catalogid", (first_value("t1"."pts_key") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."pts_key" ASC) = "t1"."pts_key") AS "best" FROM "catalogdb"."twomass_psc" AS "t1" INNER JOIN "catalogdb"."gaia_edr3_tmass_psc_xsc_best_neighbour2" AS "t3" ON ("t3"."original_ext_source_id" = "t1"."designation") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t4" ON ("t3"."source_id" = "t4"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t4"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_twomass_psc" AS "t5" WHERE (("t5"."version_id" = 31) AND (("t5"."target_id" = "t1"."pts_key") OR ("t5"."catalogid" = "t2"."catalogid")))))
2022-12-28 14:38:09,062 - POST_PROCESS_NOTE - [TWOMASS_PSC] The query for this and the other path failed due to connection problems so they were solved using external scripts and thus the process was not saved in this logged originally.  In any case after the crossmatch was finished the query by range mode in phase_1 was added to the script as an option that could be included in the condign file in the phase1_range parameter, and thus, the code processing should be fully reproducible by the current crossmatch code, and the steps saved in the log.
2022-12-31 10:50:00,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Creating table phase1_content_tmass with external script phase1_range_tmass.py
2022-12-31 10:50:00,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Setting enable_hashjoin=False with external script phase1_range_tmass.py
2022-12-31 10:50:00,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Selecting linked targets into table catalogdb.phase1_content_tmass with external script phase1_range_tmass.py splitting queries by pts_key range changing iteratively values of {min_id} and {max_id} using join path ['twomass_psc', 'gaia_edr3_tmass_psc_xsc_best_neighbour2', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: INSERT INTO catalogdb.phase1_content_tic SELECT DISTINCT ON ("t1"."pts_key", "t2"."catalogid") "t1"."pts_key" AS "target_id", "t2"."catalogid",(first_value("t1"."pts_key") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."pts_key" ASC) = "t1"."pts_key") AS "best" FROM "catalogdb"."twomass_psc" AS "t1"INNER JOIN "catalogdb"."gaia_edr3_tmass_psc_xsc_best_neighbour2" AS "t3" ON ("t3"."original_ext_source_id" = "t1"."designation")INNER JOIN "catalogdb"."gaia_dr3_source" AS "t4" ON ("t3"."source_id" = "t4"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t4"."source_id") WHERE (("t2"."version_id" = 31) AND ("t2"."best" IS True) AND (t1.pts_key>={min_id}) AND (t1.pts_key<{max_id}) );
2022-12-31 16:43:00,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Found 469,039,027 targets linked with external script phase1_range_tmass.py in approximately 21180 s.
2023-01-01 09:00:00,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Copying data into relational table catalog_to_twomass_psc with external command in psql terminal.
2023-01-02 05:30:00,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Linked 469,039,027 records in approximately 94980 s.
2023-01-02 06:50:00,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Creating table phase1_content_tmass with external script phase1_range_tmass3.py
2023-01-02 06:50:00,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Setting enable_hashjoin=False with external script phase1_range_tmass3.py
2023-01-02 06:50:00,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Selecting linked targets into table catalogdb.phase1_content_tmass3 with external script phase1_range_tmass3.py splitting queries by pts_key range changing iteratively values of {min_id} and {max_id} using join path ['twomass_psc', 'tic_v8', 'catalog_to_tic_v8']: INSERT INTO catalogdb.phase1_content_tmass3 SELECT DISTINCT ON ("t1"."pts_key", "t2"."catalogid") "t1"."pts_key" AS "target_id", "t2"."catalogid",(first_value("t1"."pts_key") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."pts_key" ASC) = "t1"."pts_key") AS "best" FROM "catalogdb"."twomass_psc" AS "t1" INNER JOIN "catalogdb"."tic_v8" AS "t3" ON ("t3"."twomass_psc" = "t1"."designation") INNER JOIN "catalogdb"."catalog_to_tic_v8" AS "t2" ON ("t2"."target_id" = "t3"."id")WHERE (( (t1.pts_key>=1348000000) AND (t1.pts_key<1350000000) AND ("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_twomass_psc" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."pts_key") OR ("t4"."catalogid" = "t2"."catalogid")))));
2023-01-02 09:44:00,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Found 25,008,191 targets linked with external script phase1_range_tmass3.py in approximately 10689.9 s.
2023-01-02 09:57:21,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Copying data into relational table catalog_to_twomass_psc with external script phase1_range_tmass2.sql.
2023-01-02 10:01:25,000 - POST_PROCESS_NOTE - [TWOMASS_PSC] Linked 25,008,191 records in approximately 244 s.
2023-01-02 13:49:30,554 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2023-01-02 13:49:30,554 - INFO - Reference Epoch = 2016.0
2023-01-02 13:49:31,195 - INFO - Query radius = 1.0
2023-01-02 13:49:31,196 - DEBUG - Current database configuration parameters.
2023-01-02 13:49:31,196 - DEBUG - shared_buffers = 76GB
2023-01-02 13:49:31,196 - DEBUG - effective_cache_size = 176GB
2023-01-02 13:49:31,196 - DEBUG - wal_buffers = 16MB
2023-01-02 13:49:31,196 - DEBUG - effective_io_concurrency = 200
2023-01-02 13:49:31,196 - DEBUG - work_mem = 5GB
2023-01-02 13:49:31,197 - DEBUG - max_worker_processes = 32
2023-01-02 13:49:31,197 - DEBUG - random_page_cost = 1
2023-01-02 13:49:31,197 - DEBUG - seq_page_cost = 0.5
2023-01-02 13:49:31,197 - DEBUG - cpu_index_tuple_cost = 0.005
2023-01-02 13:49:31,197 - DEBUG - cpu_operator_cost = 0.0025
2023-01-02 13:49:31,197 - DEBUG - default_statistics_target = 3000
2023-01-02 13:49:31,197 - DEBUG - temp_buffers = 10GB
2023-01-02 13:49:31,197 - DEBUG - plan_cache_mode = auto
2023-01-02 13:49:31,197 - DEBUG - geqo_effort = 5
2023-01-02 13:49:31,197 - DEBUG - force_parallel_mode = off
2023-01-02 13:49:31,197 - DEBUG - enable_seqscan = on
2023-01-02 13:49:31,197 - DEBUG - enable_nestloop = on
2023-01-02 13:49:31,206 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2023-01-02 13:49:31,219 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2023-01-02 13:49:31,413 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2023-01-02 13:49:31,418 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2023-01-02 13:49:31,488 - WARNING - Skipping table gaia_dr3_source.
2023-01-02 13:49:31,488 - WARNING - Skipping table gaia_dr2_source.
2023-01-02 13:49:31,488 - WARNING - Skipping table legacy_survey_dr10.
2023-01-02 13:49:31,488 - WARNING - Skipping table legacy_survey_dr8.
2023-01-02 13:49:31,488 - WARNING - Skipping table panstarrs1.
2023-01-02 13:49:31,488 - WARNING - Skipping table tic_v8.
2023-01-02 13:49:31,489 - WARNING - Skipping table tic_v8_extended.
2023-01-02 13:49:31,489 - WARNING - Skipping table sdss_dr13_photoobj_primary.
2023-01-02 13:49:31,489 - INFO - [TWOMASS_PSC] Processing table twomass_psc.
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] Table cross-matching parameters:
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] ra_column: ra
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] dec_column: decl
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] pmra_column: none
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] pmdec_column: none
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] is_pmra_cos: true
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] parallax_column: none
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] epoch: none
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] epoch_column: none
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] epoch_format: jyear
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] has_duplicates: false
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] skip: false
2023-01-02 13:49:31,489 - DEBUG - [TWOMASS_PSC] skip_phases: []
2023-01-02 13:49:31,490 - DEBUG - [TWOMASS_PSC] query_radius: 1.0
2023-01-02 13:49:31,490 - DEBUG - [TWOMASS_PSC] row_count: 470,987,140
2023-01-02 13:49:31,490 - DEBUG - [TWOMASS_PSC] resolution: nan
2023-01-02 13:49:31,490 - DEBUG - [TWOMASS_PSC] join_weight: 1
2023-01-02 13:49:31,490 - INFO - [TWOMASS_PSC] Setting phase run 1
2023-01-02 13:49:31,490 - INFO - [TWOMASS_PSC] Phase 2: cross-matching against existing targets.
2023-01-02 13:49:31,497 - DEBUG - [TWOMASS_PSC] Cross-matching model against temporary table.
2023-01-02 13:49:31,497 - DEBUG - [TWOMASS_PSC] SET LOCAL work_mem='10GB';
2023-01-02 13:49:31,497 - DEBUG - [TWOMASS_PSC] SET LOCAL temp_buffers='5GB';
2023-01-02 13:49:31,497 - DEBUG - [TWOMASS_PSC] SET LOCAL enable_hashjoin=False;
2023-01-02 13:49:31,499 - DEBUG - [TWOMASS_PSC] Inserting cross-matched data into relational model 'catalog_to_twomass_psc' in PSQL: : INSERT INTO "catalogdb"."catalog_to_twomass_psc" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."pts_key" AS "target_id", q3c_dist("t2"."ra", "t2"."decl", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."twomass_psc" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."decl", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_twomass_psc" AS "catalog_to_twomass_psc" WHERE (("catalog_to_twomass_psc"."version_id" = 31) AND (("catalog_to_twomass_psc"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_twomass_psc"."target_id" = "xmatched"."target_id"))))
2023-01-02 17:21:35,453 - DEBUG - [TWOMASS_PSC] Cross-matched catalog_47cd76e43f74bbc2 with 58,650 targets in twomass_psc. Run in 12723.957 s.
2023-01-02 17:21:35,454 - DEBUG - [TWOMASS_PSC] Running ANALYZE on catalog_to_twomass_psc.
2023-01-02 17:22:24,722 - INFO - [TWOMASS_PSC] Phase 3: adding non cross-matched targets.
2023-01-02 17:22:24,730 - DEBUG - [TWOMASS_PSC] SET LOCAL work_mem='10GB';
2023-01-02 17:22:24,730 - DEBUG - [TWOMASS_PSC] SET LOCAL temp_buffers='5GB';
2023-01-02 17:22:24,731 - DEBUG - [TWOMASS_PSC] SET LOCAL enable_hashjoin=False;
2023-01-02 17:22:24,732 - DEBUG - [TWOMASS_PSC] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050400675705956) AS "catalogid", "t1"."pts_key" AS "target_id", "t1"."ra" AS "ra", "t1"."decl" AS "dec" FROM "catalogdb"."twomass_psc" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_twomass_psc" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."pts_key"))))
2023-01-02 17:28:19,125 - DEBUG - [TWOMASS_PSC] Copying data into relational model 'catalog_to_twomass_psc': INSERT INTO "catalogdb"."catalog_to_twomass_psc" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2023-01-02 17:28:19,915 - DEBUG - [TWOMASS_PSC] Insertion into catalog_to_twomass_psc completed with 12,163 rows in 355.184 s.
2023-01-02 17:28:19,915 - DEBUG - [TWOMASS_PSC] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec") SELECT "t1"."catalogid", 'twomass_psc', 31, "t1"."ra", "t1"."dec" FROM "phase3_content" AS "t1"
2023-01-02 17:28:22,973 - DEBUG - [TWOMASS_PSC] Inserted 12,163 rows. Total time: 358.243 s.
2023-01-02 17:28:22,973 - DEBUG - [TWOMASS_PSC] Running ANALYZE on catalog_to_twomass_psc.
2023-01-02 17:28:36,546 - INFO - [TWOMASS_PSC] Fully processed twomass_psc in 13145 s.
2023-01-02 17:28:36,557 - INFO - [KEPLER_INPUT_10] Processing table kepler_input_10.
2023-01-02 17:28:36,557 - DEBUG - [KEPLER_INPUT_10] Table cross-matching parameters:
2023-01-02 17:28:36,557 - DEBUG - [KEPLER_INPUT_10] ra_column: kic_degree_ra
2023-01-02 17:28:36,557 - DEBUG - [KEPLER_INPUT_10] dec_column: kic_dec
2023-01-02 17:28:36,557 - DEBUG - [KEPLER_INPUT_10] pmra_column: none
2023-01-02 17:28:36,557 - DEBUG - [KEPLER_INPUT_10] pmdec_column: none
2023-01-02 17:28:36,557 - DEBUG - [KEPLER_INPUT_10] is_pmra_cos: true
2023-01-02 17:28:36,557 - DEBUG - [KEPLER_INPUT_10] parallax_column: kic_parallax
2023-01-02 17:28:36,557 - DEBUG - [KEPLER_INPUT_10] epoch: none
2023-01-02 17:28:36,558 - DEBUG - [KEPLER_INPUT_10] epoch_column: none
2023-01-02 17:28:36,558 - DEBUG - [KEPLER_INPUT_10] epoch_format: jyear
2023-01-02 17:28:36,558 - DEBUG - [KEPLER_INPUT_10] has_duplicates: false
2023-01-02 17:28:36,558 - DEBUG - [KEPLER_INPUT_10] skip: false
2023-01-02 17:28:36,558 - DEBUG - [KEPLER_INPUT_10] skip_phases: []
2023-01-02 17:28:36,558 - DEBUG - [KEPLER_INPUT_10] query_radius: 1.0
2023-01-02 17:28:36,558 - DEBUG - [KEPLER_INPUT_10] row_count: 13,161,029
2023-01-02 17:28:36,558 - DEBUG - [KEPLER_INPUT_10] resolution: nan
2023-01-02 17:28:36,558 - DEBUG - [KEPLER_INPUT_10] join_weight: 1
2023-01-02 17:28:36,566 - INFO - [KEPLER_INPUT_10] Phase 1: linking existing targets.
2023-01-02 17:28:36,567 - DEBUG - [KEPLER_INPUT_10] Found 2 paths between kepler_input_10 and temporary output table.
2023-01-02 17:28:36,567 - DEBUG - [KEPLER_INPUT_10] SET LOCAL work_mem='10GB';
2023-01-02 17:28:36,567 - DEBUG - [KEPLER_INPUT_10] SET LOCAL temp_buffers='5GB';
2023-01-02 17:28:36,567 - DEBUG - [KEPLER_INPUT_10] SET LOCAL enable_hashjoin=False;
2023-01-02 17:28:36,569 - DEBUG - [KEPLER_INPUT_10] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['kepler_input_10', 'tic_v8', 'catalog_to_tic_v8']: SELECT DISTINCT ON ("t1"."kic_kepler_id", "t2"."catalogid") "t1"."kic_kepler_id" AS "target_id", "t2"."catalogid", (first_value("t1"."kic_kepler_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."kic_kepler_id" ASC) = "t1"."kic_kepler_id") AS "best" FROM "catalogdb"."kepler_input_10" AS "t1" INNER JOIN "catalogdb"."tic_v8" AS "t3" ON ("t3"."kic" = "t1"."kic_kepler_id") INNER JOIN "catalogdb"."catalog_to_tic_v8" AS "t2" ON ("t2"."target_id" = "t3"."id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_kepler_input_10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."kic_kepler_id") OR ("t4"."catalogid" = "t2"."catalogid")))))
2023-01-02 17:29:26,709 - DEBUG - [KEPLER_INPUT_10] Copying data into relational model 'catalog_to_kepler_input_10'.
2023-01-02 17:30:41,662 - DEBUG - [KEPLER_INPUT_10] Linked 6,150,541 records in 125.095 s.
2023-01-02 17:30:41,663 - DEBUG - [KEPLER_INPUT_10] Running ANALYZE on catalog_to_kepler_input_10.
2023-01-02 17:31:22,349 - DEBUG - [KEPLER_INPUT_10] SET LOCAL work_mem='10GB';
2023-01-02 17:31:22,349 - DEBUG - [KEPLER_INPUT_10] SET LOCAL temp_buffers='5GB';
2023-01-02 17:31:22,349 - DEBUG - [KEPLER_INPUT_10] SET LOCAL enable_hashjoin=False;
2023-01-02 17:31:22,351 - DEBUG - [KEPLER_INPUT_10] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['kepler_input_10', 'tic_v8_extended', 'catalog_to_tic_v8_extended']: SELECT DISTINCT ON ("t1"."kic_kepler_id", "t2"."catalogid") "t1"."kic_kepler_id" AS "target_id", "t2"."catalogid", (first_value("t1"."kic_kepler_id") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."kic_kepler_id" ASC) = "t1"."kic_kepler_id") AS "best" FROM "catalogdb"."kepler_input_10" AS "t1" INNER JOIN "catalogdb"."tic_v8_extended" AS "t3" ON ("t3"."kic" = "t1"."kic_kepler_id") INNER JOIN "catalogdb"."catalog_to_tic_v8_extended" AS "t2" ON ("t2"."target_id" = "t3"."id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_kepler_input_10" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."kic_kepler_id") OR ("t4"."catalogid" = "t2"."catalogid")))))
2023-01-02 17:31:30,247 - DEBUG - [KEPLER_INPUT_10] Copying data into relational model 'catalog_to_kepler_input_10'.
2023-01-02 17:31:30,249 - DEBUG - [KEPLER_INPUT_10] Linked 0 records in 7.901 s.
2023-01-02 17:31:30,250 - INFO - [KEPLER_INPUT_10] Phase 2: cross-matching against existing targets.
2023-01-02 17:31:30,257 - DEBUG - [KEPLER_INPUT_10] Cross-matching model against temporary table.
2023-01-02 17:31:30,257 - DEBUG - [KEPLER_INPUT_10] SET LOCAL work_mem='10GB';
2023-01-02 17:31:30,257 - DEBUG - [KEPLER_INPUT_10] SET LOCAL temp_buffers='5GB';
2023-01-02 17:31:30,257 - DEBUG - [KEPLER_INPUT_10] SET LOCAL enable_hashjoin=False;
2023-01-02 17:31:30,259 - DEBUG - [KEPLER_INPUT_10] Inserting cross-matched data into relational model 'catalog_to_kepler_input_10' in PSQL: : INSERT INTO "catalogdb"."catalog_to_kepler_input_10" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."kic_kepler_id" AS "target_id", q3c_dist("t2"."kic_degree_ra", "t2"."kic_dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."kepler_input_10" AS "t2" WHERE (q3c_join("t2"."kic_degree_ra", "t2"."kic_dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_kepler_input_10" AS "catalog_to_kepler_input_10" WHERE (("catalog_to_kepler_input_10"."version_id" = 31) AND (("catalog_to_kepler_input_10"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_kepler_input_10"."target_id" = "xmatched"."target_id"))))
2023-01-02 17:37:10,599 - DEBUG - [KEPLER_INPUT_10] Cross-matched catalog_47cd76e43f74bbc2 with 4,846,793 targets in kepler_input_10. Run in 340.342 s.
2023-01-02 17:37:10,600 - DEBUG - [KEPLER_INPUT_10] Running ANALYZE on catalog_to_kepler_input_10.
2023-01-02 17:37:22,165 - INFO - [KEPLER_INPUT_10] Phase 3: adding non cross-matched targets.
2023-01-02 17:37:22,173 - DEBUG - [KEPLER_INPUT_10] SET LOCAL work_mem='10GB';
2023-01-02 17:37:22,174 - DEBUG - [KEPLER_INPUT_10] SET LOCAL temp_buffers='5GB';
2023-01-02 17:37:22,174 - DEBUG - [KEPLER_INPUT_10] SET LOCAL enable_hashjoin=False;
2023-01-02 17:37:22,175 - DEBUG - [KEPLER_INPUT_10] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050400675718119) AS "catalogid", "t1"."kic_kepler_id" AS "target_id", "t1"."kic_degree_ra" AS "ra", "t1"."kic_dec" AS "dec", "t1"."kic_parallax" AS "parallax" FROM "catalogdb"."kepler_input_10" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_kepler_input_10" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."kic_kepler_id"))))
2023-01-02 17:37:38,150 - DEBUG - [KEPLER_INPUT_10] Copying data into relational model 'catalog_to_kepler_input_10': INSERT INTO "catalogdb"."catalog_to_kepler_input_10" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2023-01-02 17:38:09,249 - DEBUG - [KEPLER_INPUT_10] Insertion into catalog_to_kepler_input_10 completed with 2,255,464 rows in 47.076 s.
2023-01-02 17:38:09,250 - DEBUG - [KEPLER_INPUT_10] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec", "parallax") SELECT "t1"."catalogid", 'kepler_input_10', 31, "t1"."ra", "t1"."dec", "t1"."parallax" FROM "phase3_content" AS "t1"
2023-01-02 17:38:41,349 - DEBUG - [KEPLER_INPUT_10] Inserted 2,255,464 rows. Total time: 79.176 s.
2023-01-02 17:38:41,350 - DEBUG - [KEPLER_INPUT_10] Running ANALYZE on catalog_to_kepler_input_10.
2023-01-02 17:38:52,856 - INFO - [KEPLER_INPUT_10] Fully processed kepler_input_10 in 616 s.
2023-01-02 17:38:52,865 - INFO - [TYCHO2] Processing table tycho2.
2023-01-02 17:38:52,865 - DEBUG - [TYCHO2] Table cross-matching parameters:
2023-01-02 17:38:52,865 - DEBUG - [TYCHO2] ra_column: ramdeg
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] dec_column: demdeg
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] pmra_column: pmra
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] pmdec_column: pmde
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] is_pmra_cos: true
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] parallax_column: none
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] epoch: 2000.0
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] epoch_column: none
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] epoch_format: jyear
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] has_duplicates: false
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] skip: false
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] skip_phases: []
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] query_radius: 1.0
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] row_count: 2,558,393
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] resolution: nan
2023-01-02 17:38:52,866 - DEBUG - [TYCHO2] join_weight: 1
2023-01-02 17:38:52,873 - INFO - [TYCHO2] Phase 1: linking existing targets.
2023-01-02 17:38:52,874 - DEBUG - [TYCHO2] Found 2 paths between tycho2 and temporary output table.
2023-01-02 17:38:52,875 - DEBUG - [TYCHO2] SET LOCAL work_mem='10GB';
2023-01-02 17:38:52,875 - DEBUG - [TYCHO2] SET LOCAL temp_buffers='5GB';
2023-01-02 17:38:52,875 - DEBUG - [TYCHO2] SET LOCAL enable_hashjoin=False;
2023-01-02 17:38:52,877 - DEBUG - [TYCHO2] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['tycho2', 'gaia_edr3_tycho2tdsc_merge_best_neighbour2', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."designation", "t2"."catalogid") "t1"."designation" AS "target_id", "t2"."catalogid", (first_value("t1"."designation") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."designation" ASC) = "t1"."designation") AS "best" FROM "catalogdb"."tycho2" AS "t1" INNER JOIN "catalogdb"."gaia_edr3_tycho2tdsc_merge_best_neighbour2" AS "t3" ON ("t1"."designation2" = "t3"."original_ext_source_id") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t4" ON ("t3"."source_id" = "t4"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t4"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tycho2" AS "t5" WHERE (("t5"."version_id" = 31) AND (("t5"."target_id" = "t1"."designation") OR ("t5"."catalogid" = "t2"."catalogid")))))
2023-01-02 19:29:48,937 - DEBUG - [TYCHO2] Copying data into relational model 'catalog_to_tycho2'.
2023-01-02 19:30:24,971 - DEBUG - [TYCHO2] Linked 2,506,304 records in 6692.096 s.
2023-01-02 19:30:24,971 - DEBUG - [TYCHO2] Running ANALYZE on catalog_to_tycho2.
2023-01-02 19:31:01,069 - DEBUG - [TYCHO2] SET LOCAL work_mem='10GB';
2023-01-02 19:31:01,070 - DEBUG - [TYCHO2] SET LOCAL temp_buffers='5GB';
2023-01-02 19:31:01,070 - DEBUG - [TYCHO2] SET LOCAL enable_hashjoin=False;
2023-01-02 19:31:01,072 - DEBUG - [TYCHO2] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['tycho2', 'tic_v8', 'catalog_to_tic_v8']: SELECT DISTINCT ON ("t1"."designation", "t2"."catalogid") "t1"."designation" AS "target_id", "t2"."catalogid", (first_value("t1"."designation") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."designation" ASC) = "t1"."designation") AS "best" FROM "catalogdb"."tycho2" AS "t1" INNER JOIN "catalogdb"."tic_v8" AS "t3" ON ("t3"."tycho2_tycid" = "t1"."tycid") INNER JOIN "catalogdb"."catalog_to_tic_v8" AS "t2" ON ("t2"."target_id" = "t3"."id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tycho2" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."designation") OR ("t4"."catalogid" = "t2"."catalogid")))))
2023-01-02 20:13:12,532 - DEBUG - [TYCHO2] Copying data into relational model 'catalog_to_tycho2'.
2023-01-02 20:13:15,135 - DEBUG - [TYCHO2] Linked 36,486 records in 2534.066 s.
2023-01-02 20:13:15,135 - DEBUG - [TYCHO2] Running ANALYZE on catalog_to_tycho2.
2023-01-02 20:13:49,065 - INFO - [TYCHO2] Phase 2: cross-matching against existing targets.
2023-01-02 20:13:49,080 - DEBUG - [TYCHO2] Determining maximum epoch delta between catalogues.
2023-01-02 20:13:49,080 - DEBUG - [TYCHO2] Maximum epoch delta: 16.100 (+ 0.1 year).
2023-01-02 20:13:49,080 - DEBUG - [TYCHO2] Cross-matching model against temporary table.
2023-01-02 20:13:49,081 - DEBUG - [TYCHO2] SET LOCAL work_mem='10GB';
2023-01-02 20:13:49,081 - DEBUG - [TYCHO2] SET LOCAL temp_buffers='5GB';
2023-01-02 20:13:49,081 - DEBUG - [TYCHO2] SET LOCAL enable_hashjoin=False;
2023-01-02 20:13:49,082 - DEBUG - [TYCHO2] Inserting cross-matched data into relational model 'catalog_to_tycho2' in PSQL: : INSERT INTO "catalogdb"."catalog_to_tycho2" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."designation" AS "target_id", q3c_dist_pm("t2"."ramdeg", "t2"."demdeg", "t2"."pmra", "t2"."pmde", 1, 2000.0, "t1"."ra", "t1"."dec", 2016.0) AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."tycho2" AS "t2" WHERE (((q3c_join_pm("t2"."ramdeg", "t2"."demdeg", "t2"."pmra", "t2"."pmde", 1, 2000.0, "t1"."ra", "t1"."dec", 2016.0, 16.1, 0.0002777777777777778) AND True) AND ("t2"."ramdeg" IS NOT None)) AND ("t2"."demdeg" IS NOT None))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tycho2" AS "catalog_to_tycho2" WHERE (("catalog_to_tycho2"."version_id" = 31) AND (("catalog_to_tycho2"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_tycho2"."target_id" = "xmatched"."target_id"))))
2023-01-03 06:33:53,979 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2023-01-03 06:33:53,979 - INFO - Reference Epoch = 2016.0
2023-01-03 06:33:54,616 - INFO - Query radius = 1.0
2023-01-03 06:33:54,616 - DEBUG - Current database configuration parameters.
2023-01-03 06:33:54,617 - DEBUG - shared_buffers = 76GB
2023-01-03 06:33:54,617 - DEBUG - effective_cache_size = 176GB
2023-01-03 06:33:54,617 - DEBUG - wal_buffers = 16MB
2023-01-03 06:33:54,617 - DEBUG - effective_io_concurrency = 200
2023-01-03 06:33:54,617 - DEBUG - work_mem = 5GB
2023-01-03 06:33:54,617 - DEBUG - max_worker_processes = 32
2023-01-03 06:33:54,617 - DEBUG - random_page_cost = 1
2023-01-03 06:33:54,617 - DEBUG - seq_page_cost = 0.5
2023-01-03 06:33:54,617 - DEBUG - cpu_index_tuple_cost = 0.005
2023-01-03 06:33:54,617 - DEBUG - cpu_operator_cost = 0.0025
2023-01-03 06:33:54,617 - DEBUG - default_statistics_target = 3000
2023-01-03 06:33:54,617 - DEBUG - temp_buffers = 10GB
2023-01-03 06:33:54,617 - DEBUG - plan_cache_mode = auto
2023-01-03 06:33:54,617 - DEBUG - geqo_effort = 5
2023-01-03 06:33:54,617 - DEBUG - force_parallel_mode = off
2023-01-03 06:33:54,617 - DEBUG - enable_seqscan = on
2023-01-03 06:33:54,617 - DEBUG - enable_nestloop = on
2023-01-03 06:33:54,626 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2023-01-03 06:33:54,638 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2023-01-03 06:33:54,801 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2023-01-03 06:33:54,834 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2023-01-03 06:33:54,870 - WARNING - Skipping table gaia_dr3_source.
2023-01-03 06:33:54,871 - WARNING - Skipping table gaia_dr2_source.
2023-01-03 06:33:54,871 - WARNING - Skipping table legacy_survey_dr10.
2023-01-03 06:33:54,871 - WARNING - Skipping table legacy_survey_dr8.
2023-01-03 06:33:54,871 - WARNING - Skipping table panstarrs1.
2023-01-03 06:33:54,871 - WARNING - Skipping table tic_v8.
2023-01-03 06:33:54,871 - WARNING - Skipping table tic_v8_extended.
2023-01-03 06:33:54,871 - WARNING - Skipping table sdss_dr13_photoobj_primary.
2023-01-03 06:33:54,871 - WARNING - Skipping table twomass_psc.
2023-01-03 06:33:54,871 - WARNING - Skipping table kepler_input_10.
2023-01-03 06:33:54,871 - INFO - [TYCHO2] Processing table tycho2.
2023-01-03 06:33:54,871 - DEBUG - [TYCHO2] Table cross-matching parameters:
2023-01-03 06:33:54,871 - DEBUG - [TYCHO2] ra_column: ramdeg
2023-01-03 06:33:54,871 - DEBUG - [TYCHO2] dec_column: demdeg
2023-01-03 06:33:54,871 - DEBUG - [TYCHO2] pmra_column: pmra
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] pmdec_column: pmde
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] is_pmra_cos: true
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] parallax_column: none
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] epoch: 2000.0
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] epoch_column: none
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] epoch_format: jyear
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] has_duplicates: false
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] skip: false
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] skip_phases: []
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] query_radius: 1.0
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] row_count: 2,558,393
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] resolution: nan
2023-01-03 06:33:54,872 - DEBUG - [TYCHO2] join_weight: 1
2023-01-03 06:33:54,872 - INFO - [TYCHO2] Setting phase run 1
2023-01-03 06:33:54,872 - INFO - [TYCHO2] Phase 2: cross-matching against existing targets.
2023-01-03 06:33:54,879 - DEBUG - [TYCHO2] Determining maximum epoch delta between catalogues.
2023-01-03 06:33:54,879 - DEBUG - [TYCHO2] Maximum epoch delta: 16.100 (+ 0.1 year).
2023-01-03 06:33:54,879 - DEBUG - [TYCHO2] Cross-matching model against temporary table.
2023-01-03 06:33:54,879 - DEBUG - [TYCHO2] SET LOCAL work_mem='10GB';
2023-01-03 06:33:54,879 - DEBUG - [TYCHO2] SET LOCAL temp_buffers='5GB';
2023-01-03 06:33:54,879 - DEBUG - [TYCHO2] SET LOCAL enable_hashjoin=False;
2023-01-03 06:33:54,881 - DEBUG - [TYCHO2] Inserting cross-matched data into relational model 'catalog_to_tycho2' in PSQL: : INSERT INTO "catalogdb"."catalog_to_tycho2" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."designation" AS "target_id", q3c_dist_pm("t2"."ramdeg", "t2"."demdeg", "t2"."pmra", "t2"."pmde", 1, 2000.0, "t1"."ra", "t1"."dec", 2016.0) AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."tycho2" AS "t2" WHERE (((q3c_join_pm("t2"."ramdeg", "t2"."demdeg", "t2"."pmra", "t2"."pmde", 1, 2000.0, "t1"."ra", "t1"."dec", 2016.0, 16.1, 0.0002777777777777778) AND True) AND ("t2"."ramdeg" IS NOT Null)) AND ("t2"."demdeg" IS NOT Null))) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tycho2" AS "catalog_to_tycho2" WHERE (("catalog_to_tycho2"."version_id" = 31) AND (("catalog_to_tycho2"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_tycho2"."target_id" = "xmatched"."target_id"))))
2023-01-03 07:13:54,289 - DEBUG - [TYCHO2] Cross-matched catalog_47cd76e43f74bbc2 with 340 targets in tycho2. Run in 2399.410 s.
2023-01-03 07:13:54,289 - DEBUG - [TYCHO2] Running ANALYZE on catalog_to_tycho2.
2023-01-03 07:14:28,412 - INFO - [TYCHO2] Phase 3: adding non cross-matched targets.
2023-01-03 07:14:28,421 - DEBUG - [TYCHO2] SET LOCAL work_mem='10GB';
2023-01-03 07:14:28,421 - DEBUG - [TYCHO2] SET LOCAL temp_buffers='5GB';
2023-01-03 07:14:28,421 - DEBUG - [TYCHO2] SET LOCAL enable_hashjoin=False;
2023-01-03 07:14:28,423 - DEBUG - [TYCHO2] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050400677973584) AS "catalogid", "t1"."designation" AS "target_id", ("t1"."ramdeg" + ((((coalesce("t1"."pmra", 0) / 1000.0) / 3600.0) / cos(radians(coalesce("t1"."demdeg", 0)))) * coalesce(16.0, 0))) AS "ra", ("t1"."demdeg" + (((coalesce("t1"."pmde", 0) / 1000.0) / 3600.0) * coalesce(16.0, 0))) AS "dec", "t1"."pmra" AS "pmra", "t1"."pmde" AS "pmdec" FROM "catalogdb"."tycho2" AS "t1" WHERE (((True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_tycho2" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."designation")))) AND ("t1"."ramdeg" IS NOT Null)) AND ("t1"."demdeg" IS NOT Null))
2023-01-03 07:14:33,453 - DEBUG - [TYCHO2] Copying data into relational model 'catalog_to_tycho2': INSERT INTO "catalogdb"."catalog_to_tycho2" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2023-01-03 07:14:33,470 - DEBUG - [TYCHO2] Insertion into catalog_to_tycho2 completed with 477 rows in 5.049 s.
2023-01-03 07:14:33,471 - DEBUG - [TYCHO2] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec", "pmra", "pmdec") SELECT "t1"."catalogid", 'tycho2', 31, "t1"."ra", "t1"."dec", "t1"."pmra", "t1"."pmdec" FROM "phase3_content" AS "t1"
2023-01-03 07:14:33,520 - DEBUG - [TYCHO2] Inserted 477 rows. Total time: 5.098 s.
2023-01-03 07:14:33,520 - DEBUG - [TYCHO2] Running ANALYZE on catalog_to_tycho2.
2023-01-03 07:15:07,548 - INFO - [TYCHO2] Fully processed tycho2 in 2473 s.
2023-01-03 07:15:07,558 - INFO - [GAIA_DR2_WD_SDSS] Processing table gaia_dr2_wd_sdss.
2023-01-03 07:15:07,558 - DEBUG - [GAIA_DR2_WD_SDSS] Table cross-matching parameters:
2023-01-03 07:15:07,558 - DEBUG - [GAIA_DR2_WD_SDSS] ra_column: ra
2023-01-03 07:15:07,558 - DEBUG - [GAIA_DR2_WD_SDSS] dec_column: dec
2023-01-03 07:15:07,558 - DEBUG - [GAIA_DR2_WD_SDSS] pmra_column: none
2023-01-03 07:15:07,558 - DEBUG - [GAIA_DR2_WD_SDSS] pmdec_column: none
2023-01-03 07:15:07,558 - DEBUG - [GAIA_DR2_WD_SDSS] is_pmra_cos: true
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] parallax_column: none
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] epoch: none
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] epoch_column: none
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] epoch_format: jyear
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] has_duplicates: false
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] skip: false
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] skip_phases: []
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] query_radius: 1.0
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] row_count: 37,259
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] resolution: nan
2023-01-03 07:15:07,559 - DEBUG - [GAIA_DR2_WD_SDSS] join_weight: 1
2023-01-03 07:15:07,566 - INFO - [GAIA_DR2_WD_SDSS] Phase 1: linking existing targets.
2023-01-03 07:15:07,567 - DEBUG - [GAIA_DR2_WD_SDSS] Found 1 paths between gaia_dr2_wd_sdss and temporary output table.
2023-01-03 07:15:07,567 - DEBUG - [GAIA_DR2_WD_SDSS] SET LOCAL work_mem='10GB';
2023-01-03 07:15:07,568 - DEBUG - [GAIA_DR2_WD_SDSS] SET LOCAL temp_buffers='5GB';
2023-01-03 07:15:07,568 - DEBUG - [GAIA_DR2_WD_SDSS] SET LOCAL enable_hashjoin=False;
2023-01-03 07:15:07,570 - DEBUG - [GAIA_DR2_WD_SDSS] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['gaia_dr2_wd_sdss', 'gaia_dr2_wd', 'gaia_dr2_source', 'catalog_to_gaia_dr2_source']: SELECT DISTINCT ON ("t1"."pk", "t2"."catalogid") "t1"."pk" AS "target_id", "t2"."catalogid", (first_value("t1"."pk") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."pk" ASC) = "t1"."pk") AS "best" FROM "catalogdb"."gaia_dr2_wd_sdss" AS "t1" INNER JOIN "catalogdb"."gaia_dr2_wd" AS "t3" ON ("t3"."wd" = "t1"."wd") INNER JOIN "catalogdb"."gaia_dr2_source" AS "t4" ON ("t3"."source_id" = "t4"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr2_source" AS "t2" ON ("t2"."target_id" = "t4"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_gaia_dr2_wd_sdss" AS "t5" WHERE (("t5"."version_id" = 31) AND (("t5"."target_id" = "t1"."pk") OR ("t5"."catalogid" = "t2"."catalogid")))))
2023-01-03 07:16:12,289 - DEBUG - [GAIA_DR2_WD_SDSS] Copying data into relational model 'catalog_to_gaia_dr2_wd_sdss'.
2023-01-03 07:16:12,703 - DEBUG - [GAIA_DR2_WD_SDSS] Linked 37,258 records in 65.136 s.
2023-01-03 07:16:12,704 - DEBUG - [GAIA_DR2_WD_SDSS] Running ANALYZE on catalog_to_gaia_dr2_wd_sdss.
2023-01-03 07:16:14,076 - INFO - [GAIA_DR2_WD_SDSS] Phase 2: cross-matching against existing targets.
2023-01-03 07:16:14,084 - DEBUG - [GAIA_DR2_WD_SDSS] Cross-matching model against temporary table.
2023-01-03 07:16:14,084 - DEBUG - [GAIA_DR2_WD_SDSS] SET LOCAL work_mem='10GB';
2023-01-03 07:16:14,084 - DEBUG - [GAIA_DR2_WD_SDSS] SET LOCAL temp_buffers='5GB';
2023-01-03 07:16:14,084 - DEBUG - [GAIA_DR2_WD_SDSS] SET LOCAL enable_hashjoin=False;
2023-01-03 07:16:14,085 - DEBUG - [GAIA_DR2_WD_SDSS] Inserting cross-matched data into relational model 'catalog_to_gaia_dr2_wd_sdss' in PSQL: : INSERT INTO "catalogdb"."catalog_to_gaia_dr2_wd_sdss" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."pk" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."gaia_dr2_wd_sdss" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_gaia_dr2_wd_sdss" AS "catalog_to_gaia_dr2_wd_sdss" WHERE (("catalog_to_gaia_dr2_wd_sdss"."version_id" = 31) AND (("catalog_to_gaia_dr2_wd_sdss"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_gaia_dr2_wd_sdss"."target_id" = "xmatched"."target_id"))))
2023-01-03 07:17:40,856 - DEBUG - [GAIA_DR2_WD_SDSS] Cross-matched catalog_47cd76e43f74bbc2 with 1 targets in gaia_dr2_wd_sdss. Run in 86.772 s.
2023-01-03 07:17:40,857 - DEBUG - [GAIA_DR2_WD_SDSS] Running ANALYZE on catalog_to_gaia_dr2_wd_sdss.
2023-01-03 07:17:41,519 - INFO - [GAIA_DR2_WD_SDSS] Phase 3: adding non cross-matched targets.
2023-01-03 07:17:41,527 - DEBUG - [GAIA_DR2_WD_SDSS] SET LOCAL work_mem='10GB';
2023-01-03 07:17:41,527 - DEBUG - [GAIA_DR2_WD_SDSS] SET LOCAL temp_buffers='5GB';
2023-01-03 07:17:41,527 - DEBUG - [GAIA_DR2_WD_SDSS] SET LOCAL enable_hashjoin=False;
2023-01-03 07:17:41,528 - DEBUG - [GAIA_DR2_WD_SDSS] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050400677974061) AS "catalogid", "t1"."pk" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec" FROM "catalogdb"."gaia_dr2_wd_sdss" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_gaia_dr2_wd_sdss" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."pk"))))
2023-01-03 07:17:41,834 - DEBUG - [GAIA_DR2_WD_SDSS] Copying data into relational model 'catalog_to_gaia_dr2_wd_sdss': INSERT INTO "catalogdb"."catalog_to_gaia_dr2_wd_sdss" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2023-01-03 07:17:41,835 - DEBUG - [GAIA_DR2_WD_SDSS] Insertion into catalog_to_gaia_dr2_wd_sdss completed with 0 rows in 0.308 s.
2023-01-03 07:17:41,836 - DEBUG - [GAIA_DR2_WD_SDSS] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec") SELECT "t1"."catalogid", 'gaia_dr2_wd_sdss', 31, "t1"."ra", "t1"."dec" FROM "phase3_content" AS "t1"
2023-01-03 07:17:41,836 - DEBUG - [GAIA_DR2_WD_SDSS] Inserted 0 rows. Total time: 0.309 s.
2023-01-03 07:17:41,836 - DEBUG - [GAIA_DR2_WD_SDSS] Running ANALYZE on catalog_to_gaia_dr2_wd_sdss.
2023-01-03 07:17:42,498 - INFO - [GAIA_DR2_WD_SDSS] Fully processed gaia_dr2_wd_sdss in 155 s.
2023-01-03 07:17:42,507 - INFO - [GUVCAT] Processing table guvcat.
2023-01-03 07:17:42,507 - DEBUG - [GUVCAT] Table cross-matching parameters:
2023-01-03 07:17:42,507 - DEBUG - [GUVCAT] ra_column: ra
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] dec_column: dec
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] pmra_column: none
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] pmdec_column: none
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] is_pmra_cos: true
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] parallax_column: none
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] epoch: none
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] epoch_column: none
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] epoch_format: jyear
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] has_duplicates: false
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] skip: false
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] skip_phases: []
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] query_radius: 2.5
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] row_count: 82,992,770
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] resolution: nan
2023-01-03 07:17:42,508 - DEBUG - [GUVCAT] join_weight: 1
2023-01-03 07:17:42,516 - INFO - [GUVCAT] Phase 1: linking existing targets.
2023-01-03 07:17:42,517 - DEBUG - [GUVCAT] No paths found between guvcat and temporary output table.
2023-01-03 07:17:42,517 - INFO - [GUVCAT] Phase 2: cross-matching against existing targets.
2023-01-03 07:17:42,522 - DEBUG - [GUVCAT] Cross-matching model against temporary table.
2023-01-03 07:17:42,523 - DEBUG - [GUVCAT] SET LOCAL work_mem='10GB';
2023-01-03 07:17:42,523 - DEBUG - [GUVCAT] SET LOCAL temp_buffers='5GB';
2023-01-03 07:17:42,523 - DEBUG - [GUVCAT] SET LOCAL enable_hashjoin=False;
2023-01-03 07:17:42,524 - DEBUG - [GUVCAT] Inserting cross-matched data into relational model 'catalog_to_guvcat' in PSQL: : INSERT INTO "catalogdb"."catalog_to_guvcat" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."objid" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."guvcat" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0006944444444444445) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched"
2023-01-03 08:38:15,490 - DEBUG - [GUVCAT] Cross-matched catalog_47cd76e43f74bbc2 with 70,139,697 targets in guvcat. Run in 4832.967 s.
2023-01-03 08:38:15,491 - DEBUG - [GUVCAT] Running ANALYZE on catalog_to_guvcat.
2023-01-03 08:42:05,733 - INFO - [GUVCAT] Phase 3: adding non cross-matched targets.
2023-01-03 08:42:05,742 - DEBUG - [GUVCAT] SET LOCAL work_mem='10GB';
2023-01-03 08:42:05,742 - DEBUG - [GUVCAT] SET LOCAL temp_buffers='5GB';
2023-01-03 08:42:05,742 - DEBUG - [GUVCAT] SET LOCAL enable_hashjoin=False;
2023-01-03 08:42:05,743 - DEBUG - [GUVCAT] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050400677974061) AS "catalogid", "t1"."objid" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec" FROM "catalogdb"."guvcat" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_guvcat" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."objid"))))
2023-01-03 08:46:29,857 - DEBUG - [GUVCAT] Copying data into relational model 'catalog_to_guvcat': INSERT INTO "catalogdb"."catalog_to_guvcat" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2023-01-03 08:53:33,971 - DEBUG - [GUVCAT] Insertion into catalog_to_guvcat completed with 25,042,983 rows in 688.229 s.
2023-01-03 08:53:33,971 - DEBUG - [GUVCAT] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec") SELECT "t1"."catalogid", 'guvcat', 31, "t1"."ra", "t1"."dec" FROM "phase3_content" AS "t1"
2023-01-03 10:41:35,567 - DEBUG - [GUVCAT] Inserted 25,042,983 rows. Total time: 7169.818 s.
2023-01-03 10:41:35,587 - DEBUG - [GUVCAT] Running ANALYZE on catalog_to_guvcat.
2023-01-03 10:43:41,826 - INFO - [GUVCAT] Fully processed guvcat in 12359 s.
2023-01-03 10:43:41,836 - INFO - [MILLIQUAS_7_7] Processing table milliquas_7_7.
2023-01-03 10:43:41,836 - DEBUG - [MILLIQUAS_7_7] Table cross-matching parameters:
2023-01-03 10:43:41,836 - DEBUG - [MILLIQUAS_7_7] ra_column: ra
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] dec_column: dec
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] pmra_column: none
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] pmdec_column: none
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] is_pmra_cos: true
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] parallax_column: none
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] epoch: none
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] epoch_column: none
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] epoch_format: jyear
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] has_duplicates: false
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] skip: false
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] skip_phases: []
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] query_radius: 1.0
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] row_count: 1,630,662
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] resolution: nan
2023-01-03 10:43:41,837 - DEBUG - [MILLIQUAS_7_7] join_weight: 1
2023-01-03 10:43:41,845 - INFO - [MILLIQUAS_7_7] Phase 1: linking existing targets.
2023-01-03 10:43:41,847 - DEBUG - [MILLIQUAS_7_7] No paths found between milliquas_7_7 and temporary output table.
2023-01-03 10:43:41,847 - INFO - [MILLIQUAS_7_7] Phase 2: cross-matching against existing targets.
2023-01-03 10:43:41,853 - DEBUG - [MILLIQUAS_7_7] Cross-matching model against temporary table.
2023-01-03 10:43:41,853 - DEBUG - [MILLIQUAS_7_7] SET LOCAL work_mem='10GB';
2023-01-03 10:43:41,853 - DEBUG - [MILLIQUAS_7_7] SET LOCAL temp_buffers='5GB';
2023-01-03 10:43:41,853 - DEBUG - [MILLIQUAS_7_7] SET LOCAL enable_hashjoin=False;
2023-01-03 10:43:41,854 - DEBUG - [MILLIQUAS_7_7] Inserting cross-matched data into relational model 'catalog_to_milliquas_7_7' in PSQL: : INSERT INTO "catalogdb"."catalog_to_milliquas_7_7" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."pk" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."milliquas_7_7" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0002777777777777778) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched"
2023-01-03 11:18:30,325 - DEBUG - [MILLIQUAS_7_7] Cross-matched catalog_47cd76e43f74bbc2 with 1,654,057 targets in milliquas_7_7. Run in 2088.472 s.
2023-01-03 11:18:30,326 - DEBUG - [MILLIQUAS_7_7] Running ANALYZE on catalog_to_milliquas_7_7.
2023-01-03 11:18:32,318 - INFO - [MILLIQUAS_7_7] Phase 3: adding non cross-matched targets.
2023-01-03 11:18:32,326 - DEBUG - [MILLIQUAS_7_7] SET LOCAL work_mem='10GB';
2023-01-03 11:18:32,326 - DEBUG - [MILLIQUAS_7_7] SET LOCAL temp_buffers='5GB';
2023-01-03 11:18:32,326 - DEBUG - [MILLIQUAS_7_7] SET LOCAL enable_hashjoin=False;
2023-01-03 11:18:32,328 - DEBUG - [MILLIQUAS_7_7] Selecting unique targets into table catalogdb.'phase3_content' in PSLQ: : SELECT (row_number() OVER () + 63050400703017044) AS "catalogid", "t1"."pk" AS "target_id", "t1"."ra" AS "ra", "t1"."dec" AS "dec" FROM "catalogdb"."milliquas_7_7" AS "t1" WHERE (True AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_milliquas_7_7" AS "t2" WHERE (("t2"."version_id" = 31) AND ("t2"."target_id" = "t1"."pk"))))
2023-01-03 11:18:41,029 - DEBUG - [MILLIQUAS_7_7] Copying data into relational model 'catalog_to_milliquas_7_7': INSERT INTO "catalogdb"."catalog_to_milliquas_7_7" ("catalogid", "target_id", "version_id", "best") SELECT "t1"."catalogid", "t1"."target_id", 31, true FROM "catalogdb"."phase3_content" AS "t1"
2023-01-03 11:18:41,238 - DEBUG - [MILLIQUAS_7_7] Insertion into catalog_to_milliquas_7_7 completed with 48,381 rows in 8.912 s.
2023-01-03 11:18:41,239 - DEBUG - [MILLIQUAS_7_7] Running INSERT query into catalog_47cd76e43f74bbc2: INSERT INTO "catalogdb"."catalog_47cd76e43f74bbc2" ("catalogid", "lead", "version_id", "ra", "dec") SELECT "t1"."catalogid", 'milliquas_7_7', 31, "t1"."ra", "t1"."dec" FROM "phase3_content" AS "t1"
2023-01-03 11:18:45,291 - DEBUG - [MILLIQUAS_7_7] Inserted 48,381 rows. Total time: 12.965 s.
2023-01-03 11:18:45,291 - DEBUG - [MILLIQUAS_7_7] Running ANALYZE on catalog_to_milliquas_7_7.
2023-01-03 11:18:46,581 - INFO - [MILLIQUAS_7_7] Fully processed milliquas_7_7 in 2105 s.
2023-01-03 11:18:46,591 - INFO - [UVOTSSC1] Processing table uvotssc1.
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] Table cross-matching parameters:
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] ra_column: radeg
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] dec_column: dedeg
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] pmra_column: none
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] pmdec_column: none
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] is_pmra_cos: true
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] parallax_column: none
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] epoch: none
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] epoch_column: none
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] epoch_format: jyear
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] has_duplicates: false
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] skip: false
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] skip_phases: [3]
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] query_radius: 3
2023-01-03 11:18:46,591 - DEBUG - [UVOTSSC1] row_count: 13,860,568
2023-01-03 11:18:46,592 - DEBUG - [UVOTSSC1] resolution: nan
2023-01-03 11:18:46,592 - DEBUG - [UVOTSSC1] join_weight: 1
2023-01-03 11:18:46,599 - INFO - [UVOTSSC1] Phase 1: linking existing targets.
2023-01-03 11:18:46,600 - DEBUG - [UVOTSSC1] No paths found between uvotssc1 and temporary output table.
2023-01-03 11:18:46,600 - INFO - [UVOTSSC1] Phase 2: cross-matching against existing targets.
2023-01-03 11:18:46,605 - DEBUG - [UVOTSSC1] Cross-matching model against temporary table.
2023-01-03 11:18:46,606 - DEBUG - [UVOTSSC1] SET LOCAL work_mem='10GB';
2023-01-03 11:18:46,606 - DEBUG - [UVOTSSC1] SET LOCAL temp_buffers='5GB';
2023-01-03 11:18:46,606 - DEBUG - [UVOTSSC1] SET LOCAL enable_hashjoin=False;
2023-01-03 11:18:46,607 - DEBUG - [UVOTSSC1] Inserting cross-matched data into relational model 'catalog_to_uvotssc1' in PSQL: : INSERT INTO "catalogdb"."catalog_to_uvotssc1" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."id" AS "target_id", q3c_dist("t2"."radeg", "t2"."dedeg", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."uvotssc1" AS "t2" WHERE (q3c_join("t2"."radeg", "t2"."dedeg", "t1"."ra", "t1"."dec", 0.0008333333333333334) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched"
2023-01-03 11:51:28,078 - DEBUG - [UVOTSSC1] Cross-matched catalog_47cd76e43f74bbc2 with 20,617,653 targets in uvotssc1. Run in 1961.473 s.
2023-01-03 11:51:28,079 - DEBUG - [UVOTSSC1] Running ANALYZE on catalog_to_uvotssc1.
2023-01-03 11:55:44,482 - INFO - [UVOTSSC1] Phase 3: adding non cross-matched targets.
2023-01-03 11:55:44,490 - WARNING - [UVOTSSC1] Skipping due to configuration.
2023-01-03 11:55:44,490 - INFO - [UVOTSSC1] Fully processed uvotssc1 in 2218 s.
2023-01-03 11:55:44,499 - INFO - [XMM_OM_SUSS_5_0] Processing table xmm_om_suss_5_0.
2023-01-03 11:55:44,499 - DEBUG - [XMM_OM_SUSS_5_0] Table cross-matching parameters:
2023-01-03 11:55:44,499 - DEBUG - [XMM_OM_SUSS_5_0] ra_column: ra
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] dec_column: dec
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] pmra_column: none
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] pmdec_column: none
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] is_pmra_cos: true
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] parallax_column: none
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] epoch: none
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] epoch_column: none
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] epoch_format: jyear
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] has_duplicates: false
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] skip: false
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] skip_phases: [3]
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] query_radius: 3
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] row_count: 8,863,922
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] resolution: nan
2023-01-03 11:55:44,500 - DEBUG - [XMM_OM_SUSS_5_0] join_weight: 1
2023-01-03 11:55:44,506 - INFO - [XMM_OM_SUSS_5_0] Phase 1: linking existing targets.
2023-01-03 11:55:44,507 - DEBUG - [XMM_OM_SUSS_5_0] No paths found between xmm_om_suss_5_0 and temporary output table.
2023-01-03 11:55:44,507 - INFO - [XMM_OM_SUSS_5_0] Phase 2: cross-matching against existing targets.
2023-01-03 11:55:44,513 - DEBUG - [XMM_OM_SUSS_5_0] Cross-matching model against temporary table.
2023-01-03 11:55:44,513 - DEBUG - [XMM_OM_SUSS_5_0] SET LOCAL work_mem='10GB';
2023-01-03 11:55:44,513 - DEBUG - [XMM_OM_SUSS_5_0] SET LOCAL temp_buffers='5GB';
2023-01-03 11:55:44,513 - DEBUG - [XMM_OM_SUSS_5_0] SET LOCAL enable_hashjoin=False;
2023-01-03 11:55:44,514 - DEBUG - [XMM_OM_SUSS_5_0] Inserting cross-matched data into relational model 'catalog_to_xmm_om_suss_5_0' in PSQL: : INSERT INTO "catalogdb"."catalog_to_xmm_om_suss_5_0" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."pk" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."xmm_om_suss_5_0" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0008333333333333334) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched"
2023-01-03 12:03:58,995 - DEBUG - [XMM_OM_SUSS_5_0] Cross-matched catalog_47cd76e43f74bbc2 with 14,446,476 targets in xmm_om_suss_5_0. Run in 494.482 s.
2023-01-03 12:03:58,995 - DEBUG - [XMM_OM_SUSS_5_0] Running ANALYZE on catalog_to_xmm_om_suss_5_0.
2023-01-03 12:04:01,947 - INFO - [XMM_OM_SUSS_5_0] Phase 3: adding non cross-matched targets.
2023-01-03 12:04:01,954 - WARNING - [XMM_OM_SUSS_5_0] Skipping due to configuration.
2023-01-03 12:04:01,954 - INFO - [XMM_OM_SUSS_5_0] Fully processed xmm_om_suss_5_0 in 497 s.
2023-01-03 12:04:01,964 - INFO - [ALLWISE] Processing table allwise.
2023-01-03 12:04:01,964 - DEBUG - [ALLWISE] Table cross-matching parameters:
2023-01-03 12:04:01,964 - DEBUG - [ALLWISE] ra_column: ra
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] dec_column: dec
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] pmra_column: none
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] pmdec_column: none
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] is_pmra_cos: true
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] parallax_column: none
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] epoch: none
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] epoch_column: none
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] epoch_format: jyear
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] has_duplicates: false
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] skip: false
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] skip_phases: [3]
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] query_radius: 3
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] row_count: 747,634,050
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] resolution: nan
2023-01-03 12:04:01,965 - DEBUG - [ALLWISE] join_weight: 1
2023-01-03 12:04:01,971 - INFO - [ALLWISE] Phase 1: linking existing targets.
2023-01-03 12:04:01,972 - DEBUG - [ALLWISE] Found 4 paths between allwise and temporary output table.
2023-01-03 12:04:01,977 - DEBUG - [ALLWISE] SET LOCAL work_mem='10GB';
2023-01-03 12:04:01,977 - DEBUG - [ALLWISE] SET LOCAL temp_buffers='5GB';
2023-01-03 12:04:01,977 - DEBUG - [ALLWISE] SET LOCAL enable_hashjoin=False;
2023-01-03 12:04:01,979 - DEBUG - [ALLWISE] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['allwise', 'gaia_edr3_allwise_best_neighbour', 'gaia_dr3_source', 'catalog_to_gaia_dr3_source']: SELECT DISTINCT ON ("t1"."cntr", "t2"."catalogid") "t1"."cntr" AS "target_id", "t2"."catalogid", (first_value("t1"."cntr") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."cntr" ASC) = "t1"."cntr") AS "best" FROM "catalogdb"."allwise" AS "t1" INNER JOIN "catalogdb"."gaia_edr3_allwise_best_neighbour" AS "t3" ON ("t3"."original_ext_source_id" = "t1"."designation") INNER JOIN "catalogdb"."gaia_dr3_source" AS "t4" ON ("t3"."source_id" = "t4"."source_id") INNER JOIN "catalogdb"."catalog_to_gaia_dr3_source" AS "t2" ON ("t2"."target_id" = "t4"."source_id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_allwise" AS "t5" WHERE (("t5"."version_id" = 31) AND (("t5"."target_id" = "t1"."cntr") OR ("t5"."catalogid" = "t2"."catalogid")))))
2023-01-03 22:35:37,364 - DEBUG - [ALLWISE] Copying data into relational model 'catalog_to_allwise'.
2023-01-03 23:40:18,424 - DEBUG - [ALLWISE] Linked 324,115,003 records in 41776.447 s.
2023-01-03 23:40:18,425 - DEBUG - [ALLWISE] Running ANALYZE on catalog_to_allwise.
2023-01-04 00:01:22,288 - DEBUG - [ALLWISE] SET LOCAL work_mem='10GB';
2023-01-04 00:01:22,316 - DEBUG - [ALLWISE] SET LOCAL temp_buffers='5GB';
2023-01-04 00:01:22,316 - DEBUG - [ALLWISE] SET LOCAL enable_hashjoin=False;
2023-01-04 00:01:22,377 - DEBUG - [ALLWISE] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['allwise', 'tic_v8', 'catalog_to_tic_v8']: SELECT DISTINCT ON ("t1"."cntr", "t2"."catalogid") "t1"."cntr" AS "target_id", "t2"."catalogid", (first_value("t1"."cntr") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."cntr" ASC) = "t1"."cntr") AS "best" FROM "catalogdb"."allwise" AS "t1" INNER JOIN "catalogdb"."tic_v8" AS "t3" ON ("t3"."allwise" = "t1"."designation") INNER JOIN "catalogdb"."catalog_to_tic_v8" AS "t2" ON ("t2"."target_id" = "t3"."id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_allwise" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."cntr") OR ("t4"."catalogid" = "t2"."catalogid")))))
2023-01-04 10:58:22,502 - DEBUG - [ALLWISE] Copying data into relational model 'catalog_to_allwise'.
2023-01-04 11:37:57,097 - DEBUG - [ALLWISE] Linked 68,836,117 records in 41794.811 s.
2023-01-04 11:37:57,098 - DEBUG - [ALLWISE] Running ANALYZE on catalog_to_allwise.
2023-01-04 12:03:47,844 - DEBUG - [ALLWISE] SET LOCAL work_mem='10GB';
2023-01-04 12:03:47,845 - DEBUG - [ALLWISE] SET LOCAL temp_buffers='5GB';
2023-01-04 12:03:47,845 - DEBUG - [ALLWISE] SET LOCAL enable_hashjoin=False;
2023-01-04 12:03:47,847 - DEBUG - [ALLWISE] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['allwise', 'tic_v8_extended', 'catalog_to_tic_v8_extended']: SELECT DISTINCT ON ("t1"."cntr", "t2"."catalogid") "t1"."cntr" AS "target_id", "t2"."catalogid", (first_value("t1"."cntr") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."cntr" ASC) = "t1"."cntr") AS "best" FROM "catalogdb"."allwise" AS "t1" INNER JOIN "catalogdb"."tic_v8_extended" AS "t3" ON ("t3"."allwise" = "t1"."designation") INNER JOIN "catalogdb"."catalog_to_tic_v8_extended" AS "t2" ON ("t2"."target_id" = "t3"."id") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_allwise" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."cntr") OR ("t4"."catalogid" = "t2"."catalogid")))))
2023-01-04 12:16:06,658 - DEBUG - [ALLWISE] Copying data into relational model 'catalog_to_allwise'.
2023-01-04 12:16:09,691 - DEBUG - [ALLWISE] Linked 5,536 records in 741.847 s.
2023-01-04 12:16:09,691 - DEBUG - [ALLWISE] Running ANALYZE on catalog_to_allwise.
2023-01-04 12:19:54,610 - DEBUG - [ALLWISE] SET LOCAL work_mem='10GB';
2023-01-04 12:19:54,611 - DEBUG - [ALLWISE] SET LOCAL temp_buffers='5GB';
2023-01-04 12:19:54,611 - DEBUG - [ALLWISE] SET LOCAL enable_hashjoin=False;
2023-01-04 12:19:54,613 - DEBUG - [ALLWISE] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['allwise', 'twomass_psc', 'catalog_to_twomass_psc']: SELECT DISTINCT ON ("t1"."cntr", "t2"."catalogid") "t1"."cntr" AS "target_id", "t2"."catalogid", (first_value("t1"."cntr") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."cntr" ASC) = "t1"."cntr") AS "best" FROM "catalogdb"."allwise" AS "t1" INNER JOIN "catalogdb"."twomass_psc" AS "t3" ON ("t3"."pts_key" = "t1"."tmass_key") INNER JOIN "catalogdb"."catalog_to_twomass_psc" AS "t2" ON ("t2"."target_id" = "t3"."pts_key") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_allwise" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."cntr") OR ("t4"."catalogid" = "t2"."catalogid")))))
2023-01-04 13:08:24,605 - DEBUG - [ALLWISE] Copying data into relational model 'catalog_to_allwise'.
2023-01-04 13:08:24,605 - POST_PROCESS_NOTE - [ALLWISE] Both the creation of the intermediate table and the copy to the relational table failed for this path and since it would have linked
2023-01-04 13:08:24,605 - POST_PROCESS_NOTE - [ALLWISE] about 6 thousand times less targets than the allwise -> gaia_dr3_source path
2023-01-08 21:27:49,842 - INFO - plan = '1.0.0'; run_id = 7; tag = '0.3.23a0'.
2023-01-08 21:27:49,842 - INFO - Reference Epoch = 2016.0
2023-01-08 21:27:50,512 - INFO - Query radius = 1.0
2023-01-08 21:27:50,513 - DEBUG - Current database configuration parameters.
2023-01-08 21:27:50,513 - DEBUG - shared_buffers = 76GB
2023-01-08 21:27:50,513 - DEBUG - effective_cache_size = 176GB
2023-01-08 21:27:50,513 - DEBUG - wal_buffers = 16MB
2023-01-08 21:27:50,513 - DEBUG - effective_io_concurrency = 200
2023-01-08 21:27:50,513 - DEBUG - work_mem = 5GB
2023-01-08 21:27:50,513 - DEBUG - max_worker_processes = 32
2023-01-08 21:27:50,513 - DEBUG - random_page_cost = 1
2023-01-08 21:27:50,513 - DEBUG - seq_page_cost = 0.5
2023-01-08 21:27:50,513 - DEBUG - cpu_index_tuple_cost = 0.005
2023-01-08 21:27:50,514 - DEBUG - cpu_operator_cost = 0.0025
2023-01-08 21:27:50,514 - DEBUG - default_statistics_target = 3000
2023-01-08 21:27:50,514 - DEBUG - temp_buffers = 10GB
2023-01-08 21:27:50,514 - DEBUG - plan_cache_mode = auto
2023-01-08 21:27:50,514 - DEBUG - geqo_effort = 5
2023-01-08 21:27:50,514 - DEBUG - force_parallel_mode = off
2023-01-08 21:27:50,514 - DEBUG - enable_seqscan = on
2023-01-08 21:27:50,514 - DEBUG - enable_nestloop = on
2023-01-08 21:27:50,523 - INFO - processing order: ['gaia_dr3_source', 'gaia_dr2_source', 'legacy_survey_dr10', 'legacy_survey_dr8', 'panstarrs1', 'tic_v8', 'tic_v8_extended', 'sdss_dr13_photoobj_primary', 'twomass_psc', 'kepler_input_10', 'tycho2', 'gaia_dr2_wd_sdss', 'guvcat', 'milliquas_7_7', 'uvotssc1', 'xmm_om_suss_5_0', 'allwise', 'glimpse', 'glimpse360']
2023-01-08 21:27:50,536 - INFO - Using version record (31, 1.0.0, 0.3.23a0).
2023-01-08 21:27:50,628 - WARNING - Temporary table catalog_47cd76e43f74bbc2 already exists.
2023-01-08 21:27:50,673 - WARNING - 'catalog_47cd76e43f74bbc2' contains records for this cross-matching plan (1.0.0).
2023-01-08 21:27:50,725 - WARNING - Skipping table gaia_dr3_source.
2023-01-08 21:27:50,725 - WARNING - Skipping table gaia_dr2_source.
2023-01-08 21:27:50,726 - WARNING - Skipping table legacy_survey_dr10.
2023-01-08 21:27:50,726 - WARNING - Skipping table legacy_survey_dr8.
2023-01-08 21:27:50,726 - WARNING - Skipping table panstarrs1.
2023-01-08 21:27:50,726 - WARNING - Skipping table tic_v8.
2023-01-08 21:27:50,726 - WARNING - Skipping table tic_v8_extended.
2023-01-08 21:27:50,726 - WARNING - Skipping table sdss_dr13_photoobj_primary.
2023-01-08 21:27:50,726 - WARNING - Skipping table twomass_psc.
2023-01-08 21:27:50,726 - WARNING - Skipping table kepler_input_10.
2023-01-08 21:27:50,726 - WARNING - Skipping table tycho2.
2023-01-08 21:27:50,726 - WARNING - Skipping table gaia_dr2_wd_sdss.
2023-01-08 21:27:50,726 - WARNING - Skipping table guvcat.
2023-01-08 21:27:50,726 - WARNING - Skipping table milliquas_7_7.
2023-01-08 21:27:50,726 - WARNING - Skipping table uvotssc1.
2023-01-08 21:27:50,726 - WARNING - Skipping table xmm_om_suss_5_0.
2023-01-08 21:27:50,726 - INFO - [ALLWISE] Processing table allwise.
2023-01-08 21:27:50,726 - DEBUG - [ALLWISE] Table cross-matching parameters:
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] ra_column: ra
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] dec_column: dec
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] pmra_column: none
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] pmdec_column: none
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] is_pmra_cos: true
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] parallax_column: none
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] epoch: none
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] epoch_column: none
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] epoch_format: jyear
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] has_duplicates: false
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] skip: false
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] skip_phases: [3]
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] query_radius: 3
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] row_count: 747,634,050
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] resolution: nan
2023-01-08 21:27:50,727 - DEBUG - [ALLWISE] join_weight: 1
2023-01-08 21:27:50,727 - INFO - [ALLWISE] Setting phase run 1
2023-01-08 21:27:50,727 - INFO - [ALLWISE] Phase 2: cross-matching against existing targets.
2023-01-08 21:27:50,734 - DEBUG - [ALLWISE] Cross-matching model against temporary table.
2023-01-08 21:27:50,735 - DEBUG - [ALLWISE] SET LOCAL work_mem='10GB';
2023-01-08 21:27:50,735 - DEBUG - [ALLWISE] SET LOCAL temp_buffers='5GB';
2023-01-08 21:27:50,735 - DEBUG - [ALLWISE] SET LOCAL enable_hashjoin=False;
2023-01-08 21:27:50,736 - DEBUG - [ALLWISE] Inserting cross-matched data into relational model 'catalog_to_allwise' in PSQL: : INSERT INTO "catalogdb"."catalog_to_allwise" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."cntr" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."allwise" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0008333333333333334) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_allwise" AS "catalog_to_allwise" WHERE (("catalog_to_allwise"."version_id" = 31) AND (("catalog_to_allwise"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_allwise"."target_id" = "xmatched"."target_id"))))
2023-01-09 10:05:00,757 - DEBUG - [ALLWISE] Cross-matched catalog_47cd76e43f74bbc2 with 444,422,523 targets in allwise. Run in 45430.022 s.
2023-01-09 10:05:00,758 - DEBUG - [ALLWISE] Running ANALYZE on catalog_to_allwise.
2023-01-09 11:04:02,494 - INFO - [ALLWISE] Phase 3: adding non cross-matched targets.
2023-01-09 11:04:02,613 - WARNING - [ALLWISE] Skipping due to configuration.
2023-01-09 11:04:02,613 - INFO - [ALLWISE] Fully processed allwise in 48972 s.
2023-01-09 11:04:02,622 - INFO - [GLIMPSE] Processing table glimpse.
2023-01-09 11:04:02,622 - DEBUG - [GLIMPSE] Table cross-matching parameters:
2023-01-09 11:04:02,622 - DEBUG - [GLIMPSE] ra_column: ra
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] dec_column: dec
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] pmra_column: none
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] pmdec_column: none
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] is_pmra_cos: true
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] parallax_column: none
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] epoch: none
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] epoch_column: none
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] epoch_format: jyear
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] has_duplicates: false
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] skip: false
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] skip_phases: [3]
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] query_radius: 3
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] row_count: 94,565,810
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] resolution: nan
2023-01-09 11:04:02,623 - DEBUG - [GLIMPSE] join_weight: 1
2023-01-09 11:04:02,630 - INFO - [GLIMPSE] Phase 1: linking existing targets.
2023-01-09 11:04:02,631 - DEBUG - [GLIMPSE] Found 1 paths between glimpse and temporary output table.
2023-01-09 11:04:02,632 - DEBUG - [GLIMPSE] SET LOCAL work_mem='10GB';
2023-01-09 11:04:02,632 - DEBUG - [GLIMPSE] SET LOCAL temp_buffers='5GB';
2023-01-09 11:04:02,632 - DEBUG - [GLIMPSE] SET LOCAL enable_hashjoin=False;
2023-01-09 11:04:02,634 - DEBUG - [GLIMPSE] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['glimpse', 'twomass_psc', 'catalog_to_twomass_psc']: SELECT DISTINCT ON ("t1"."pk", "t2"."catalogid") "t1"."pk" AS "target_id", "t2"."catalogid", (first_value("t1"."pk") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."pk" ASC) = "t1"."pk") AS "best" FROM "catalogdb"."glimpse" AS "t1" INNER JOIN "catalogdb"."twomass_psc" AS "t3" ON ("t1"."tmass_cntr" = "t3"."pts_key") INNER JOIN "catalogdb"."catalog_to_twomass_psc" AS "t2" ON ("t2"."target_id" = "t3"."pts_key") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_glimpse" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."pk") OR ("t4"."catalogid" = "t2"."catalogid")))))
2023-01-09 11:38:52,064 - DEBUG - [GLIMPSE] Copying data into relational model 'catalog_to_glimpse'.
2023-01-09 11:44:48,164 - DEBUG - [GLIMPSE] Linked 36,295,713 records in 2445.532 s.
2023-01-09 11:44:48,165 - DEBUG - [GLIMPSE] Running ANALYZE on catalog_to_glimpse.
2023-01-09 11:48:02,280 - INFO - [GLIMPSE] Phase 2: cross-matching against existing targets.
2023-01-09 11:48:02,288 - DEBUG - [GLIMPSE] Cross-matching model against temporary table.
2023-01-09 11:48:02,289 - DEBUG - [GLIMPSE] SET LOCAL work_mem='10GB';
2023-01-09 11:48:02,289 - DEBUG - [GLIMPSE] SET LOCAL temp_buffers='5GB';
2023-01-09 11:48:02,289 - DEBUG - [GLIMPSE] SET LOCAL enable_hashjoin=False;
2023-01-09 11:48:02,290 - DEBUG - [GLIMPSE] Inserting cross-matched data into relational model 'catalog_to_glimpse' in PSQL: : INSERT INTO "catalogdb"."catalog_to_glimpse" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."pk" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."glimpse" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0008333333333333334) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_glimpse" AS "catalog_to_glimpse" WHERE (("catalog_to_glimpse"."version_id" = 31) AND (("catalog_to_glimpse"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_glimpse"."target_id" = "xmatched"."target_id"))))
2023-01-09 12:43:24,999 - DEBUG - [GLIMPSE] Cross-matched catalog_47cd76e43f74bbc2 with 75,294,599 targets in glimpse. Run in 3322.710 s.
2023-01-09 12:43:25,000 - DEBUG - [GLIMPSE] Running ANALYZE on catalog_to_glimpse.
2023-01-09 12:44:45,577 - INFO - [GLIMPSE] Phase 3: adding non cross-matched targets.
2023-01-09 12:44:45,585 - WARNING - [GLIMPSE] Skipping due to configuration.
2023-01-09 12:44:45,585 - INFO - [GLIMPSE] Fully processed glimpse in 6043 s.
2023-01-09 12:44:45,594 - INFO - [GLIMPSE360] Processing table glimpse360.
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] Table cross-matching parameters:
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] ra_column: ra
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] dec_column: dec
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] pmra_column: none
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] pmdec_column: none
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] is_pmra_cos: true
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] parallax_column: none
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] epoch: none
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] epoch_column: none
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] epoch_format: jyear
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] has_duplicates: false
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] skip: false
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] skip_phases: [3]
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] query_radius: 3
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] row_count: 12,075,745
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] resolution: nan
2023-01-09 12:44:45,595 - DEBUG - [GLIMPSE360] join_weight: 1
2023-01-09 12:44:45,602 - INFO - [GLIMPSE360] Phase 1: linking existing targets.
2023-01-09 12:44:45,603 - DEBUG - [GLIMPSE360] Found 1 paths between glimpse360 and temporary output table.
2023-01-09 12:44:45,604 - DEBUG - [GLIMPSE360] SET LOCAL work_mem='10GB';
2023-01-09 12:44:45,604 - DEBUG - [GLIMPSE360] SET LOCAL temp_buffers='5GB';
2023-01-09 12:44:45,604 - DEBUG - [GLIMPSE360] SET LOCAL enable_hashjoin=False;
2023-01-09 12:44:45,606 - DEBUG - [GLIMPSE360] Selecting linked targets into table catalogdb.phase1_content IN PSQL with join path ['glimpse360', 'twomass_psc', 'catalog_to_twomass_psc']: SELECT DISTINCT ON ("t1"."pkey", "t2"."catalogid") "t1"."pkey" AS "target_id", "t2"."catalogid", (first_value("t1"."pkey") OVER (PARTITION BY "t2"."catalogid" ORDER BY "t1"."pkey" ASC) = "t1"."pkey") AS "best" FROM "catalogdb"."glimpse360" AS "t1" INNER JOIN "catalogdb"."twomass_psc" AS "t3" ON ("t1"."tmass_cntr" = "t3"."pts_key") INNER JOIN "catalogdb"."catalog_to_twomass_psc" AS "t2" ON ("t2"."target_id" = "t3"."pts_key") WHERE ((("t2"."version_id" = 31) AND ("t2"."best" IS True)) AND NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_glimpse360" AS "t4" WHERE (("t4"."version_id" = 31) AND (("t4"."target_id" = "t1"."pkey") OR ("t4"."catalogid" = "t2"."catalogid")))))
2023-01-09 12:46:44,419 - DEBUG - [GLIMPSE360] Copying data into relational model 'catalog_to_glimpse360'.
2023-01-09 12:47:18,040 - DEBUG - [GLIMPSE360] Linked 3,826,589 records in 152.437 s.
2023-01-09 12:47:18,041 - DEBUG - [GLIMPSE360] Running ANALYZE on catalog_to_glimpse360.
2023-01-09 12:47:40,913 - INFO - [GLIMPSE360] Phase 2: cross-matching against existing targets.
2023-01-09 12:47:40,921 - DEBUG - [GLIMPSE360] Cross-matching model against temporary table.
2023-01-09 12:47:40,921 - DEBUG - [GLIMPSE360] SET LOCAL work_mem='10GB';
2023-01-09 12:47:40,921 - DEBUG - [GLIMPSE360] SET LOCAL temp_buffers='5GB';
2023-01-09 12:47:40,921 - DEBUG - [GLIMPSE360] SET LOCAL enable_hashjoin=False;
2023-01-09 12:47:40,923 - DEBUG - [GLIMPSE360] Inserting cross-matched data into relational model 'catalog_to_glimpse360' in PSQL: : INSERT INTO "catalogdb"."catalog_to_glimpse360" ("target_id", "catalogid", "version_id", "distance", "best") WITH "xmatched" AS MATERIALIZED (SELECT "t1"."catalogid", "t2"."pkey" AS "target_id", q3c_dist("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec") AS "distance" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1" CROSS JOIN "catalogdb"."glimpse360" AS "t2" WHERE (q3c_join("t2"."ra", "t2"."dec", "t1"."ra", "t1"."dec", 0.0008333333333333334) AND True)) SELECT "xmatched"."target_id", "xmatched"."catalogid", 31 AS "version_id", "xmatched"."distance" AS "distance", (first_value("xmatched"."target_id") OVER (PARTITION BY "xmatched"."catalogid" ORDER BY "xmatched"."distance" ASC) = "xmatched"."target_id") AS "best" FROM "xmatched" WHERE NOT EXISTS(SELECT 1 FROM "catalogdb"."catalog_to_glimpse360" AS "catalog_to_glimpse360" WHERE (("catalog_to_glimpse360"."version_id" = 31) AND (("catalog_to_glimpse360"."catalogid" = "xmatched"."catalogid") OR ("catalog_to_glimpse360"."target_id" = "xmatched"."target_id"))))
2023-01-09 12:53:25,163 - DEBUG - [GLIMPSE360] Cross-matched catalog_47cd76e43f74bbc2 with 8,317,289 targets in glimpse360. Run in 344.241 s.
2023-01-09 12:53:25,163 - DEBUG - [GLIMPSE360] Running ANALYZE on catalog_to_glimpse360.
2023-01-09 12:53:32,485 - INFO - [GLIMPSE360] Phase 3: adding non cross-matched targets.
2023-01-09 12:53:32,493 - WARNING - [GLIMPSE360] Skipping due to configuration.
2023-01-09 12:53:32,493 - INFO - [GLIMPSE360] Fully processed glimpse360 in 527 s.
2023-01-09 12:53:32,503 - INFO - Copying temporary table to output table.
2023-01-09 12:53:32,503 - DEBUG - SET LOCAL work_mem='10GB';
2023-01-09 12:53:32,503 - DEBUG - SET LOCAL temp_buffers='5GB';
2023-01-09 12:53:32,504 - DEBUG - SET LOCAL enable_hashjoin=False;
2023-01-09 12:53:32,504 - DEBUG - Running INSERT query into catalog: INSERT INTO "catalogdb"."catalog" ("iauname", "ra", "dec", "pmra", "pmdec", "parallax", "lead", "catalogid", "version_id") SELECT "t1"."iauname", "t1"."ra", "t1"."dec", "t1"."pmra", "t1"."pmdec", "t1"."parallax", "t1"."lead", "t1"."catalogid", "t1"."version_id" FROM "catalogdb"."catalog_47cd76e43f74bbc2" AS "t1"
2023-01-11 06:36:07,879 - DEBUG - Inserted 5,919,878,476 rows in 150155.376 s.
2023-01-11 06:36:11,024 - INFO - Dropped temporary table catalog_47cd76e43f74bbc2
2023-01-11 06:36:11,024 - DEBUG - Running VACUUM ANALYZE on catalog.
2023-01-11 14:46:24,528 - INFO - Cross-matching completed in 1323620 s (plus the time it was not running). 
